<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Commands: Snapshot Agent | Consul | HashiCorp Developer</title><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta property="article:publisher" content="https://www.facebook.com/HashiCorp/"/><meta name="twitter:site" content="@HashiCorp"/><meta name="twitter:card" content="summary_large_image"/><meta name="theme-color" content="#000"/><meta name="description" property="og:description" content="The `consul snapshot agent` command starts a process that takes snapshots of the state of the Consul servers in Consul Enterprise. It can capture server state once or it can run as a daemon that captures snapshots at defined intervals.
"/><meta name="twitter:description" content="The `consul snapshot agent` command starts a process that takes snapshots of the state of the Consul servers in Consul Enterprise. It can capture server state once or it can run as a daemon that captures snapshots at defined intervals.
"/><meta property="og:site_name" content="Commands: Snapshot Agent | Consul | HashiCorp Developer"/><meta property="og:title" content="Commands: Snapshot Agent | Consul | HashiCorp Developer"/><meta property="og:image" content="https://developer.hashicorp.com/og-image/consul.jpg"/><link rel="canonical" href="https://developer.hashicorp.com/consul/commands/snapshot/agent"/><link rel="icon" href="/favicon.ico" sizes="48x48"/><link rel="icon" href="/favicon.svg" sizes="any" type="image/svg+xml"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="google-site-verification" content="zRQZqfAsOX-ypXfU0mzAIzb5rUvj5fA4Zw2jWJRN-JI"/><meta name="ahrefs-site-verification" content="9d739b21c466a84dae91df1c79396081a9072152e64f765c9390fed6f249fb84"/><meta name="zd-site-verification" content="xnvnvv1i0wl4tf0pzaymb" data-product="hcp"/><meta name="zd-site-verification" content="36fp2i1pj67d8cjtzf4fi9" data-product="terraform"/><meta name="zd-site-verification" content="nbe87kfyp1sck7b13vj1i" data-product="packer"/><meta name="zd-site-verification" content="wvsmmqa1cfb9am9zlwfj" data-product="consul"/><meta name="zd-site-verification" content="cw22oopfwr68ujj0n5pn9i" data-product="boundary"/><meta name="zd-site-verification" content="lkslvganwfgfqfwpdeicgh" data-product="vault"/><meta name="zd-site-verification" content="jl2wp2hoej9rz6c8rmqdns" data-product="nomad"/><meta name="zd-site-verification" content="2eb0cu6xceo73t0038m0tb" data-product="waypoint"/><meta name="zd-site-verification" content="n52xisxdf3higs2q9kuogd" data-product="vagrant"/><meta name="twitter:image" content="https://developer.hashicorp.com/og-image/consul.jpg"/><link rel="prefetch" href="https://www.datadoghq-browser-agent.com/datadog-rum-v4.js"/><script type="application/ld+json">[{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Developer","item":"https://developer.hashicorp.com/"},{"@type":"ListItem","position":2,"name":"Consul","item":"https://developer.hashicorp.com/consul"},{"@type":"ListItem","position":3,"name":"CLI","item":"https://developer.hashicorp.com/consul/commands"},{"@type":"ListItem","position":4,"name":"snapshot","item":"https://developer.hashicorp.com/consul/commands/snapshot"},{"@type":"ListItem","position":5,"name":"agent","item":"https://developer.hashicorp.com/consul/commands/snapshot/agent"}]}]</script><meta name="next-head-count" content="32"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/f49486d3b4c819d0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f49486d3b4c819d0.css" data-n-g=""/><link rel="preload" href="/_next/static/css/a3fdbf75d77eb323.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a3fdbf75d77eb323.css" data-n-p=""/><link rel="preload" href="/_next/static/css/a23a4d5b8f64c49d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a23a4d5b8f64c49d.css" data-n-p=""/><link rel="preload" href="/_next/static/css/686380cdcb9bba8b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/686380cdcb9bba8b.css" data-n-p=""/><link rel="preload" href="/_next/static/css/ea6200fd19daadcf.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ea6200fd19daadcf.css" data-n-p=""/><link rel="preload" href="/_next/static/css/ae09c8e2a5e8a685.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ae09c8e2a5e8a685.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-842277f4ad2b003f.js" defer=""></script><script src="/_next/static/chunks/framework-7063787c3be570d0.js" defer=""></script><script src="/_next/static/chunks/main-7bf85f85b965ad61.js" defer=""></script><script src="/_next/static/chunks/pages/_app-0a33c1c146a72462.js" defer=""></script><script src="/_next/static/chunks/7166-70084e7c41a66411.js" defer=""></script><script src="/_next/static/chunks/1395-1eb65df04043100c.js" defer=""></script><script src="/_next/static/chunks/2273-6dfd48e8418afcdf.js" defer=""></script><script src="/_next/static/chunks/5675-7108b5e9113ea2a3.js" defer=""></script><script src="/_next/static/chunks/8604-305dcb3c7664513e.js" defer=""></script><script src="/_next/static/chunks/4491-3e2af2e825fdeeca.js" defer=""></script><script src="/_next/static/chunks/9554-d740b5e666a16cc0.js" defer=""></script><script src="/_next/static/chunks/7427-61de0b9ecdc61a14.js" defer=""></script><script src="/_next/static/chunks/5261-c0c32f534b764eb3.js" defer=""></script><script src="/_next/static/chunks/6787-5406eb82ed1c8857.js" defer=""></script><script src="/_next/static/chunks/3786-bfb5477c5f7f7c76.js" defer=""></script><script src="/_next/static/chunks/8018-5acf9cc98d6409e7.js" defer=""></script><script src="/_next/static/chunks/8577-a3048bd869a84460.js" defer=""></script><script src="/_next/static/chunks/pages/consul/commands/%5B%5B...page%5D%5D-517e8bddea6759ce.js" defer=""></script><script src="/_next/static/rf4tsLo62lRElKow25oK4/_buildManifest.js" defer=""></script><script src="/_next/static/rf4tsLo62lRElKow25oK4/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="style_root__dZhZu"><a href="https://www.hashicorp.com/en/blog/hashicorp-officially-joins-the-ibm-family" class="style_linkElem__hCESK"><span class="style_textContainer__6CuI7 g-grid-container"><span class="style_tag__jbHGz g-type-body-small-x-strong">Acquisition complete<!-- --> </span><span class="style_text__rwS0u g-type-body-small">HashiCorp officially joins the IBM family.<span class="style_linkText__E8GJf g-type-body-small-x-strong"> <!-- -->Learn more</span></span></span></a><button class="style_closeButton__57J9w"><div><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 20 20"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 5 5 15M5 5l10 10"/></svg></div><span style="position:absolute;border:0;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;word-wrap:normal">Dismiss alert</span></button></div><script type="text/javascript">
(function checkDismissAlertBanner() {
  try {
    if (document.cookie.includes('banner_hashicorp-officially-joins-the-ibm-family.=1')) {
      const element = document.querySelector('.style_root__dZhZu')
      element.classList.remove('style_isShown__D4mb6')
    }
  } catch (_) {
    // do nothing
  }
})()
</script><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="core-dev-dot-layout_root__MT1PZ"><div class="base-layout_root___qiZs" data-layout="base-new"><div class="base-layout_header__XhkxS"><header class="navigation-header_root__oE_HT"><div class="navigation-header_leftSide__V0xlc"><div class="product-page-content_productsDropdown__haUyw"><nav aria-label="Main" data-orientation="horizontal" dir="ltr"><div class="dropdown-menu_root__Hwy5S"><div class="dropdown-menu_activatorWrapper__LxPRt"><button aria-controls="navigation-header-menu-react-aria-1" aria-expanded="false" aria-label="Main menu" class="dropdown-menu_activator__xXb00 g-focus-ring-from-box-shadow-dark product-page-content_productsDropdownButton__bnKKs"><span class="dropdown-menu_activatorLeadingIcon__YQQlH"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true" class="product-page-content_productsDropdownIcon__gXtly"><g fill="currentColor"><path d="M10.336 1.5L2 6.268v11.456l3.131 1.793V8.061l5.205-2.979V1.5z"></path><path d="M13.664 1.5v9.123h-3.328V7.219L7.203 9.012V20.7l3.133 1.796V13.4h3.328v3.381l3.131-1.793V3.293L13.664 1.5z"></path><path d="M22 17.732L13.664 22.5v-3.582l5.203-2.98V4.484L22 6.276v11.456z"></path></g></svg></span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="dropdown-menu_activatorTrailingIcon__r_cCd"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button></div><div class="dropdown-menu_dropdownContainer__AZWxN" id="navigation-header-menu-react-aria-1" style="display:none"><div class="style_root__z3EwE style_productPanel__Z4UFi style_hasSide__15FV8 style_hasSide__ecwjD"><div class="style_mainPanel__MpQn1"><div class="style_column__9is2G style_hasSide__A3F31"><ul class="style_productCategories__j1h4T"><li class="style_productCategory__9UHKG"><span class="hds-text hdsplus-typography-body-300 style_eyebrow__OCUlS">Infrastructure Lifecycle Management</span><ul class="style_productList__uPlTj"><li><a aria-label="Terraform - Manage infrastructure as code" class="style_focusIndicator__uTVwt" data-radix-collection-item="" href="/terraform"><div class="style_productWrapper__ACHaw"><div class="style_productLogo__cTxLO"><svg class="flight-icon flight-icon-terraform-fill flight-icon-display-inline style_terraform__nU44i" aria-hidden="true" fill="currentColor" id=":R9imld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-terraform-fill-16"></use></svg></div><div class="style_productTextContent__o8DJ6"><span>Terraform</span><span class="style_productDesc__bi44f">Manage infrastructure as code</span></div></div></a></li><li><a aria-label="Packer - Build machine images" class="style_focusIndicator__uTVwt" data-radix-collection-item="" href="/packer"><div class="style_productWrapper__ACHaw"><div class="style_productLogo__cTxLO"><svg class="flight-icon flight-icon-packer-fill-color flight-icon-display-inline" aria-hidden="true" fill="currentColor" id=":Raimld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-packer-fill-color-16"></use></svg></div><div class="style_productTextContent__o8DJ6"><span>Packer</span><span class="style_productDesc__bi44f">Build machine images</span></div></div></a></li><li><a aria-label="Nomad - Orchestrate workloads" class="style_focusIndicator__uTVwt" data-radix-collection-item="" href="/nomad"><div class="style_productWrapper__ACHaw"><div class="style_productLogo__cTxLO"><svg class="flight-icon flight-icon-nomad-fill-color flight-icon-display-inline" aria-hidden="true" fill="currentColor" id=":Rbimld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-nomad-fill-color-16"></use></svg></div><div class="style_productTextContent__o8DJ6"><span>Nomad</span><span class="style_productDesc__bi44f">Orchestrate workloads</span></div></div></a></li><li><a aria-label="Waypoint - Standardize application patterns" class="style_focusIndicator__uTVwt" data-radix-collection-item="" href="/waypoint"><div class="style_productWrapper__ACHaw"><div class="style_productLogo__cTxLO"><svg class="flight-icon flight-icon-waypoint-fill-color flight-icon-display-inline" aria-hidden="true" fill="currentColor" id=":Rcimld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-waypoint-fill-color-16"></use></svg></div><div class="style_productTextContent__o8DJ6"><span>Waypoint</span><span class="style_productDesc__bi44f">Standardize application patterns</span></div></div></a></li><li><a aria-label="Vagrant - Build developer environments" class="style_focusIndicator__uTVwt" data-radix-collection-item="" href="/vagrant"><div class="style_productWrapper__ACHaw"><div class="style_productLogo__cTxLO"><svg class="flight-icon flight-icon-vagrant-fill-color flight-icon-display-inline" aria-hidden="true" fill="currentColor" id=":Rdimld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-vagrant-fill-color-16"></use></svg></div><div class="style_productTextContent__o8DJ6"><span>Vagrant</span><span class="style_productDesc__bi44f">Build developer environments</span></div></div></a></li></ul></li><li class="style_productCategory__9UHKG"><span class="hds-text hdsplus-typography-body-300 style_eyebrow__OCUlS">Security Lifecycle Management</span><ul class="style_productList__uPlTj"><li><a aria-label="Vault - Centrally manage secrets" class="style_focusIndicator__uTVwt" data-radix-collection-item="" href="/vault"><div class="style_productWrapper__ACHaw"><div class="style_productLogo__cTxLO"><svg class="flight-icon flight-icon-vault-fill-color flight-icon-display-inline" aria-hidden="true" fill="currentColor" id=":R9kmld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-vault-fill-color-16"></use></svg></div><div class="style_productTextContent__o8DJ6"><span>Vault</span><span class="style_productDesc__bi44f">Centrally manage secrets</span></div></div></a></li><li><a aria-label="Boundary - Secure remote access" class="style_focusIndicator__uTVwt" data-radix-collection-item="" href="/boundary"><div class="style_productWrapper__ACHaw"><div class="style_productLogo__cTxLO"><svg class="flight-icon flight-icon-boundary-fill-color flight-icon-display-inline" aria-hidden="true" fill="currentColor" id=":Rakmld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-boundary-fill-color-16"></use></svg></div><div class="style_productTextContent__o8DJ6"><span>Boundary</span><span class="style_productDesc__bi44f">Secure remote access</span></div></div></a></li><li><a aria-label="HCP Vault Secrets - Manage secrets as a service" class="style_focusIndicator__uTVwt" data-radix-collection-item="" href="/hcp/docs/vault-secrets"><div class="style_productWrapper__ACHaw"><div class="style_productLogo__cTxLO"><svg class="flight-icon flight-icon-vault-secrets flight-icon-display-inline style_hcpVaultSecrets__11wgG" aria-hidden="true" fill="currentColor" id=":Rbkmld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-vault-secrets-16"></use></svg></div><div class="style_productTextContent__o8DJ6"><span>HCP Vault Secrets</span><span class="style_productDesc__bi44f">Manage secrets as a service</span></div></div></a></li><li><a aria-label="Consul - Secure network services" class="style_focusIndicator__uTVwt" data-radix-collection-item="" href="/consul"><div class="style_productWrapper__ACHaw"><div class="style_productLogo__cTxLO"><svg class="flight-icon flight-icon-consul-fill-color flight-icon-display-inline" aria-hidden="true" fill="currentColor" id=":Rckmld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-consul-fill-color-16"></use></svg></div><div class="style_productTextContent__o8DJ6"><span>Consul</span><span class="style_productDesc__bi44f">Secure network services</span></div></div></a></li><li><a aria-label="HCP Vault Radar - Scan for embedded secrets" class="style_focusIndicator__uTVwt" data-radix-collection-item="" href="/hcp/docs/vault-radar"><div class="style_productWrapper__ACHaw"><div class="style_productLogo__cTxLO"><svg class="flight-icon flight-icon-vault-radar flight-icon-display-inline style_hcpVaultRadar__nukMV" aria-hidden="true" fill="currentColor" id=":Rdkmld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-vault-radar-16"></use></svg></div><div class="style_productTextContent__o8DJ6"><span>HCP Vault Radar</span><span class="style_productDesc__bi44f">Scan for embedded secrets</span></div></div></a></li></ul></li></ul></div><div class="style_promo__e6yXp style_hasSide__635Xt"><div class="style_icon__rYEcI"><svg class="flight-icon flight-icon-hashicorp flight-icon-display-inline" aria-hidden="true" fill="currentColor" id=":R36ld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-hashicorp-16"></use></svg></div><div class="style_rightContent__zvciM"><div><div class="style_title__eEtAF">HashiCorp Cloud Platform</div><div class="style_description__ATQzz">Get started in minutes with our cloud products</div></div><a class="style_link__U4Sfy" data-radix-collection-item="" href="/hcp">All HCP Products<svg class="flight-icon flight-icon-external-link flight-icon-display-inline" aria-hidden="true" fill="currentColor" id=":R2l6ld6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-external-link-16"></use></svg></a></div></div></div><div class="style_column__9is2G style_sidePanel__qxYNB"><span class="hds-text hdsplus-typography-body-200 hds-font-weight-semibold">Learn</span><ul class="style_sidePanelItems__i8_HV"><li><a aria-label="Certifications - Get HashiCorp certified" class="style_sidePanelItem__j0j0G style_focusIndicator__uTVwt" href="/certifications"><div class="style_iconBackground__fn5_s"><svg class="flight-icon flight-icon-award flight-icon-display-inline" aria-hidden="true" fill="var(--token-color-foreground-faint)" id=":Rjald6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-award-16"></use></svg></div><div class="style_sidePanelItemContent__xFcSA"><span class="hds-text hdsplus-typography-body-200 hds-font-weight-semibold">Certifications</span><span class="style_sidePanelItemDesc__UrOLh">Get HashiCorp certified</span></div></a></li><li><a aria-label="Tutorials - Learn HashiCorp products" class="style_sidePanelItem__j0j0G style_focusIndicator__uTVwt" href="/tutorials"><div class="style_iconBackground__fn5_s"><svg class="flight-icon flight-icon-learn flight-icon-display-inline" aria-hidden="true" fill="var(--token-color-foreground-faint)" id=":Rlald6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-learn-16"></use></svg></div><div class="style_sidePanelItemContent__xFcSA"><span class="hds-text hdsplus-typography-body-200 hds-font-weight-semibold">Tutorials</span><span class="style_sidePanelItemDesc__UrOLh">Learn HashiCorp products</span></div></a></li><li><a aria-label="Validated Patterns - Field-tested patterns for using HashiCorp products" class="style_sidePanelItem__j0j0G style_focusIndicator__uTVwt" href="/validated-patterns"><div class="style_iconBackground__fn5_s"><svg class="flight-icon flight-icon-check-circle flight-icon-display-inline" aria-hidden="true" fill="var(--token-color-foreground-faint)" id=":Rnald6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-check-circle-16"></use></svg></div><div class="style_sidePanelItemContent__xFcSA"><span class="hds-text hdsplus-typography-body-200 hds-font-weight-semibold">Validated Patterns</span><span class="style_sidePanelItemDesc__UrOLh">Field-tested patterns for using HashiCorp products</span></div></a></li><li><a aria-label="Well-Architected Framework - Adopt HashiCorp best practices" class="style_sidePanelItem__j0j0G style_focusIndicator__uTVwt" href="/well-architected-framework"><div class="style_iconBackground__fn5_s"><svg class="flight-icon flight-icon-layers flight-icon-display-inline" aria-hidden="true" fill="var(--token-color-foreground-faint)" id=":Rpald6j6:" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-layers-16"></use></svg></div><div class="style_sidePanelItemContent__xFcSA"><span class="hds-text hdsplus-typography-body-200 hds-font-weight-semibold">Well-Architected Framework</span><span class="style_sidePanelItemDesc__UrOLh">Adopt HashiCorp best practices</span></div></a></li></ul></div></div></div></div></nav></div><div class="product-page-content_productLinkAndNav__YTzcr"><a aria-label="Consul home" class="product-icon-text-link_root__bNTSz g-focus-ring-from-box-shadow-dark" href="/consul"><div class="product-icon-text-lockup_root__358wV"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="product-icon-text-lockup_icon__Zp_5o"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg><span class="product-icon-text-lockup_text__nHTL7 hds-typography-body-200">Consul</span></div></a><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="nav-bar-list-container_nav__C_i0_"><div style="position:relative"><ul data-orientation="horizontal" class="nav-bar-list-container_ul___04HI" dir="ltr"><li><a aria-label="Consul Install" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" href="/consul/install"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Install</span></a></li><li><a aria-label="Consul Tutorials" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" href="/consul/tutorials"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Tutorials</span></a></li><li><a aria-label="Consul Documentation" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" href="/consul/docs"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Documentation</span></a></li><li><a aria-label="Consul API" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" href="/consul/api-docs"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">API</span></a></li><li><a aria-label="Consul CLI" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" href="/consul/commands"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">CLI</span></a></li><li><a aria-label="Consul Try Cloud" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" aria-describedby="opens-in-new-tab-label-react-aria-8" target="_blank" href="https://portal.cloud.hashicorp.com/sign-up"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Try Cloud</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-8">(opens in new tab)</span></li></ul></div></nav></div></div><div class="navigation-header_rightSide___Vvh_"><button aria-label="Search" class="command-bar-activator_root__qgVMy g-focus-ring-from-box-shadow-dark"><span class="command-bar-activator_left__ATQTg"><span class="command-bar-activator_leadingIcon__jECP5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M6.344.969a5.375 5.375 0 103.233 9.669l4.174 4.174a.75.75 0 001.06-1.061l-4.173-4.174A5.375 5.375 0 006.344.97zM2.469 6.344a3.875 3.875 0 117.75 0 3.875 3.875 0 01-7.75 0z" clip-rule="evenodd"></path></svg></span><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular command-bar-activator_text__pTZN_">Search</span></span><span class="command-bar-activator_right__XejfJ"><span class="g-screen-reader-only">Command or control key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="cmd-ctrl-icon_root___TToz"><svg xmlns="http://www.w3.org/2000/svg" width="41" height="11" fill="none" viewBox="0 0 41 11"><path fill="#fff" fill-rule="evenodd" d="M4.125 2.063V3h2.25v-.937a2.062 2.062 0 1 1 2.063 2.062H7.5v2.25h.938a2.062 2.062 0 1 1-2.063 2.063V7.5h-2.25v.938a2.062 2.062 0 1 1-2.062-2.063H3v-2.25h-.937a2.062 2.062 0 1 1 2.062-2.062m-2.062-.938a.937.937 0 1 0 0 1.875H3v-.937a.937.937 0 0 0-.937-.938M7.5 7.5v.938a.937.937 0 1 0 .938-.938zM6.375 6.375v-2.25h-2.25v2.25zM2.063 7.5H3v.938a.937.937 0 1 1-.937-.938M7.5 3h.938a.937.937 0 1 0-.938-.937z" clip-rule="evenodd"/><path fill="#fff" d="M15.09 10.5 18.085 0h-1.097L14 10.5zM26.387 5.308c-.183-1.445-1.263-2.534-3.05-2.534C21.264 2.774 20 4.247 20 6.61c0 2.41 1.27 3.89 3.344 3.89 1.76 0 2.86-1.034 3.043-2.5H25.02c-.184.808-.792 1.247-1.682 1.247-1.172 0-1.898-.994-1.898-2.637 0-1.61.72-2.583 1.898-2.583.942 0 1.518.555 1.681 1.281zM28.6 1.041v1.897h-1.133v1.178H28.6v4.281c0 1.432.622 2.007 2.186 2.007.275 0 .537-.034.766-.075V9.158c-.196.02-.32.034-.537.034-.7 0-1.008-.35-1.008-1.15V4.115h1.545V2.938h-1.545V1.041zM33.207 10.356h1.407V5.911c0-1.048.752-1.767 1.819-1.767.249 0 .667.048.785.082V2.842a3.372 3.372 0 0 0-.628-.054c-.93 0-1.721.527-1.924 1.26h-.105v-1.13h-1.354zM38.638 10.356h1.407V0h-1.407z"/></svg></div></span><span class="g-screen-reader-only">K key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="k-icon_root__a_5pR"><svg xmlns="http://www.w3.org/2000/svg" width="8" height="10" fill="none" viewBox="0 0 8 10"><path fill="#fff" d="M1.512 9.84v-3l.986-1.147L5.445 9.84h1.704L3.46 4.745 6.857.84H5.244L1.61 5.094h-.098V.84H.15v9z"/></svg></div></span></span></button><div class="navigation-header_authenticationControls__EP1LY"><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj"><button aria-controls="disclosure-react-aria-9-content" aria-expanded="false" aria-label="User menu" class="disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo navigation-header_userDropdownDisclosureActivator__RayIV g-focus-ring-from-box-shadow-dark activator_hasIcon__5HO6W g-focus-ring-from-box-shadow"><span class="activator_childrenWrapper__kaK0w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path fill-rule="evenodd" d="M12 3a5 5 0 100 10 5 5 0 000-10zM8.5 8a3.5 3.5 0 117 0 3.5 3.5 0 01-7 0z" clip-rule="evenodd"></path><path d="M7.75 14.5A4.75 4.75 0 003 19.25v1a.75.75 0 001.5 0v-1A3.25 3.25 0 017.75 16h8.5a3.25 3.25 0 013.25 3.25v1a.75.75 0 001.5 0v-1a4.75 4.75 0 00-4.75-4.75h-8.5z"></path></g></svg></span><span class="activator_chevronWrapper__4_AVG"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></span></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-9-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><button class="list-item_button__nXy5K g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign in</span></button></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/sign-up"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign up</span></a></li><li class="list-item_root__ZdUej"><hr class="list-item_separator__cBVLs"/></li><li class="list-item_root__ZdUej user-dropdown-switcher_listItem__Q_GIj hds-font-weight-medium"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-11">Theme</label></li></ul></div></div></div><button aria-label="Open navigation menu" class="navigation-header_mobileMenuButton__74S4w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path d="M2 5.75A.75.75 0 012.75 5h18.5a.75.75 0 010 1.5H2.75A.75.75 0 012 5.75zM2 11.75a.75.75 0 01.75-.75h18.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2.75 17a.75.75 0 000 1.5h18.5a.75.75 0 000-1.5H2.75z"></path></g></svg></button></div></header></div><div class="base-layout_contentArea__BMvQn"><div class="sidebar-sidecar-layout_root__h5rD8 sidebar-sidecar-layout_mainWidth-narrow__FhCbs"><div class="mobile-menu-container_root__fPUFu sidebar-sidecar-layout_sidebarContainer__4fcF8"><div class="sidebar-sidecar-layout_sidebarContentWrapper__ftn5q"><div class="sidebar-sidecar-layout_sidePadding__iwNw_"><div class="sidebar_sidebar___fTlC"><div class="sidebar_backToLinkWrapper__F6iLs"><div class="sidebar-back-to-link_root__z_Hj1"><a class="standalone-link_standaloneLink__ahuej g-focus-ring-from-box-shadow standalone-link_primary__ESNCA" href="/consul"><div class="standalone-link_standaloneLinkContents__4I2XN standalone-link_medium__J2yVM"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M10.795 3.235a.75.75 0 01-.03 1.06L6.842 8l3.923 3.705a.75.75 0 01-1.03 1.09l-4.5-4.25a.75.75 0 010-1.09l4.5-4.25a.75.75 0 011.06.03z" clip-rule="evenodd"></path></svg><span class="standalone-link_text__7GEyG">Consul Home</span></div></a></div></div><div class="sidebar_filterInputWrapper__0_l_Y"><div class="filter-input_filterInputContainer__thZt3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="filter-input_filterIcon__UET0p filter-input_sharedIconColorAndPositioning__hXPit"><g fill="currentColor"><path d="M1 3.75A.75.75 0 011.75 3h12.5a.75.75 0 010 1.5H1.75A.75.75 0 011 3.75zM3.5 7.75A.75.75 0 014.25 7h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM6.75 11a.75.75 0 000 1.5h2.5a.75.75 0 000-1.5h-2.5z"></path></g></svg><input class="filter-input_filterInput__hga4N g-focus-ring-from-box-shadow" placeholder="Filter sidebar" autoComplete="off" autoCorrect="off" autoCapitalize="none" spellcheck="false" value=""/></div></div><nav aria-labelledby="sidebar-label" class="sidebar_nav__IworY" id="sidebar-nav"><div class="g-screen-reader-only"><h2 class="sidebar-headings_root__tGfxC" id="sidebar-label">CLI</h2></div><ul class="sidebar_navList__4Rg4g"><li><a class="sidebar-nav-highlight-item_root___pPhp g-focus-ring-from-box-shadow sidebar-nav-highlight-item_theme-consul__NA90N" href="/consul/commands"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="sidebar-nav-highlight-item_icon__G8JxG"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg><span class="sidebar-nav-highlight-item_text__VORFJ hds-typography-body-200">CLI</span></a></li><li id="sidebar-nav-item-1"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-1-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">acl</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-46"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/agent"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">agent</span></a></li><li id="sidebar-nav-item-47"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-47-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">catalog</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-52"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-52-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">config</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-58"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-58-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">connect</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-65"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/debug"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">debug</span></a></li><li id="sidebar-nav-item-66"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/event"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">event</span></a></li><li id="sidebar-nav-item-67"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/exec"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">exec</span></a></li><li id="sidebar-nav-item-68"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/force-leave"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">force-leave</span></a></li><li id="sidebar-nav-item-69"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/info"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">info</span></a></li><li id="sidebar-nav-item-70"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-70-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">intention</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-78"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/join"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">join</span></a></li><li id="sidebar-nav-item-79"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/keygen"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">keygen</span></a></li><li id="sidebar-nav-item-80"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/keyring"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">keyring</span></a></li><li id="sidebar-nav-item-81"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-81-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">kv</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-88"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/leave"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">leave</span></a></li><li id="sidebar-nav-item-89"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/license"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">license</span></a></li><li id="sidebar-nav-item-90"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/lock"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">lock</span></a></li><li id="sidebar-nav-item-91"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/login"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">login</span></a></li><li id="sidebar-nav-item-92"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/logout"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">logout</span></a></li><li id="sidebar-nav-item-93"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/maint"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">maint</span></a></li><li id="sidebar-nav-item-94"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/members"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">members</span></a></li><li id="sidebar-nav-item-95"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/monitor"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">monitor</span></a></li><li id="sidebar-nav-item-96"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-96-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">namespace</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-104"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-104-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">operator</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-110"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/partition"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">partition</span></a></li><li id="sidebar-nav-item-111"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-111-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">peering</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-119"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/reload"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">reload</span></a></li><li id="sidebar-nav-item-120"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/rtt"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">rtt</span></a></li><li id="sidebar-nav-item-121"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-121-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">services</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-127"><button aria-controls="sidebar-nav-item-127-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-127-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">snapshot</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="sidebar-nav-item-127-list"><li id="sidebar-nav-item-128"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/snapshot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Overview</span></a></li><li id="sidebar-nav-item-129"><a aria-current="page" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/snapshot/agent"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">agent</span></a></li><li id="sidebar-nav-item-130"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/snapshot/decode"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">decode</span></a></li><li id="sidebar-nav-item-131"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/snapshot/inspect"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">inspect</span></a></li><li id="sidebar-nav-item-132"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/snapshot/restore"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">restore</span></a></li><li id="sidebar-nav-item-133"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/snapshot/save"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">save</span></a></li></ul></li><li id="sidebar-nav-item-134"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-134-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">tls</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-138"><button class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-138-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">troubleshoot</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-143"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/validate"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">validate</span></a></li><li id="sidebar-nav-item-144"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/version"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">version</span></a></li><li id="sidebar-nav-item-145"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/consul/commands/watch"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">watch</span></a></li></ul><hr class="sidebar-horizontal-rule_root__UY7oh"/><ul class="sidebar_navList__4Rg4g"><li><h3 class="sidebar-headings_root__tGfxC">Resources</h3></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/tutorials/library?product=consul"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Tutorial Library</span></a></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" href="/certifications/security-automation"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Certifications</span></a></li><li><a aria-label="Community Forum. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" rel="noreferrer noopener" aria-describedby="opens-in-new-tab-label-react-aria-45" target="_blank" href="https://discuss.hashicorp.com/c/consul/29"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Community Forum</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-45">(opens in new tab)</span></li><li><a aria-label="Support. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" rel="noreferrer noopener" aria-describedby="opens-in-new-tab-label-react-aria-46" target="_blank" href="https://www.hashicorp.com/customer-success"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Support</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-46">(opens in new tab)</span></li><li><a aria-label="GitHub. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" rel="noreferrer noopener" aria-describedby="opens-in-new-tab-label-react-aria-47" target="_blank" href="https://github.com/hashicorp/consul"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">GitHub</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-47">(opens in new tab)</span></li></ul></nav></div></div></div></div><div class="sidebar-sidecar-layout_contentWrapper__Z5BK4"><div class="sidebar-sidecar-layout_paddedAreaWrapper___S_Ff"><div class="sidebar-sidecar-layout_breadcrumbContainer__3uz7P"><div class="sidebar-sidecar-layout_breadcrumbMaxWidth__coOcu"><nav aria-label="Breadcrumb" class="breadcrumb-bar_root__wd_C5"><ol class="breadcrumb-bar_listRoot__8eupO"><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" href="/">Developer</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" href="/consul">Consul</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" href="/consul/commands">CLI</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" href="/consul/commands/snapshot">snapshot</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><span class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" aria-current="page">agent</span></li></ol></nav></div></div><div class="sidebar-sidecar-layout_mainAndSidecar__UDm3Z"><main id="main" class="sidebar-sidecar-layout_main__0SN51"><div class="docs-page-heading_root__QuBg_ docs-view_docsPageHeading___xkrK"><div class="docs-page-heading_pageHeadingWrapper__LEMQ7"><h1 class="hds-typography-display-600 hds-font-weight-bold docs-plain-page-heading_root__HzRuX g-offset-scroll-margin-top" id="consul-snapshot-agent">Consul Snapshot Agent</h1></div></div><div class="dev-dot-content_root__UJDct hds-typography-body-300"><div class="docs-view_mdxContent___uMnx"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Command: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">consul snapshot agent</code></p><div class="enterprise-alert_root__mvEIF"><span class="g-screen-reader-only">Enterprise</span><span aria-hidden="true" class="badge_root___Z7Nt badge_medium__8VGoW badge_outlined-neutral__32YXY enterprise-alert_badge___N2fV"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg><span>Enterprise</span></span><p class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular enterprise-alert_text__CGyqh">This feature requires<!-- --> <a target="_blank" rel="noopener noreferrer" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-200 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="opens-in-new-tab-label-react-aria-52" href="https://www.hashicorp.com/products/consul">Consul<!-- --> <!-- -->Enterprise</a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-52">(opens in new tab)</span>.</p></div><div class="alert alert-warning g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/consul/commands/snapshot/agent"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">agent</code></a> subcommand described here is
available only in <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://www.hashicorp.com/products/consul/">Consul Enterprise</a>
version 0.7.1 and later. All other <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/consul/commands/snapshot">snapshot subcommands</a>
are available in the community edition of Consul.</p></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot agent</code> subcommand starts a process that takes snapshots of the
state of the Consul servers and saves them locally, or pushes them to optional
remote storage services.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The agent can be run as a long-running daemon process or in a one-shot mode
from a batch job, based on the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/consul/commands/snapshot/agent#interval"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-interval</code></a> argument. Snapshotting
a remote datacenter is only available in one-shot mode.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">As a long-running daemon, the agent will perform a leader election so multiple
processes can be run in a highly available fashion with automatic failover. The
agent will also register itself with Consul as a service, along with health
checks that show the agent is alive (&quot;Consul Snapshot Agent Alive&quot;) and able to
take snapshots (&quot;Consul Snapshot Agent Saving Snapshots&quot;). The latter check is
only added on agents who have become a leader, so it&#x27;s possible for operators to
tell which instances are alive and on standby and which instance has become
leader and starting saving snapshots.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">As snapshots are saved, they will be reported in the log produced by the agent:</p><div class="hds-code-block hds-code-block--theme-dark language-text hds-code-block--is-standalone language-text mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R4ddal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span>2023/11/16 21:21:13 [INFO] Snapshot agent running</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span>2023/11/16 21:21:13 [INFO] Waiting to obtain leadership...</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span>2023/11/16 21:21:13 [INFO] Obtained leadership</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span>2023/11/16 21:21:13 [INFO] Saved snapshot 1479360073448728784</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary-white hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R4ddal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R1q4ddal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The number shown with the saved snapshot is its ID, which is based on a UNIX
timestamp with nanosecond resolution, so collisions are unlikely and IDs are
monotonically increasing with time. This makes it easy to locate the latest
snapshot, even if the log data isn&#x27;t available. The snapshot ID always appears
in the file name when using local storage, or in the object key when using
remote storage.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Snapshots can be restored using the
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/consul/commands/snapshot/restore"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">consul snapshot restore</code></a> command, or
the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/consul/api-docs/snapshot">HTTP API</a>.</p><h2 id="acl-permissions" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="acl permissions permalink" href="/consul/commands/snapshot/agent#acl-permissions"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>ACL permissions</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If ACLs are enabled the following privileges are required:</p><div class="mdx-table_root__adKqa"><div class="mdx-table_tableWrapper__81O9J"><table><thead><tr><th>Resource</th><th>Segment</th><th>Permission</th><th>Explanation</th></tr></thead><tbody><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">acl</code></td><td>N/A</td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">write</code></td><td>All snapshotting operations require this privilege due to snapshots containing ACL tokens including unredacted secrets.</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">key</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;lock key&gt;</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">write</code></td><td>The lock key (which defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">consul-snapshot/lock</code>) is used during snapshot agent leader election.</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;agent name&gt;</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">write</code></td><td>The session used for locking during leader election is created against the agent name of the Consul agent that the Snapshot agent is registering itself with.</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">service</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;service name&gt;</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">write</code></td><td>The Snapshot agent registers itself with the local Consul agent and must have write privileges on its service name which is configured with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-service</code>.</td></tr></tbody></table></div><div class="mdx-table_tableFocusRing__qNrYf"></div><div><div class="mdx-table_leftScrim__mYsmq mdx-table_scrim__VtktE"></div><div class="mdx-table_rightScrim__Ikt63 mdx-table_scrim__VtktE"></div></div></div><h3 id="example-acl-policy" class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="example acl policy permalink" href="/consul/commands/snapshot/agent#example-acl-policy"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Example ACL policy</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following is a example least privilege policy which allows the snapshot agent
to run on a node named <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">server-1234</code>.</p><div><div><div class="tabs_tabControls__T_UOv tabs_isCheckingOverflow__HYdy4 tabs_showAnchorLine__oSYFX"><div class="tab-button-controls_tabList__ueYEe" role="tablist"><button class="tab-button-controls_tabButton__l1jN9 g-focus-ring-from-box-shadow" aria-controls="panel-0-react-aria-59" aria-selected="true" id="tab-0-react-aria-59" role="tab" tabindex="0" type="button"><span class="tab-button-controls_label__GDzfu hds-typography-body-200">HCL</span></button><button class="tab-button-controls_tabButton__l1jN9 g-focus-ring-from-box-shadow" aria-controls="panel-1-react-aria-59" aria-selected="false" id="tab-1-react-aria-59" role="tab" tabindex="-1" type="button"><span class="tab-button-controls_label__GDzfu hds-typography-body-200">JSON</span></button></div></div><div aria-hidden="false" aria-labelledby="tab-0-react-aria-59" class="tabs_tabPanel__lKCo_" id="panel-0-react-aria-59" role="tabpanel"><div class="hds-code-block hds-code-block--theme-dark language-hcl hds-code-block--is-standalone language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R1k8ddal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-comment)"># Required to read and snapshot ACL data</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">acl </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;write&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-comment)"># Allow the snapshot agent to create the key consul-snapshot/lock which will</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-comment)"># serve as a leader election lock when multiple snapshot agents are running in</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-comment)"># an environment</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-function)">key</span><span style="color:var(--hds-code-block-color-constant)"> &quot;consul-snapshot/lock&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">  policy </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;write&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-comment)"># Allow the snapshot agent to create sessions on the specified node</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-function)">session</span><span style="color:var(--hds-code-block-color-constant)"> &quot;server-1234&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">  policy </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;write&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-comment)"># Allow the snapshot agent to register itself into the catalog</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-function)">service</span><span style="color:var(--hds-code-block-color-constant)"> &quot;consul-snapshot&quot;</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">  policy </span><span style="color:var(--hds-code-block-color-keyword)">=</span><span style="color:var(--hds-code-block-color-string)"> &quot;write&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary-white hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R1k8ddal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R3lk8ddal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div></div><div aria-hidden="true" aria-labelledby="tab-1-react-aria-59" class="tabs_tabPanel__lKCo_" id="panel-1-react-aria-59" role="tabpanel"><div class="hds-code-block hds-code-block--theme-dark language-json hds-code-block--is-standalone language-json mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R2k8ddal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">{</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">  &quot;acl&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;write&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">  &quot;key&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;consul-snapshot/lock&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;policy&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;write&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">  }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">  &quot;session&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;server-1234&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;policy&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;write&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">  }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">  &quot;service&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;consul-snapshot&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;policy&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;write&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary-white hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R2k8ddal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R3mk8ddal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Additional <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session</code> rules should be created, or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session_prefix</code> used, if the
snapshot agent is deployed across more than one host.</p><h2 id="usage" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="usage permalink" href="/consul/commands/snapshot/agent#usage"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Usage</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Usage: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">consul snapshot agent [options]</code></p><h4 id="config-file-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="config file options permalink" href="/consul/commands/snapshot/agent#config-file-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Config File Options</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="config-dir" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="config dir permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#config-dir"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-config-dir</code></a> - Directory to look for JSON config files. Files will be read in
alphabetical order and must end with the extension &quot;.json&quot;. This won&#x27;t
recursively descend directories. This can be specified multiple times on the
command line.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="config-file" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="config file permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#config-file"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-config-file</code></a> - File to read JSON configuration from. Files must end with the
extension &quot;.json&quot;. This can be specified multiple times on the command line.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Config files referenced using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-config-dir</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-config-file</code> have the following
format (shown populated with default values):</p></li></ul><div class="alert alert-warning g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Top-level single snapshot destinations in a config file are deprecated and will be removed in a future version. Move top-level <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">local_storage</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws_storage</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">azure_blob_storage</code>, and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">google_storage</code> config objects to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_agent -&gt; backup_destinations</code> instead.</p></div><div class="hds-code-block hds-code-block--theme-dark language-json hds-code-block--is-standalone language-json mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":Rbtdal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">{</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">  &quot;snapshot_agent&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;http_addr&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;127.0.0.1:8500&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;token&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;datacenter&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;ca_file&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;ca_path&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;cert_file&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;key_file&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;license_path&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;tls_server_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;login&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;auth_method&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;bearer_token&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;bearer_token_file&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;meta&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {}</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">    }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;log&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;level&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;INFO&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;enable_syslog&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> false</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;syslog_facility&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;LOCAL0&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">    }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;snapshot&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;interval&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;1h&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;retain&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> 30</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;stale&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> false</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;service&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;consul-snapshot&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;deregister_after&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;72h&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;lock_key&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;consul-snapshot/lock&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;max_failures&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-constant)"> 3</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;local_scratch_path&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">    }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">    &quot;backup_destinations&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;local_storage&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">        {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;path&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;.&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">        }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">      ]</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;aws_storage&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">        {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;access_key_id&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;secret_access_key&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;session_token&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;iam_endpoint&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;role_arn&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;role_session_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;web_identity_token_file&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;sts_endpoint&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;s3_region&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;s3_endpoint&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;s3_bucket&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;s3_key_prefix&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;consul-snapshot&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">        }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">      ]</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;azure_blob_storage&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">        {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;account_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;account_key&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;container_name&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">        }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">      ]</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;google_storage&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">        {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">          &quot;bucket&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">        }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">      ]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">  }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary-white hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":Rbtdal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R1qbtdal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">All fields are optional, and config files without a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_agent</code> object will
be ignored. At least one config file needs to have a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_agent</code> object, or the
snapshot agent will fail to start. The Consul agent is set up to ignore any
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_agent</code> object, so it&#x27;s safe to use common config directories for both agents
if desired.</p><h4 id="snapshot-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="snapshot options permalink" href="/consul/commands/snapshot/agent#snapshot-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Snapshot Options</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="interval" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="interval permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#interval"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-interval</code></a> - Interval at which to perform snapshots as
a time with a unit suffix, which can be &quot;s&quot;, &quot;m&quot;, &quot;h&quot; for seconds, minutes, or
hours. If 0 is provided, the agent will take a single snapshot and then exit, which
is useful for running snapshots via batch jobs. Defaults to &quot;1h&quot;</p></li><li class="mdx-lists_listItem__nkqhg"><a id="lock-key" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="lock key permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#lock-key"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-lock-key</code></a> - A prefix in Consul&#x27;s KV store used to coordinate between
different instances of the snapshot agent in order to only have one active instance
at a time. For highly available operation of the snapshot agent, simply run
multiple instances. All instances must be configured with the same lock key in
order to properly coordinate. Defaults to &quot;consul-snapshot/lock&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="max-failures" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="max failures permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#max-failures"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-max-failures</code></a> - Number of snapshot failures after which the snapshot agent
will give up leadership. In a highly available operation with multiple snapshot
agents available, this gives another agent a chance to take over if an agent
is experiencing issues, such as running out of disk space for snapshots.
Defaults to 3.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="retain" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="retain permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#retain"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-retain</code></a> - Number of snapshots to retain. After each snapshot is taken, the
oldest snapshots will start to be deleted in order to retain at most this many
snapshots. If this is set to 0, the agent will not perform this and snapshots
will accumulate forever. Defaults to 30.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="local-scratch-path" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="local scratch path permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#local-scratch-path"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-local-scratch-path</code></a> - Location to store all temporary snapshots in prior to
sending them off to the configured storage backend. If not configured the
system temporary directory will be used.</p></li></ul><h4 id="agent-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="agent options permalink" href="/consul/commands/snapshot/agent#agent-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Agent Options</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="deregister-after" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="deregister after permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#deregister-after"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-deregister-after</code></a> - An interval, after which if the agent is unhealthy it will be
automatically deregistered from Consul service discovery. This is a time with a
unit suffix, which can be &quot;s&quot;, &quot;m&quot;, &quot;h&quot; for seconds, minutes, or hours. If 0 is
provided, this will be disabled. Defaults to &quot;72h&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="log-level" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="log level permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#log-level"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-log-level</code></a> - Controls verbosity of snapshot agent logs. Valid options are
&quot;trace&quot;, &quot;debug&quot;, &quot;info&quot;, &quot;warn&quot;, &quot;error&quot;. Defaults to &quot;info&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="service" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="service permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#service"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-service</code></a> - The service name to use when registering the agent with Consul.
Registering helps monitor running agents and the leader registers an additional
health check to monitor that snapshots are taking place. Defaults to
&quot;consul-snapshot&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="syslog" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="syslog permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#syslog"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-syslog</code></a> - This enables forwarding logs to syslog. Defaults to false.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="syslog-facility" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="syslog facility permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#syslog-facility"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-syslog-facility</code></a> - Sets the facility to use for forwarding logs to syslog.
Defaults to &quot;LOCAL0&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="login-auth-method" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="login auth method permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#login-auth-method"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">login-auth-method</code></a> - Auth method name to use to log into Consul. If provided, the token obtained with this auth method
will be used instead of a static token if it is provided. Currently, only <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">kubernetes</code> auth method type is supported.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="login-bearer-token" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="login bearer token permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#login-bearer-token"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">login-bearer-token</code></a> - Bearer token to use to log into Consul. Used only if <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-login-auth-method</code> is set.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="login-bearer-token-file" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="login bearer token file permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#login-bearer-token-file"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">login-bearer-token-file</code></a> - A file container bearer token to use for logging into Consul.
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-login-bearer-token</code> is ignored if this flag is provided.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="login-meta" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="login meta permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#login-meta"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">login-meta</code></a> - Metadata to set on the token, formatted as key=value. This flag may be provided multiple times.</p></li></ul><h4 id="local-storage-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="local storage options permalink" href="/consul/commands/snapshot/agent#local-storage-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Local Storage Options</h4><div class="alert alert-warning g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This option is deprecated when used with a top-level <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">local_storage</code> object in a config file. Use <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_agent -&gt; backup_destinations -&gt; local_storage[0]</code> in a config file instead.</p></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This option cannot be used when using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">backup_destinations</code> in a config file.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="local-path" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><a aria-label="local path permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#local-path"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-local-path</code></a> - Location to store snapshots locally. The default behavior
of the snapshot agent is to store snapshots locally in this directory. Defaults
to &quot;.&quot; to use the current working directory. If an alternate remote storage
option is configured, then local storage will be disabled and this option will
be ignored.</li></ul><h4 id="s3-storage-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="s3 storage options permalink" href="/consul/commands/snapshot/agent#s3-storage-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>S3 Storage Options</h4><div class="alert alert-warning g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">These options are deprecated when used with a top-level <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws_storage</code> object in a config file. Use <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_agent -&gt; backup_destinations -&gt; aws_storage[0]</code> in a config file instead.</p></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">These options cannot be used when using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">backup_destinations</code> in a config file.
Note that despite the AWS references, any S3-compatible endpoint can be specified with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-endpoint</code>.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="aws-access-key-id" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws access key id permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-access-key-id"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-access-key-id</code></a>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-secret-access-key</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-session-token</code> - These arguments supply static
authentication information for connecting to S3. These may also be supplied using
the following alternative methods:<br/></p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="aws_access_key_id" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><a aria-label="aws_access_key_id permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws_access_key_id"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_ACCESS_KEY_ID</code></a>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_SECRET_ACCESS_KEY</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_SESSION_TOKEN</code> environment variables</li><li class="mdx-lists_listItem__nkqhg">A credentials file (<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">~/.aws/credentials</code> or the file at the path specified by the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_SHARED_CREDENTIALS_FILE</code> environment variable)</li><li class="mdx-lists_listItem__nkqhg">ECS task role metadata (container-specific)</li><li class="mdx-lists_listItem__nkqhg">EC2 instance role metadata</li></ul></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-iam-endpoint" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws iam endpoint permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-iam-endpoint"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-iam-endpoint</code></a> - IAM endpoint to use when authenticating with static credentials.
Default is to use the global IAM endpoint.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-role-arn" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws role arn permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-role-arn"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-role-arn</code></a>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-role-session-name</code>, and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-web-identity-token-file</code> - These arguments are
used to obtain temporary credentials by assuming an IAM role. These may also be supplied using
the following alternative methods:<br/></p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="aws_role_arn" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><a aria-label="aws_role_arn permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws_role_arn"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_ROLE_ARN</code></a>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_ROLE_SESSION_NAME</code>, and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_WEB_IDENTITY_TOKEN_FILE</code> environment variables.</li><li class="mdx-lists_listItem__nkqhg">A credentials file (~/.aws/credentials or the file at the path specified by the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_SHARED_CREDENTIALS_FILE</code> environment variable)</li></ul></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-sts-endpoint" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws sts endpoint permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-sts-endpoint"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-sts-endpoint</code></a> - STS endpoint to use for obtaining temporary credentials.
Default is to use the global STS endpoint.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-bucket" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 bucket permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-s3-bucket"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-bucket</code></a> - S3 bucket to use. Required for S3 storage, and setting this
disables local storage. This should be only the bucket name without any
part of the key prefix.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-key-prefix" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 key prefix permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-s3-key-prefix"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-key-prefix</code></a> - Prefix to use for snapshot files in S3. Defaults to
&quot;consul-snapshot&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-region" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 region permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-s3-region"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-region</code></a> - S3 region to use. Required for S3 storage.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-endpoint" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 endpoint permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-s3-endpoint"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-endpoint</code></a> - S3 endpoint to use. Can also be specified using the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_S3_ENDPOINT</code> environment variable. Defaults to the regional S3 endpoint.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-server-side-encryption" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 server side encryption permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-s3-server-side-encryption"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-server-side-encryption</code></a> - Enables saving snapshots to S3 using server side encryption with <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingServerSideEncryption.html">Amazon S3-Managed Encryption Keys</a></p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-static-snapshot-name" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 static snapshot name permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-s3-static-snapshot-name"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-static-snapshot-name</code></a> - If this is given, all snapshots are saved with the same file name. The agent will not rotate or version snapshots, and will save them with the same name each time.
Use this if you want to rely on <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="http://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html">S3&#x27;s versioning capabilities</a> instead of the agent handling it for you.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-force-path-style" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 force path style permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-s3-force-path-style"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-force-path-style</code></a> - Enables the use of legacy path-based addressing instead of virtual addressing. This flag is required by minio
and other 3rd party S3 compatible object storage platforms where DNS or TLS requirements for virtual addressing are prohibitive.
For more information, refer to the AWS documentation on <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-bucket-intro.html">Methods for accessing a bucket</a></p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-enable-kms" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 enable kms permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-s3-enable-kms"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-enable-kms</code></a> - Enables using <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://aws.amazon.com/kms/">Amazon KMS</a> for encrypting snapshots.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-kms-key" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 kms key permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#aws-s3-kms-key"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-kms-key</code></a> - Optional Amazon KMS key to use, if this is not set the default KMS master key will be used. Set this if you want to manage key rotation yourself.</p><div class="alert alert-info g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">When using a S3-compatible storage exposing a self-signed certificate the agent will not be able to perform
the snapshot operations unless the CA used to sign the storage certificate is trusted by the node running
the agent. You can add the CA root certificate to the OS trust store to have Consul trust the storage endpoint.</p></div></li></ul><h4 id="s3-required-permissions" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="s3 required permissions permalink" href="/consul/commands/snapshot/agent#s3-required-permissions"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>S3 Required Permissions</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Different S3 permissions are required depending on the configuration of the snapshot agent. In particular extra permissions are required when
snapshot rotation is enabled. S3 storage snapshot rotation is enabled when the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">retain</code> configuration is greater than 0 and when there is
no <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws-s3-static-snapshot-name</code> configured.</p><div class="mdx-table_root__adKqa"><div class="mdx-table_tableWrapper__81O9J"><table><thead><tr><th>Permission</th><th>Resource</th><th>When you need it</th></tr></thead><tbody><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">PutObject</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">arn:aws:s3:::&lt;bucket name&gt;/&lt;key&gt;</code></td><td>Required for all operations.</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">DeleteObject</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">arn:aws:s3:::&lt;bucket name&gt;/&lt;key&gt;</code></td><td>Required only when snapshot rotation is enabled</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ListBucket</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">arn:aws:s3:::&lt;bucket name&gt;</code></td><td>Required only when snapshot rotation is enabled</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ListBucketVersions</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">arn:aws:s3:::&lt;bucket name&gt;</code></td><td>Required only when snapshot rotation is enabled</td></tr></tbody></table></div><div class="mdx-table_tableFocusRing__qNrYf"></div><div><div class="mdx-table_leftScrim__mYsmq mdx-table_scrim__VtktE"></div><div class="mdx-table_rightScrim__Ikt63 mdx-table_scrim__VtktE"></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Within the table <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;key&gt;</code> refers to the key used to store the snapshot. When <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws-s3-static-snapshot-name</code> is configured the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;key&gt;</code> is simply the value of that configuration. Otherwise the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;key&gt;</code> will be the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;aws-s3-key-prefix configuration&gt;/consul-*.snap</code>.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following example IAM policy document assumes that the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws-s3-bucket</code> is <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">consul-data</code> with defaults for <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws-s3-key-prefix</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws-s3-static-snapshot-name</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">retain</code>:</p><div class="hds-code-block hds-code-block--theme-dark language-json hds-code-block--is-standalone language-json mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":Rlddal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">{</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">  &quot;Version&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;2012-10-17&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">  &quot;Statement&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">    {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;Sid&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;Effect&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;Allow&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;Action&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;s3:PutObject&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span><span style="color:var(--hds-code-block-color-string)"> &quot;s3:DeleteObject&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;Resource&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;arn:aws:s3:::consul-data/consul-snapshots/consul-*.snap&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">    }</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">    {</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;Sid&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;Effect&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;Allow&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;Action&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-token)"> [</span><span style="color:var(--hds-code-block-color-string)">&quot;s3:ListBucketVersions&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">,</span><span style="color:var(--hds-code-block-color-string)"> &quot;s3:ListBucket&quot;</span><span style="color:var(--hds-code-block-color-token)">]</span><span style="color:var(--hds-code-block-color-punctuation)">,</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-keyword)">      &quot;Resource&quot;</span><span style="color:var(--hds-code-block-color-punctuation)">:</span><span style="color:var(--hds-code-block-color-string)"> &quot;arn:aws:s3:::consul-data&quot;</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">    }</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">  ]</span></span>
</span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-token)">}</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary-white hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":Rlddal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R1qlddal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><h4 id="azure-blob-storage-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="azure blob storage options permalink" href="/consul/commands/snapshot/agent#azure-blob-storage-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Azure Blob Storage options</h4><div class="alert alert-warning g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">These options are deprecated when used with a top-level <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">azure_blob_storage</code> object in a config file. Use <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_agent -&gt; backup_destinations -&gt; azure_blob_storage[0]</code> in a config file instead.</p></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong> Note: This currently only works on non-Solaris platforms due to library limitations </strong></p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">From Consul Enterprise version <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">1.5.0</code> onwards, you can store snapshots in Azure Blob storage.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">These options cannot be used when using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">backup_destinations</code> in a config file.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="azure-blob-account-name" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="azure blob account name permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#azure-blob-account-name"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-azure-blob-account-name</code></a> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-azure-blob-account-key</code> - These arguments supply
authentication information for connecting to Azure Blob storage.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="azure-blob-container-name" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="azure blob container name permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#azure-blob-container-name"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-azure-blob-container-name</code></a> - Container to use. Required for Azure blob storage, and setting this
disables local storage.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="azure-blob-environment" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="azure blob environment permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#azure-blob-environment"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-azure-blob-environment</code></a> - Environment to use. Defaults to AZUREPUBLICCLOUD. Other valid environments
are AZURECHINACLOUD, AZUREGERMANCLOUD and AZUREUSGOVERNMENTCLOUD. Introduced in Consul 1.7.3.</p></li></ul><div class="alert alert-warning g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following options were introduced in v1.20.1+ent.</p></div><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="azure-blob-service-principal-id" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="azure blob service principal id permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#azure-blob-service-principal-id"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-azure-blob-service-principal-id</code></a> - The ID of the service principal that owns the blob object.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="azure-blob-service-principal-secret" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="azure blob service principal secret permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#azure-blob-service-principal-secret"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-azure-blob-service-principal-secret</code></a> - The secret of the service principal that owns the blob object.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="azure-blob-tenant-id" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="azure blob tenant id permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#azure-blob-tenant-id"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-azure-blob-tenant-id</code></a> - The ID of the tenant that owns the Azure blob.</p></li></ul><h4 id="google-cloud-storage-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="google cloud storage options permalink" href="/consul/commands/snapshot/agent#google-cloud-storage-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Google Cloud Storage options</h4><div class="alert alert-warning g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This option is deprecated when used with a top-level <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">google_storage</code> object in a config file. Use <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_agent -&gt; backup_destinations -&gt; google_storage[0]</code> in a config file instead.</p></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">From Consul Enterprise version <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">1.6.1</code> onwards, you can store snapshots in Google Cloud Storage. Authentication relies on automatic discovery through the sdk as described <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://cloud.google.com/docs/authentication/production">here</a>:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">First, ADC checks to see if the environment variable GOOGLE_APPLICATION_CREDENTIALS is set. If the variable is set, ADC uses the service account file that the variable points to. The next section describes how to set the environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If the environment variable isn&#x27;t set, ADC uses the default service account that Compute Engine, Kubernetes Engine, App Engine, and Cloud Functions provide, for applications that run on those services.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If ADC can&#x27;t use either of the above credentials, an error occurs.</p></li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This option cannot be used when using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">backup_destinations</code> in a config file.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This integration needs the following information:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="gcs-bucket" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><a aria-label="gcs bucket permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#gcs-bucket"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-gcs-bucket</code></a> supplies the bucket to use.</li></ul><h4 id="api-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="api options permalink" href="/consul/commands/snapshot/agent#api-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>API Options</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="ca-file" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="ca file permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#ca-file"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-ca-file=&lt;value&gt;</code></a> - Path to a CA file to use for TLS when communicating with Consul.
This can also be specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_CACERT</code> environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="ca-path" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="ca path permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#ca-path"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-ca-path=&lt;value&gt;</code></a> - Path to a directory of CA certificates to use for TLS when
communicating with Consul. This can also be specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_CAPATH</code>
environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="client-cert" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="client cert permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#client-cert"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-client-cert=&lt;value&gt;</code></a> - Path to a client cert file to use for TLS when
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">verify_incoming</code> is enabled. This can also be specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_CLIENT_CERT</code>
environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="client-key" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="client key permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#client-key"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-client-key=&lt;value&gt;</code></a> - Path to a client key file to use for TLS when
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">verify_incoming</code> is enabled. This can also be specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_CLIENT_KEY</code>
environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="http-addr" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="http addr permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#http-addr"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-http-addr=&lt;addr&gt;</code></a> - Address of the Consul agent with the port. This can be
an IP address or DNS address, but it must include the port. This can also be
specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_HTTP_ADDR</code> environment variable. In Consul 0.8 and
later, the default value is <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="http://127.0.0.1:8500">http://127.0.0.1:8500</a>, and https can optionally be
used instead. The scheme can also be set to HTTPS by setting the environment
variable <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_HTTP_SSL=true</code>. This may be a unix domain socket using
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">unix:///path/to/socket</code> if the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/consul/docs/reference/agent/configuration-file/general#addresses">agent is configured to
listen</a> that way.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="tls-server-name" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="tls server name permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#tls-server-name"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-tls-server-name=&lt;value&gt;</code></a> - The server name to use as the SNI host when
connecting via TLS. This can also be specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_TLS_SERVER_NAME</code>
environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="token" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="token permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#token"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-token=&lt;value&gt;</code></a> - ACL token to use in the request. This can also be specified
via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_HTTP_TOKEN</code> environment variable. If unspecified, the query
will default to the token of the Consul agent at the HTTP address.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="token-file" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="token file permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#token-file"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-token-file=&lt;value&gt;</code></a> - File containing the ACL token to use in the request
instead of one specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-token</code> argument or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_HTTP_TOKEN</code>
environment variable. This can also be specified via the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_HTTP_TOKEN_FILE</code> environment variable.</p></li></ul><h2 id="examples" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="examples permalink" href="/consul/commands/snapshot/agent#examples"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Examples</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Running the agent with no arguments will run a long-running daemon process that will
perform leader election for highly available operation, register itself with Consul
service discovery with health checks, take snapshots every hour, retain the last 30
snapshots, and save snapshots into the current working directory:</p><div class="hds-code-block hds-code-block--theme-dark language-shellsession hds-code-block--is-standalone language-shellsession mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":Rvddal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-cyan)">$</span><span style="color:var(--hds-code-block-color-token)"> consul snapshot agent</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary-white hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":Rvddal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R1qvddal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">To run a one-shot backup, set the backup interval to 0. This will run a single snapshot
and delete any old snapshots based on the retain settings, but it will not perform any
leader election or service registration:</p><div class="hds-code-block hds-code-block--theme-dark language-shellsession hds-code-block--is-standalone language-shellsession mdx-code-blocks_codeBlockMargin__xk4yr"><div class="hds-code-block__header"></div><div class="hds-code-block__body"><pre class="hds-code-block__code" id=":R10ddal6j6:" style="max-height:auto"><code><span><span class="line-of-code line-highlight-first line-highlight-last"><span class="line"><span style="color:var(--hds-code-block-color-cyan)">$</span><span style="color:var(--hds-code-block-color-token)"> consul snapshot agent -interval=0</span></span>
</span></span></code></pre><button class="hds-button hds-button--size-small hds-button--color-secondary-white hds-button--is-icon-only hds-copy-button hds-button--size-small hds-copy-button--status-idle hds-code-block__copy-button" aria-label="Copy" aria-describedby=":R10ddal6j6:"><div class="hds-button__icon"><svg class="flight-icon flight-icon-clipboard-copy" aria-hidden="true" fill="currentColor" id=":R1r0ddal6j6:" width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use href="/_next/static/media/svg-sprite.8ce6dd4a.svg#flight-clipboard-copy-16"></use></svg></div></button></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Please see the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/consul/api-docs/snapshot">HTTP API</a> documentation for
more details about snapshot internals.</p><h2 id="licensing" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="licensing permalink" href="/consul/commands/snapshot/agent#licensing"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Licensing</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The snapshot agent requires a license when it starts before it will perform any other
actions. This can be provided using the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">license_path</code> configuration item, the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE_PATH</code> environment variable or the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE</code> environment variable.
The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">license_path</code> configuration and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE_PATH</code> variable should point to
files that contain the license whereas the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE</code> variable value should be
the contents of the license itself. If a license is present in multiple ways the
then the order of precedence is as follows:</p><ol class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="consul_license" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><a aria-label="consul_license permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#consul_license"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE</code></a> variable</li><li class="mdx-lists_listItem__nkqhg"><a id="consul_license_path" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><a aria-label="consul_license_path permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#consul_license_path"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE_PATH</code></a> variable</li><li class="mdx-lists_listItem__nkqhg"><a id="license_path" aria-hidden="true" tabindex="-1" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/consul/commands/snapshot/agent#"></a><a aria-label="license_path permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/consul/commands/snapshot/agent#license_path"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">license_path</code></a> configuration.</li></ol><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The ability to load licenses from the configuration or environment was added in v1.10.0,
v1.9.7 and v1.8.13. See the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/consul/docs/enterprise/license">licensing documentation</a> for
more information about Consul Enterprise license management.</p></div></div><a href="https://github.com/hashicorp/consul/blob/main/website/../content/commands/snapshot/agent.mdx" target="_blank" class="edit-on-github-link_editLink__AsG8Z sidebar-sidecar-layout_editOnGithubLink__SDraB" rel="noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="edit-on-github-link_editLinkIcon__wMtY9"><path fill="currentColor" fill-rule="evenodd" d="M8 1C4.133 1 1 4.13 1 7.993c0 3.09 2.006 5.71 4.787 6.635.35.064.478-.152.478-.337 0-.166-.006-.606-.01-1.19-1.947.423-2.357-.937-2.357-.937-.319-.808-.778-1.023-.778-1.023-.635-.434.048-.425.048-.425.703.05 1.073.72 1.073.72.624 1.07 1.638.76 2.037.582.063-.452.244-.76.444-.935-1.554-.176-3.188-.776-3.188-3.456 0-.763.273-1.388.72-1.876-.072-.177-.312-.888.07-1.85 0 0 .586-.189 1.924.716A6.711 6.711 0 018 4.381c.595.003 1.194.08 1.753.236 1.336-.905 1.923-.717 1.923-.717.382.963.142 1.674.07 1.85.448.49.72 1.114.72 1.877 0 2.686-1.638 3.278-3.197 3.45.251.216.475.643.475 1.296 0 .934-.009 1.688-.009 1.918 0 .187.127.404.482.336A6.996 6.996 0 0015 7.993 6.997 6.997 0 008 1z" clip-rule="evenodd"></path></svg>Edit this page on GitHub</a></main><div class="sidebar-sidecar-layout_sidecarPosition__WtTq0"><div class="sidebar-sidecar-layout_sidecarTopSlot__qRAEI"></div><div class="sidecar-scroll-container_root__a8nIj"><div class="sidecar-scroll-container_scrollContainer__Dw9id"><div><nav aria-labelledby="react-aria-169"><p id="react-aria-169" class="outline-nav_navLabel__HrjQb hds-typography-body-100">On this page:</p><ol class="outline-nav_listRoot__Sm1fr"><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/consul/commands/snapshot/agent#consul-snapshot-agent">Consul Snapshot Agent</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/consul/commands/snapshot/agent#acl-permissions">ACL permissions</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/consul/commands/snapshot/agent#usage">Usage</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/consul/commands/snapshot/agent#examples">Examples</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" href="/consul/commands/snapshot/agent#licensing">Licensing</a></li></ol></nav></div></div></div></div></div></div></div></div></div><div class="base-layout_footer__HGqK8 base-layout_showFooterTopBorder__4_CwH"><footer class="footer_root__qJO_k"><span class="footer_logoAndSwitcher__CJkN3"><a href="https://www.hashicorp.com/" aria-label="Go to HashiCorp home page" class="footer_logo__pe9i3 g-focus-ring-from-box-shadow"><div><svg xmlns="http://www.w3.org/2000/svg" width="266" height="65" fill="none" viewBox="0 0 266 65"><path fill="#000" d="M71.823 62.023c-.817 0-1.171-.519-1.253-1.174h-.081c-.3.874-1.09 1.365-2.097 1.365-1.524 0-2.423-.846-2.423-2.185 0-1.338.98-2.13 3.077-2.13h1.443v-.71c0-1.038-.572-1.584-1.716-1.584-1.143 0-1.443.41-1.851 1.093l-.68-.629c.38-.764 1.252-1.42 2.559-1.42 1.306 0 2.777.929 2.777 2.458v3.987h.816v.984h-.626zm-1.307-2.103v-1.202h-1.498c-1.28 0-1.85.383-1.85 1.093v.3c0 .71.57 1.12 1.442 1.12.871 0 1.906-.573 1.906-1.31M74.137 62.023v-7.265h1.116v1.175h.055c.354-.82.98-1.366 2.042-1.366 1.062 0 2.423 1.01 2.423 2.786v4.67h-1.117v-4.452c0-1.283-.571-1.966-1.633-1.966s-1.77.464-1.77 1.393v5.052h-1.116zM84.646 62.023v-.983h1.389v-7.866h-1.389v-.983h3.92v.983h-1.388v7.866h1.389v.983zM90.8 52.191h4.029c1.606 0 2.614 1.01 2.614 2.54s-.953 1.994-1.58 2.076v.082c.708.054 1.934.655 1.934 2.294 0 1.638-1.09 2.84-2.532 2.84h-4.466zm1.17 4.26h2.723c.925 0 1.497-.49 1.497-1.365v-.492c0-.873-.572-1.365-1.497-1.365H91.97zm0 4.534h2.913c1.008 0 1.634-.546 1.634-1.53v-.49c0-.984-.626-1.53-1.634-1.53H91.97v3.523zM100.056 52.191h1.579l2.805 5.298h.081l2.832-5.298h1.525v9.832h-1.144v-8.275h-.082l-.816 1.639-2.342 4.287-2.341-4.287-.817-1.64h-.082v8.276h-1.143v-9.832zM113.86 57.162c0-3.278 1.47-5.135 3.948-5.135 2.477 0 2.75.792 3.376 2.158l-.953.573c-.381-1.01-1.198-1.666-2.423-1.666s-2.696 1.339-2.696 3.36v1.474c0 2.021 1.008 3.25 2.696 3.25 1.688 0 2.096-.71 2.505-1.775l.953.601c-.627 1.393-1.825 2.24-3.431 2.24-2.478 0-3.948-1.748-3.948-5.026zM122.491 58.39c0-2.32 1.334-3.796 3.267-3.796 1.933 0 3.267 1.503 3.267 3.797 0 2.294-1.334 3.796-3.267 3.796-1.933 0-3.267-1.502-3.267-3.796m5.336.52v-1.038c0-1.53-.844-2.294-2.069-2.294s-2.069.737-2.069 2.294v1.038c0 1.53.844 2.294 2.069 2.294s2.069-.738 2.069-2.294M130.958 62.023v-7.265h1.116v1.175h.055c.327-.738.817-1.366 1.96-1.366 1.144 0 1.824.437 2.205 1.475h.028c.272-.792.98-1.475 2.205-1.475s2.369 1.01 2.369 2.786v4.67h-1.117v-4.452c0-1.283-.49-1.966-1.579-1.966s-1.688.464-1.688 1.393v5.052h-1.116V57.6c0-1.284-.49-1.967-1.552-1.967s-1.715.465-1.715 1.393v5.053h-1.116zM143.292 54.758h1.116v1.175h.054c.381-.929 1.117-1.366 2.124-1.366 1.824 0 2.94 1.475 2.94 3.796 0 2.322-1.143 3.797-2.94 3.797s-1.688-.465-2.124-1.366h-.054v3.987h-1.116V54.704zm5.036 4.26V57.79c0-1.284-.789-2.158-2.042-2.158-1.252 0-1.878.601-1.878 1.393v2.704c0 .956.844 1.475 1.878 1.475 1.035 0 2.042-.874 2.042-2.158zM156.768 62.023c-.816 0-1.17-.519-1.252-1.174h-.082c-.299.874-1.089 1.365-2.096 1.365-1.525 0-2.423-.846-2.423-2.185 0-1.338.98-2.13 3.076-2.13h1.443v-.71c0-1.038-.571-1.584-1.715-1.584-1.143 0-1.443.41-1.851 1.093l-.681-.629c.381-.764 1.253-1.42 2.559-1.42 1.307 0 2.777.929 2.777 2.458v3.987h.817v.984h-.626zm-1.334-2.103v-1.202h-1.497c-1.28 0-1.851.383-1.851 1.093v.3c0 .71.571 1.12 1.443 1.12.871 0 1.905-.573 1.905-1.31M159.056 62.023v-7.265h1.116v1.175h.054c.354-.82.98-1.366 2.042-1.366 1.062 0 2.423 1.01 2.423 2.786v4.67h-1.116v-4.452c0-1.283-.572-1.966-1.633-1.966-1.062 0-1.77.464-1.77 1.393v5.052h-1.116zM171.471 54.758h1.116l-3.24 8.958c-.327.874-.626 1.12-1.688 1.12h-.572v-.983h1.144l.544-1.557-2.722-7.538h1.116l1.742 4.944.327 1.174h.082l.381-1.174 1.742-4.944zM66.132 12.863h5.582v12.045H84.51V12.863h5.636V42.36H84.51V29.96H71.714v12.4h-5.582zM93.74 36.651c0-4.424 3.104-5.899 6.888-6.8l6.398-1.475v-.519c0-2.157-1.388-3.496-3.621-3.496-2.232 0-3.54 1.23-3.948 3.25l-4.791-.546c.707-4.042 4.11-6.664 8.957-6.664 4.846 0 8.821 3.387 8.821 8.303v8.63c0 .546.164.71.545.71h1.17v4.288h-3.267c-2.069 0-2.995-.683-2.995-2.349 0-1.666.082-1.092.3-1.857l-.463-.164c-1.525 3.277-3.73 4.725-6.888 4.725s-7.106-2.403-7.106-6.063zm8.549 2.103c2.777 0 4.737-2.02 4.737-5.216v-1.693l-4.574 1.092c-2.314.546-3.267 1.338-3.267 3.113 0 1.776 1.225 2.704 3.104 2.704M116.147 36.542l5.119-1.01c.544 2.266 2.341 3.413 4.737 3.413s3.73-.983 3.73-2.621c0-1.64-1.606-1.994-4.629-2.54-3.811-.601-8.766-1.311-8.766-6.61 0-5.298 3.403-6.8 8.957-6.8s8.74 2.076 9.611 6.227l-5.173.847c-.463-2.104-2.178-3.196-4.465-3.196s-3.649 1.065-3.649 2.485 1.634 1.994 4.656 2.54c3.785.601 8.74 1.311 8.74 6.61 0 5.298-3.376 6.964-9.039 6.964s-8.958-2.103-9.883-6.336zM143.836 42.387h-5.472V12.044h5.472v9.45c0 1.092-.218 2.157-.517 3.714l.517.164c1.307-3.114 3.267-4.943 6.943-4.943 3.675 0 7.133 2.95 7.133 7.974v13.984h-5.473v-13.82c0-2.458-1.225-3.796-3.648-3.796s-4.955 2.103-4.955 5.817zM169.129 36.924c0 .847.3 1.093.926 1.093h2.396v4.342h-4.955c-2.478 0-3.812-1.393-3.812-3.96V25.263h-3.022V20.92h8.494v16.004zm-6.207-21.74c0-1.856 1.524-3.386 3.321-3.386 1.797 0 3.322 1.53 3.322 3.387a3.305 3.305 0 0 1-3.322 3.332 3.305 3.305 0 0 1-3.321-3.332M174.248 27.639c0-8.85 5.799-15.24 14.185-15.24 8.385 0 11.897 4.097 13.177 9.64l-5.554 1.34c-1.062-3.879-3.621-6.064-7.651-6.064-4.029 0-8.358 4.26-8.358 10.324 0 6.063 3.376 10.323 8.576 10.323 5.2 0 6.643-2.24 7.705-6.363l5.255.6c-1.253 6.61-6.126 10.707-13.014 10.707-6.889 0-14.321-6.419-14.321-15.24zM203.87 31.626c0-6.527 4.574-11.197 10.918-11.197 6.343 0 10.917 4.67 10.917 11.197 0 6.527-4.574 11.252-10.917 11.252-6.344 0-10.918-4.725-10.918-11.252m16.39 0c0-4.042-2.151-6.746-5.472-6.746-3.322 0-5.473 2.704-5.473 6.746s2.178 6.8 5.473 6.8c3.294 0 5.472-2.703 5.472-6.8M229.163 20.92h5.037v.847c0 1.147-.055 2.075-.381 3.796l.517.137c.79-2.813 2.26-4.752 5.717-4.752h1.552v5.325h-2.232c-3.077 0-4.738 1.857-4.738 5.271v10.87h-5.472v-21.44zM244.165 20.92h5.39v.983c0 .984-.081 1.72-.381 3.469l.517.136c1.307-3.413 3.73-5.052 6.889-5.052 5.2 0 9.338 4.288 9.338 11.197 0 6.91-4.111 11.253-9.338 11.253-5.228 0-5.473-1.64-6.807-5.108l-.463.164c.245 1.694.327 2.485.327 3.414v9.64h-5.472zm16.308 10.706c0-4.178-2.26-6.746-5.472-6.746-3.213 0-5.473 2.568-5.473 6.746 0 4.179 2.26 6.8 5.473 6.8 3.212 0 5.472-2.567 5.472-6.8M21.781 0 0 12.618v30.26l8.168 4.725v-30.26L21.78 9.476z"/><path fill="#000" d="M30.466 0v24.116h-8.685v-9.013l-8.195 4.752v30.889l8.195 4.724V31.435h8.685v8.958l8.195-4.752V4.752z"/><path fill="#000" d="m30.466 55.496 21.781-12.618v-30.26l-8.195-4.725v30.26L30.466 46.02z"/></svg></div></a><span class="footer_themeSwitcher__CPJxw hds-font-weight-regular"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-175">Theme</label></span></span><ul class="footer_links__t81SU"><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="/certifications"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Certifications</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://status.hashicorp.com"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">System Status</span></a></li><li><button class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Cookie Manager</span></button></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/terms-of-service"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Terms of Use</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trust/security"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Security</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/privacy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Privacy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trademark-policy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trademark Policy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trade-controls"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trade Controls</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trust/accessibility"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Accessibility</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="opens-in-new-tab-label-react-aria-184" target="_blank" href="https://forms.gle/fnHLuNahLEhjuKvE6"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Give Feedback</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-184">(opens in new tab)</span></li></ul></footer></div></div></div><div style="position:fixed;z-index:99;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none;inset:24px"></div><!--$--><!--/$--></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"layoutProps":{"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Consul","url":"/consul"},{"title":"CLI","url":"/consul/commands","isCurrentPage":false},{"title":"snapshot","url":"/consul/commands/snapshot"},{"title":"agent","url":"/consul/commands/snapshot/agent","isCurrentPage":true}],"sidebarNavDataLevels":[{"levelButtonProps":{"levelDownButtonText":"Consul Home"},"menuItems":[{"leadingIconName":"home","title":"HashiCorp Developer","href":"/"},{"leadingIconName":"guide","title":"Tutorials","href":"/tutorials"},{"divider":true},{"heading":"Products"},{"leadingIconName":"hcp","title":"HashiCorp Cloud Platform","href":"/hcp"},{"leadingIconName":"terraform","title":"Terraform","href":"/terraform"},{"leadingIconName":"packer","title":"Packer","href":"/packer"},{"leadingIconName":"consul","title":"Consul","href":"/consul"},{"leadingIconName":"vault","title":"Vault","href":"/vault"},{"leadingIconName":"boundary","title":"Boundary","href":"/boundary"},{"leadingIconName":"nomad","title":"Nomad","href":"/nomad"},{"leadingIconName":"waypoint","title":"Waypoint","href":"/waypoint"},{"leadingIconName":"vagrant","title":"Vagrant","href":"/vagrant"}],"showFilterInput":false,"title":"Main Menu"},{"levelButtonProps":{"levelUpButtonText":"Main Menu","levelDownButtonText":"Previous"},"menuItems":[{"title":"Consul","fullPath":"/consul","theme":"consul"},{"title":"Install","fullPath":"/consul/install"},{"title":"Tutorials","fullPath":"/consul/tutorials"},{"title":"Documentation","fullPath":"/consul/docs"},{"title":"API","fullPath":"/consul/api-docs"},{"title":"CLI","fullPath":"/consul/commands"}],"showFilterInput":false,"title":"Consul","visuallyHideTitle":true},{"backToLinkProps":{"text":"Consul Home","href":"/consul"},"levelButtonProps":{"levelUpButtonText":"Consul Home"},"menuItems":[{"title":"CLI","fullPath":"/consul/commands","theme":"consul"},{"title":"acl","routes":[{"title":"Overview","path":"acl","filePath":"../content/commands/acl/index.mdx","fullPath":"/consul/commands/acl","id":"sidebar-nav-item-2"},{"title":"auth-method","routes":[{"title":"Overview","path":"acl/auth-method","filePath":"../content/commands/acl/auth-method/index.mdx","fullPath":"/consul/commands/acl/auth-method","id":"sidebar-nav-item-4"},{"title":"create","path":"acl/auth-method/create","filePath":"../content/commands/acl/auth-method/create.mdx","fullPath":"/consul/commands/acl/auth-method/create","id":"sidebar-nav-item-5"},{"title":"delete","path":"acl/auth-method/delete","filePath":"../content/commands/acl/auth-method/delete.mdx","fullPath":"/consul/commands/acl/auth-method/delete","id":"sidebar-nav-item-6"},{"title":"list","path":"acl/auth-method/list","filePath":"../content/commands/acl/auth-method/list.mdx","fullPath":"/consul/commands/acl/auth-method/list","id":"sidebar-nav-item-7"},{"title":"read","path":"acl/auth-method/read","filePath":"../content/commands/acl/auth-method/read.mdx","fullPath":"/consul/commands/acl/auth-method/read","id":"sidebar-nav-item-8"},{"title":"update","path":"acl/auth-method/update","filePath":"../content/commands/acl/auth-method/update.mdx","fullPath":"/consul/commands/acl/auth-method/update","id":"sidebar-nav-item-9"}],"id":"sidebar-nav-item-3"},{"title":"binding-rule","routes":[{"title":"Overview","path":"acl/binding-rule","filePath":"../content/commands/acl/binding-rule/index.mdx","fullPath":"/consul/commands/acl/binding-rule","id":"sidebar-nav-item-11"},{"title":"create","path":"acl/binding-rule/create","filePath":"../content/commands/acl/binding-rule/create.mdx","fullPath":"/consul/commands/acl/binding-rule/create","id":"sidebar-nav-item-12"},{"title":"delete","path":"acl/binding-rule/delete","filePath":"../content/commands/acl/binding-rule/delete.mdx","fullPath":"/consul/commands/acl/binding-rule/delete","id":"sidebar-nav-item-13"},{"title":"list","path":"acl/binding-rule/list","filePath":"../content/commands/acl/binding-rule/list.mdx","fullPath":"/consul/commands/acl/binding-rule/list","id":"sidebar-nav-item-14"},{"title":"read","path":"acl/binding-rule/read","filePath":"../content/commands/acl/binding-rule/read.mdx","fullPath":"/consul/commands/acl/binding-rule/read","id":"sidebar-nav-item-15"},{"title":"update","path":"acl/binding-rule/update","filePath":"../content/commands/acl/binding-rule/update.mdx","fullPath":"/consul/commands/acl/binding-rule/update","id":"sidebar-nav-item-16"}],"id":"sidebar-nav-item-10"},{"title":"bootstrap","path":"acl/bootstrap","filePath":"../content/commands/acl/bootstrap.mdx","fullPath":"/consul/commands/acl/bootstrap","id":"sidebar-nav-item-17"},{"title":"policy","routes":[{"title":"Overview","path":"acl/policy","filePath":"../content/commands/acl/policy/index.mdx","fullPath":"/consul/commands/acl/policy","id":"sidebar-nav-item-19"},{"title":"create","path":"acl/policy/create","filePath":"../content/commands/acl/policy/create.mdx","fullPath":"/consul/commands/acl/policy/create","id":"sidebar-nav-item-20"},{"title":"delete","path":"acl/policy/delete","filePath":"../content/commands/acl/policy/delete.mdx","fullPath":"/consul/commands/acl/policy/delete","id":"sidebar-nav-item-21"},{"title":"list","path":"acl/policy/list","filePath":"../content/commands/acl/policy/list.mdx","fullPath":"/consul/commands/acl/policy/list","id":"sidebar-nav-item-22"},{"title":"read","path":"acl/policy/read","filePath":"../content/commands/acl/policy/read.mdx","fullPath":"/consul/commands/acl/policy/read","id":"sidebar-nav-item-23"},{"title":"update","path":"acl/policy/update","filePath":"../content/commands/acl/policy/update.mdx","fullPath":"/consul/commands/acl/policy/update","id":"sidebar-nav-item-24"}],"id":"sidebar-nav-item-18"},{"title":"templated policy","routes":[{"title":"Overview","path":"acl/templated-policy","filePath":"../content/commands/acl/templated-policy/index.mdx","fullPath":"/consul/commands/acl/templated-policy","id":"sidebar-nav-item-26"},{"title":"list","path":"acl/templated-policy/list","filePath":"../content/commands/acl/templated-policy/list.mdx","fullPath":"/consul/commands/acl/templated-policy/list","id":"sidebar-nav-item-27"},{"title":"preview","path":"acl/templated-policy/preview","filePath":"../content/commands/acl/templated-policy/preview.mdx","fullPath":"/consul/commands/acl/templated-policy/preview","id":"sidebar-nav-item-28"},{"title":"read","path":"acl/templated-policy/read","filePath":"../content/commands/acl/templated-policy/read.mdx","fullPath":"/consul/commands/acl/templated-policy/read","id":"sidebar-nav-item-29"}],"id":"sidebar-nav-item-25"},{"title":"role","routes":[{"title":"Overview","path":"acl/role","filePath":"../content/commands/acl/role/index.mdx","fullPath":"/consul/commands/acl/role","id":"sidebar-nav-item-31"},{"title":"create","path":"acl/role/create","filePath":"../content/commands/acl/role/create.mdx","fullPath":"/consul/commands/acl/role/create","id":"sidebar-nav-item-32"},{"title":"delete","path":"acl/role/delete","filePath":"../content/commands/acl/role/delete.mdx","fullPath":"/consul/commands/acl/role/delete","id":"sidebar-nav-item-33"},{"title":"list","path":"acl/role/list","filePath":"../content/commands/acl/role/list.mdx","fullPath":"/consul/commands/acl/role/list","id":"sidebar-nav-item-34"},{"title":"read","path":"acl/role/read","filePath":"../content/commands/acl/role/read.mdx","fullPath":"/consul/commands/acl/role/read","id":"sidebar-nav-item-35"},{"title":"update","path":"acl/role/update","filePath":"../content/commands/acl/role/update.mdx","fullPath":"/consul/commands/acl/role/update","id":"sidebar-nav-item-36"}],"id":"sidebar-nav-item-30"},{"title":"set-agent-token","path":"acl/set-agent-token","filePath":"../content/commands/acl/set-agent-token.mdx","fullPath":"/consul/commands/acl/set-agent-token","id":"sidebar-nav-item-37"},{"title":"token","routes":[{"title":"Overview","path":"acl/token","filePath":"../content/commands/acl/token/index.mdx","fullPath":"/consul/commands/acl/token","id":"sidebar-nav-item-39"},{"title":"clone","path":"acl/token/clone","filePath":"../content/commands/acl/token/clone.mdx","fullPath":"/consul/commands/acl/token/clone","id":"sidebar-nav-item-40"},{"title":"create","path":"acl/token/create","filePath":"../content/commands/acl/token/create.mdx","fullPath":"/consul/commands/acl/token/create","id":"sidebar-nav-item-41"},{"title":"delete","path":"acl/token/delete","filePath":"../content/commands/acl/token/delete.mdx","fullPath":"/consul/commands/acl/token/delete","id":"sidebar-nav-item-42"},{"title":"list","path":"acl/token/list","filePath":"../content/commands/acl/token/list.mdx","fullPath":"/consul/commands/acl/token/list","id":"sidebar-nav-item-43"},{"title":"read","path":"acl/token/read","filePath":"../content/commands/acl/token/read.mdx","fullPath":"/consul/commands/acl/token/read","id":"sidebar-nav-item-44"},{"title":"update","path":"acl/token/update","filePath":"../content/commands/acl/token/update.mdx","fullPath":"/consul/commands/acl/token/update","id":"sidebar-nav-item-45"}],"id":"sidebar-nav-item-38"}],"id":"sidebar-nav-item-1"},{"title":"agent","path":"agent","filePath":"../content/commands/agent.mdx","fullPath":"/consul/commands/agent","id":"sidebar-nav-item-46"},{"title":"catalog","routes":[{"title":"Overview","path":"catalog","filePath":"../content/commands/catalog/index.mdx","fullPath":"/consul/commands/catalog","id":"sidebar-nav-item-48"},{"title":"datacenters","path":"catalog/datacenters","filePath":"../content/commands/catalog/datacenters.mdx","fullPath":"/consul/commands/catalog/datacenters","id":"sidebar-nav-item-49"},{"title":"nodes","path":"catalog/nodes","filePath":"../content/commands/catalog/nodes.mdx","fullPath":"/consul/commands/catalog/nodes","id":"sidebar-nav-item-50"},{"title":"services","path":"catalog/services","filePath":"../content/commands/catalog/services.mdx","fullPath":"/consul/commands/catalog/services","id":"sidebar-nav-item-51"}],"id":"sidebar-nav-item-47"},{"title":"config","routes":[{"title":"Overview","path":"config","filePath":"../content/commands/config/index.mdx","fullPath":"/consul/commands/config","id":"sidebar-nav-item-53"},{"title":"delete","path":"config/delete","filePath":"../content/commands/config/delete.mdx","fullPath":"/consul/commands/config/delete","id":"sidebar-nav-item-54"},{"title":"list","path":"config/list","filePath":"../content/commands/config/list.mdx","fullPath":"/consul/commands/config/list","id":"sidebar-nav-item-55"},{"title":"read","path":"config/read","filePath":"../content/commands/config/read.mdx","fullPath":"/consul/commands/config/read","id":"sidebar-nav-item-56"},{"title":"write","path":"config/write","filePath":"../content/commands/config/write.mdx","fullPath":"/consul/commands/config/write","id":"sidebar-nav-item-57"}],"id":"sidebar-nav-item-52"},{"title":"connect","routes":[{"title":"Overview","path":"connect","filePath":"../content/commands/connect/index.mdx","fullPath":"/consul/commands/connect","id":"sidebar-nav-item-59"},{"title":"ca","path":"connect/ca","filePath":"../content/commands/connect/ca.mdx","fullPath":"/consul/commands/connect/ca","id":"sidebar-nav-item-60"},{"title":"proxy","path":"connect/proxy","filePath":"../content/commands/connect/proxy.mdx","fullPath":"/consul/commands/connect/proxy","id":"sidebar-nav-item-61"},{"title":"envoy","path":"connect/envoy","filePath":"../content/commands/connect/envoy.mdx","fullPath":"/consul/commands/connect/envoy","id":"sidebar-nav-item-62"},{"title":"expose","path":"connect/expose","filePath":"../content/commands/connect/expose.mdx","fullPath":"/consul/commands/connect/expose","id":"sidebar-nav-item-63"},{"title":"redirect-traffic","path":"connect/redirect-traffic","filePath":"../content/commands/connect/redirect-traffic.mdx","fullPath":"/consul/commands/connect/redirect-traffic","id":"sidebar-nav-item-64"}],"id":"sidebar-nav-item-58"},{"title":"debug","path":"debug","filePath":"../content/commands/debug.mdx","fullPath":"/consul/commands/debug","id":"sidebar-nav-item-65"},{"title":"event","path":"event","filePath":"../content/commands/event.mdx","fullPath":"/consul/commands/event","id":"sidebar-nav-item-66"},{"title":"exec","path":"exec","filePath":"../content/commands/exec.mdx","fullPath":"/consul/commands/exec","id":"sidebar-nav-item-67"},{"title":"force-leave","path":"force-leave","filePath":"../content/commands/force-leave.mdx","fullPath":"/consul/commands/force-leave","id":"sidebar-nav-item-68"},{"title":"info","path":"info","filePath":"../content/commands/info.mdx","fullPath":"/consul/commands/info","id":"sidebar-nav-item-69"},{"title":"intention","routes":[{"title":"Overview","path":"intention","filePath":"../content/commands/intention/index.mdx","fullPath":"/consul/commands/intention","id":"sidebar-nav-item-71"},{"title":"check","path":"intention/check","filePath":"../content/commands/intention/check.mdx","fullPath":"/consul/commands/intention/check","id":"sidebar-nav-item-72"},{"title":"create","path":"intention/create","filePath":"../content/commands/intention/create.mdx","fullPath":"/consul/commands/intention/create","id":"sidebar-nav-item-73"},{"title":"delete","path":"intention/delete","filePath":"../content/commands/intention/delete.mdx","fullPath":"/consul/commands/intention/delete","id":"sidebar-nav-item-74"},{"title":"get","path":"intention/get","filePath":"../content/commands/intention/get.mdx","fullPath":"/consul/commands/intention/get","id":"sidebar-nav-item-75"},{"title":"list","path":"intention/list","filePath":"../content/commands/intention/list.mdx","fullPath":"/consul/commands/intention/list","id":"sidebar-nav-item-76"},{"title":"match","path":"intention/match","filePath":"../content/commands/intention/match.mdx","fullPath":"/consul/commands/intention/match","id":"sidebar-nav-item-77"}],"id":"sidebar-nav-item-70"},{"title":"join","path":"join","filePath":"../content/commands/join.mdx","fullPath":"/consul/commands/join","id":"sidebar-nav-item-78"},{"title":"keygen","path":"keygen","filePath":"../content/commands/keygen.mdx","fullPath":"/consul/commands/keygen","id":"sidebar-nav-item-79"},{"title":"keyring","path":"keyring","filePath":"../content/commands/keyring.mdx","fullPath":"/consul/commands/keyring","id":"sidebar-nav-item-80"},{"title":"kv","routes":[{"title":"Overview","path":"kv","filePath":"../content/commands/kv/index.mdx","fullPath":"/consul/commands/kv","id":"sidebar-nav-item-82"},{"title":"delete","path":"kv/delete","filePath":"../content/commands/kv/delete.mdx","fullPath":"/consul/commands/kv/delete","id":"sidebar-nav-item-83"},{"title":"export","path":"kv/export","filePath":"../content/commands/kv/export.mdx","fullPath":"/consul/commands/kv/export","id":"sidebar-nav-item-84"},{"title":"get","path":"kv/get","filePath":"../content/commands/kv/get.mdx","fullPath":"/consul/commands/kv/get","id":"sidebar-nav-item-85"},{"title":"import","path":"kv/import","filePath":"../content/commands/kv/import.mdx","fullPath":"/consul/commands/kv/import","id":"sidebar-nav-item-86"},{"title":"put","path":"kv/put","filePath":"../content/commands/kv/put.mdx","fullPath":"/consul/commands/kv/put","id":"sidebar-nav-item-87"}],"id":"sidebar-nav-item-81"},{"title":"leave","path":"leave","filePath":"../content/commands/leave.mdx","fullPath":"/consul/commands/leave","id":"sidebar-nav-item-88"},{"title":"license","path":"license","filePath":"../content/commands/license.mdx","fullPath":"/consul/commands/license","id":"sidebar-nav-item-89"},{"title":"lock","path":"lock","filePath":"../content/commands/lock.mdx","fullPath":"/consul/commands/lock","id":"sidebar-nav-item-90"},{"title":"login","path":"login","filePath":"../content/commands/login.mdx","fullPath":"/consul/commands/login","id":"sidebar-nav-item-91"},{"title":"logout","path":"logout","filePath":"../content/commands/logout.mdx","fullPath":"/consul/commands/logout","id":"sidebar-nav-item-92"},{"title":"maint","path":"maint","filePath":"../content/commands/maint.mdx","fullPath":"/consul/commands/maint","id":"sidebar-nav-item-93"},{"title":"members","path":"members","filePath":"../content/commands/members.mdx","fullPath":"/consul/commands/members","id":"sidebar-nav-item-94"},{"title":"monitor","path":"monitor","filePath":"../content/commands/monitor.mdx","fullPath":"/consul/commands/monitor","id":"sidebar-nav-item-95"},{"title":"namespace","routes":[{"title":"Overview","path":"namespace","filePath":"../content/commands/namespace/index.mdx","fullPath":"/consul/commands/namespace","id":"sidebar-nav-item-97"},{"title":"create","path":"namespace/create","filePath":"../content/commands/namespace/create.mdx","fullPath":"/consul/commands/namespace/create","id":"sidebar-nav-item-98"},{"title":"delete","path":"namespace/delete","filePath":"../content/commands/namespace/delete.mdx","fullPath":"/consul/commands/namespace/delete","id":"sidebar-nav-item-99"},{"title":"list","path":"namespace/list","filePath":"../content/commands/namespace/list.mdx","fullPath":"/consul/commands/namespace/list","id":"sidebar-nav-item-100"},{"title":"read","path":"namespace/read","filePath":"../content/commands/namespace/read.mdx","fullPath":"/consul/commands/namespace/read","id":"sidebar-nav-item-101"},{"title":"update","path":"namespace/update","filePath":"../content/commands/namespace/update.mdx","fullPath":"/consul/commands/namespace/update","id":"sidebar-nav-item-102"},{"title":"write","path":"namespace/write","filePath":"../content/commands/namespace/write.mdx","fullPath":"/consul/commands/namespace/write","id":"sidebar-nav-item-103"}],"id":"sidebar-nav-item-96"},{"title":"operator","routes":[{"title":"Overview","path":"operator","filePath":"../content/commands/operator/index.mdx","fullPath":"/consul/commands/operator","id":"sidebar-nav-item-105"},{"title":"area","path":"operator/area","filePath":"../content/commands/operator/area.mdx","fullPath":"/consul/commands/operator/area","id":"sidebar-nav-item-106"},{"title":"autopilot","path":"operator/autopilot","filePath":"../content/commands/operator/autopilot.mdx","fullPath":"/consul/commands/operator/autopilot","id":"sidebar-nav-item-107"},{"title":"raft","path":"operator/raft","filePath":"../content/commands/operator/raft.mdx","fullPath":"/consul/commands/operator/raft","id":"sidebar-nav-item-108"},{"title":"usage","path":"operator/usage","filePath":"../content/commands/operator/usage.mdx","fullPath":"/consul/commands/operator/usage","id":"sidebar-nav-item-109"}],"id":"sidebar-nav-item-104"},{"title":"partition","path":"partition","filePath":"../content/commands/partition.mdx","fullPath":"/consul/commands/partition","id":"sidebar-nav-item-110"},{"title":"peering","routes":[{"title":"Overview","path":"peering","filePath":"../content/commands/peering/index.mdx","fullPath":"/consul/commands/peering","id":"sidebar-nav-item-112"},{"title":"delete","path":"peering/delete","filePath":"../content/commands/peering/delete.mdx","fullPath":"/consul/commands/peering/delete","id":"sidebar-nav-item-113"},{"title":"establish","path":"peering/establish","filePath":"../content/commands/peering/establish.mdx","fullPath":"/consul/commands/peering/establish","id":"sidebar-nav-item-114"},{"title":"exported-services","path":"peering/exported-services","filePath":"../content/commands/peering/exported-services.mdx","fullPath":"/consul/commands/peering/exported-services","id":"sidebar-nav-item-115"},{"title":"generate-token","path":"peering/generate-token","filePath":"../content/commands/peering/generate-token.mdx","fullPath":"/consul/commands/peering/generate-token","id":"sidebar-nav-item-116"},{"title":"list","path":"peering/list","filePath":"../content/commands/peering/list.mdx","fullPath":"/consul/commands/peering/list","id":"sidebar-nav-item-117"},{"title":"read","path":"peering/read","filePath":"../content/commands/peering/read.mdx","fullPath":"/consul/commands/peering/read","id":"sidebar-nav-item-118"}],"id":"sidebar-nav-item-111"},{"title":"reload","path":"reload","filePath":"../content/commands/reload.mdx","fullPath":"/consul/commands/reload","id":"sidebar-nav-item-119"},{"title":"rtt","path":"rtt","filePath":"../content/commands/rtt.mdx","fullPath":"/consul/commands/rtt","id":"sidebar-nav-item-120"},{"title":"services","routes":[{"title":"Overview","path":"services","filePath":"../content/commands/services/index.mdx","fullPath":"/consul/commands/services","id":"sidebar-nav-item-122"},{"title":"register","path":"services/register","filePath":"../content/commands/services/register.mdx","fullPath":"/consul/commands/services/register","id":"sidebar-nav-item-123"},{"title":"deregister","path":"services/deregister","filePath":"../content/commands/services/deregister.mdx","fullPath":"/consul/commands/services/deregister","id":"sidebar-nav-item-124"},{"title":"export","path":"services/export","filePath":"../content/commands/services/export.mdx","fullPath":"/consul/commands/services/export","id":"sidebar-nav-item-125"},{"title":"exported-services","path":"services/exported-services","filePath":"../content/commands/services/exported-services.mdx","fullPath":"/consul/commands/services/exported-services","id":"sidebar-nav-item-126"}],"id":"sidebar-nav-item-121"},{"title":"snapshot","routes":[{"title":"Overview","path":"snapshot","filePath":"../content/commands/snapshot/index.mdx","fullPath":"/consul/commands/snapshot","id":"sidebar-nav-item-128"},{"title":"agent","path":"snapshot/agent","filePath":"../content/commands/snapshot/agent.mdx","fullPath":"/consul/commands/snapshot/agent","id":"sidebar-nav-item-129"},{"title":"decode","path":"snapshot/decode","filePath":"../content/commands/snapshot/decode.mdx","fullPath":"/consul/commands/snapshot/decode","id":"sidebar-nav-item-130"},{"title":"inspect","path":"snapshot/inspect","filePath":"../content/commands/snapshot/inspect.mdx","fullPath":"/consul/commands/snapshot/inspect","id":"sidebar-nav-item-131"},{"title":"restore","path":"snapshot/restore","filePath":"../content/commands/snapshot/restore.mdx","fullPath":"/consul/commands/snapshot/restore","id":"sidebar-nav-item-132"},{"title":"save","path":"snapshot/save","filePath":"../content/commands/snapshot/save.mdx","fullPath":"/consul/commands/snapshot/save","id":"sidebar-nav-item-133"}],"id":"sidebar-nav-item-127"},{"title":"tls","routes":[{"title":"Overview","path":"tls","filePath":"../content/commands/tls/index.mdx","fullPath":"/consul/commands/tls","id":"sidebar-nav-item-135"},{"title":"ca","path":"tls/ca","filePath":"../content/commands/tls/ca.mdx","fullPath":"/consul/commands/tls/ca","id":"sidebar-nav-item-136"},{"title":"cert","path":"tls/cert","filePath":"../content/commands/tls/cert.mdx","fullPath":"/consul/commands/tls/cert","id":"sidebar-nav-item-137"}],"id":"sidebar-nav-item-134"},{"title":"troubleshoot","routes":[{"title":"Overview","path":"troubleshoot","filePath":"../content/commands/troubleshoot/index.mdx","fullPath":"/consul/commands/troubleshoot","id":"sidebar-nav-item-139"},{"title":"upstreams","path":"troubleshoot/upstreams","filePath":"../content/commands/troubleshoot/upstreams.mdx","fullPath":"/consul/commands/troubleshoot/upstreams","id":"sidebar-nav-item-140"},{"title":"proxy","path":"troubleshoot/proxy","filePath":"../content/commands/troubleshoot/proxy.mdx","fullPath":"/consul/commands/troubleshoot/proxy","id":"sidebar-nav-item-141"},{"title":"ports","path":"troubleshoot/ports","filePath":"../content/commands/troubleshoot/ports.mdx","fullPath":"/consul/commands/troubleshoot/ports","id":"sidebar-nav-item-142"}],"id":"sidebar-nav-item-138"},{"title":"validate","path":"validate","filePath":"../content/commands/validate.mdx","fullPath":"/consul/commands/validate","id":"sidebar-nav-item-143"},{"title":"version","path":"version","filePath":"../content/commands/version.mdx","fullPath":"/consul/commands/version","id":"sidebar-nav-item-144"},{"title":"watch","path":"watch","filePath":"../content/commands/watch.mdx","fullPath":"/consul/commands/watch","id":"sidebar-nav-item-145"}],"title":"CLI","visuallyHideTitle":true}],"mainWidth":"narrow","githubFileUrl":"https://github.com/hashicorp/consul/blob/main/website/../content/commands/snapshot/agent.mdx"},"metadata":{"title":"Commands: Snapshot Agent","description":"The `consul snapshot agent` command starts a process that takes snapshots of the state of the Consul servers in Consul Enterprise. It can capture server state once or it can run as a daemon that captures snapshots at defined intervals.\n","layout":null},"outlineItems":[{"title":"Consul Snapshot Agent","url":"#consul-snapshot-agent"},{"title":"ACL permissions","url":"#acl-permissions"},{"title":"Usage","url":"#usage"},{"title":"Examples","url":"#examples"},{"title":"Licensing","url":"#licensing"}],"pageHeading":{"id":"consul-snapshot-agent","title":"Consul Snapshot Agent"},"mdxSource":{"compiledSource":"const makeShortcode=name=\u003efunction MDXDefaultShortcode(props){console.warn(\"Component \"+name+\" was not imported, exported, or provided by MDXProvider as global scope\");return mdx(\"div\",props)};const EnterpriseAlert=makeShortcode(\"EnterpriseAlert\");const CodeTabs=makeShortcode(\"CodeTabs\");const layoutProps={};const MDXLayout=\"wrapper\";function MDXContent({components,...props}){return mdx(MDXLayout,{...layoutProps,...props,components:components,mdxType:\"MDXLayout\"},mdx(\"p\",null,`Command: `,mdx(\"inlineCode\",{parentName:\"p\"},`consul snapshot agent`)),mdx(EnterpriseAlert,{mdxType:\"EnterpriseAlert\"}),mdx(\"div\",{\"className\":\"alert alert-warning g-type-body\"},mdx(\"p\",{parentName:\"div\"},`The `,mdx(\"a\",{parentName:\"p\",\"href\":\"/consul/commands/snapshot/agent\"},mdx(\"inlineCode\",{parentName:\"a\"},`agent`)),` subcommand described here is\navailable only in `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://www.hashicorp.com/products/consul/\"},`Consul Enterprise`),`\nversion 0.7.1 and later. All other `,mdx(\"a\",{parentName:\"p\",\"href\":\"/consul/commands/snapshot\"},`snapshot subcommands`),`\nare available in the community edition of Consul.`)),mdx(\"p\",null,`The `,mdx(\"inlineCode\",{parentName:\"p\"},`snapshot agent`),` subcommand starts a process that takes snapshots of the\nstate of the Consul servers and saves them locally, or pushes them to optional\nremote storage services.`),mdx(\"p\",null,`The agent can be run as a long-running daemon process or in a one-shot mode\nfrom a batch job, based on the `,mdx(\"a\",{parentName:\"p\",\"href\":\"#interval\"},mdx(\"inlineCode\",{parentName:\"a\"},`-interval`)),` argument. Snapshotting\na remote datacenter is only available in one-shot mode.`),mdx(\"p\",null,`As a long-running daemon, the agent will perform a leader election so multiple\nprocesses can be run in a highly available fashion with automatic failover. The\nagent will also register itself with Consul as a service, along with health\nchecks that show the agent is alive (\"Consul Snapshot Agent Alive\") and able to\ntake snapshots (\"Consul Snapshot Agent Saving Snapshots\"). The latter check is\nonly added on agents who have become a leader, so it's possible for operators to\ntell which instances are alive and on standby and which instance has become\nleader and starting saving snapshots.`),mdx(\"p\",null,`As snapshots are saved, they will be reported in the log produced by the agent:`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"text\",\"className\":\"language-text\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-text\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\"},`2023/11/16 21:21:13 [INFO] Snapshot agent running`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\"},`2023/11/16 21:21:13 [INFO] Waiting to obtain leadership...`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\"},`2023/11/16 21:21:13 [INFO] Obtained leadership`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\"},`2023/11/16 21:21:13 [INFO] Saved snapshot 1479360073448728784`)),`\n`)),mdx(\"p\",null,`The number shown with the saved snapshot is its ID, which is based on a UNIX\ntimestamp with nanosecond resolution, so collisions are unlikely and IDs are\nmonotonically increasing with time. This makes it easy to locate the latest\nsnapshot, even if the log data isn't available. The snapshot ID always appears\nin the file name when using local storage, or in the object key when using\nremote storage.`),mdx(\"p\",null,`Snapshots can be restored using the\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/consul/commands/snapshot/restore\"},mdx(\"inlineCode\",{parentName:\"a\"},`consul snapshot restore`)),` command, or\nthe `,mdx(\"a\",{parentName:\"p\",\"href\":\"/consul/api-docs/snapshot\"},`HTTP API`),`.`),mdx(\"h2\",{\"id\":\"acl-permissions\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#acl-permissions\",\"aria-label\":\"acl permissions permalink\"},`\\xbb`),`ACL permissions`),mdx(\"p\",null,`If ACLs are enabled the following privileges are required:`),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",{parentName:\"tr\",\"align\":null},`Resource`),mdx(\"th\",{parentName:\"tr\",\"align\":null},`Segment`),mdx(\"th\",{parentName:\"tr\",\"align\":null},`Permission`),mdx(\"th\",{parentName:\"tr\",\"align\":null},`Explanation`))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`acl`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},`N/A`),mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`write`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},`All snapshotting operations require this privilege due to snapshots containing ACL tokens including unredacted secrets.`)),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`key`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`\u003clock key\u003e`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`write`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},`The lock key (which defaults to `,mdx(\"inlineCode\",{parentName:\"td\"},`consul-snapshot/lock`),`) is used during snapshot agent leader election.`)),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`session`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`\u003cagent name\u003e`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`write`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},`The session used for locking during leader election is created against the agent name of the Consul agent that the Snapshot agent is registering itself with.`)),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`service`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`\u003cservice name\u003e`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`write`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},`The Snapshot agent registers itself with the local Consul agent and must have write privileges on its service name which is configured with `,mdx(\"inlineCode\",{parentName:\"td\"},`-service`),`.`)))),mdx(\"h3\",{\"id\":\"example-acl-policy\"},mdx(\"a\",{parentName:\"h3\",\"className\":\"__permalink-h\",\"href\":\"#example-acl-policy\",\"aria-label\":\"example acl policy permalink\"},`\\xbb`),`Example ACL policy`),mdx(\"p\",null,`The following is a example least privilege policy which allows the snapshot agent\nto run on a node named `,mdx(\"inlineCode\",{parentName:\"p\"},`server-1234`),`.`),mdx(CodeTabs,{mdxType:\"CodeTabs\"},mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"hcl\",\"className\":\"language-hcl\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-hcl\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# Required to read and snapshot ACL data`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`acl `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"write\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# Allow the snapshot agent to create the key consul-snapshot/lock which will`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# serve as a leader election lock when multiple snapshot agents are running in`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# an environment`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`key`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"consul-snapshot/lock\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  policy `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"write\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# Allow the snapshot agent to create sessions on the specified node`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`session`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"server-1234\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  policy `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"write\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-comment)\"}},`# Allow the snapshot agent to register itself into the catalog`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-function)\"}},`service`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` \"consul-snapshot\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  policy `),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`=`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"write\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"json\",\"className\":\"language-json\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-json\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`{`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"acl\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"write\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"key\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"consul-snapshot/lock\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"policy\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"write\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"session\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"server-1234\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"policy\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"write\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"service\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"consul-snapshot\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"policy\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"write\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`))),mdx(\"p\",null,`Additional `,mdx(\"inlineCode\",{parentName:\"p\"},`session`),` rules should be created, or `,mdx(\"inlineCode\",{parentName:\"p\"},`session_prefix`),` used, if the\nsnapshot agent is deployed across more than one host.`),mdx(\"h2\",{\"id\":\"usage\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#usage\",\"aria-label\":\"usage permalink\"},`\\xbb`),`Usage`),mdx(\"p\",null,`Usage: `,mdx(\"inlineCode\",{parentName:\"p\"},`consul snapshot agent [options]`)),mdx(\"h4\",{\"id\":\"config-file-options\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#config-file-options\",\"aria-label\":\"config file options permalink\"},`\\xbb`),`Config File Options`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"config-dir\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#config-dir\",\"aria-label\":\"config dir permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-config-dir`)),` - Directory to look for JSON config files. Files will be read in\nalphabetical order and must end with the extension \".json\". This won't\nrecursively descend directories. This can be specified multiple times on the\ncommand line.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"config-file\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#config-file\",\"aria-label\":\"config file permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-config-file`)),` - File to read JSON configuration from. Files must end with the\nextension \".json\". This can be specified multiple times on the command line.`),mdx(\"p\",{parentName:\"li\"},`Config files referenced using `,mdx(\"inlineCode\",{parentName:\"p\"},`-config-dir`),` and `,mdx(\"inlineCode\",{parentName:\"p\"},`-config-file`),` have the following\nformat (shown populated with default values):`))),mdx(\"div\",{\"className\":\"alert alert-warning g-type-body\"},mdx(\"p\",{parentName:\"div\"},`Top-level single snapshot destinations in a config file are deprecated and will be removed in a future version. Move top-level `,mdx(\"inlineCode\",{parentName:\"p\"},`local_storage`),`, `,mdx(\"inlineCode\",{parentName:\"p\"},`aws_storage`),`, `,mdx(\"inlineCode\",{parentName:\"p\"},`azure_blob_storage`),`, and `,mdx(\"inlineCode\",{parentName:\"p\"},`google_storage`),` config objects to `,mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_agent -\u003e backup_destinations`),` instead.`)),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"json\",\"className\":\"language-json\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-json\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`{`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"snapshot_agent\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"http_addr\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"127.0.0.1:8500\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"token\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"datacenter\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"ca_file\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"ca_path\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"cert_file\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"key_file\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"license_path\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"tls_server_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"login\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"auth_method\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"bearer_token\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"bearer_token_file\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"meta\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {}`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"log\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"level\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"INFO\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"enable_syslog\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` false`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"syslog_facility\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"LOCAL0\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"snapshot\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"interval\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"1h\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"retain\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 30`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"stale\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` false`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"service\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"consul-snapshot\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"deregister_after\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"72h\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"lock_key\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"consul-snapshot/lock\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"max_failures\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-constant)\"}},` 3`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"local_scratch_path\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`    \"backup_destinations\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"local_storage\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"path\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \".\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      ]`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"aws_storage\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"access_key_id\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"secret_access_key\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"session_token\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"iam_endpoint\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"role_arn\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"role_session_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"web_identity_token_file\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"sts_endpoint\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"s3_region\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"s3_endpoint\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"s3_bucket\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"s3_key_prefix\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"consul-snapshot\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      ]`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"azure_blob_storage\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"account_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"account_key\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"container_name\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      ]`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"google_storage\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`          \"bucket\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`        }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`      ]`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"p\",null,`All fields are optional, and config files without a `,mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_agent`),` object will\nbe ignored. At least one config file needs to have a `,mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_agent`),` object, or the\nsnapshot agent will fail to start. The Consul agent is set up to ignore any\n`,mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_agent`),` object, so it's safe to use common config directories for both agents\nif desired.`),mdx(\"h4\",{\"id\":\"snapshot-options\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#snapshot-options\",\"aria-label\":\"snapshot options permalink\"},`\\xbb`),`Snapshot Options`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"interval\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#interval\",\"aria-label\":\"interval permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-interval`)),` - Interval at which to perform snapshots as\na time with a unit suffix, which can be \"s\", \"m\", \"h\" for seconds, minutes, or\nhours. If 0 is provided, the agent will take a single snapshot and then exit, which\nis useful for running snapshots via batch jobs. Defaults to \"1h\"`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"lock-key\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#lock-key\",\"aria-label\":\"lock key permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-lock-key`)),` - A prefix in Consul's KV store used to coordinate between\ndifferent instances of the snapshot agent in order to only have one active instance\nat a time. For highly available operation of the snapshot agent, simply run\nmultiple instances. All instances must be configured with the same lock key in\norder to properly coordinate. Defaults to \"consul-snapshot/lock\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"max-failures\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#max-failures\",\"aria-label\":\"max failures permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-max-failures`)),` - Number of snapshot failures after which the snapshot agent\nwill give up leadership. In a highly available operation with multiple snapshot\nagents available, this gives another agent a chance to take over if an agent\nis experiencing issues, such as running out of disk space for snapshots.\nDefaults to 3.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"retain\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#retain\",\"aria-label\":\"retain permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-retain`)),` - Number of snapshots to retain. After each snapshot is taken, the\noldest snapshots will start to be deleted in order to retain at most this many\nsnapshots. If this is set to 0, the agent will not perform this and snapshots\nwill accumulate forever. Defaults to 30.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"local-scratch-path\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#local-scratch-path\",\"aria-label\":\"local scratch path permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-local-scratch-path`)),` - Location to store all temporary snapshots in prior to\nsending them off to the configured storage backend. If not configured the\nsystem temporary directory will be used.`))),mdx(\"h4\",{\"id\":\"agent-options\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#agent-options\",\"aria-label\":\"agent options permalink\"},`\\xbb`),`Agent Options`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"deregister-after\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#deregister-after\",\"aria-label\":\"deregister after permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-deregister-after`)),` - An interval, after which if the agent is unhealthy it will be\nautomatically deregistered from Consul service discovery. This is a time with a\nunit suffix, which can be \"s\", \"m\", \"h\" for seconds, minutes, or hours. If 0 is\nprovided, this will be disabled. Defaults to \"72h\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"log-level\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#log-level\",\"aria-label\":\"log level permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-log-level`)),` - Controls verbosity of snapshot agent logs. Valid options are\n\"trace\", \"debug\", \"info\", \"warn\", \"error\". Defaults to \"info\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"service\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#service\",\"aria-label\":\"service permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-service`)),` - The service name to use when registering the agent with Consul.\nRegistering helps monitor running agents and the leader registers an additional\nhealth check to monitor that snapshots are taking place. Defaults to\n\"consul-snapshot\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"syslog\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#syslog\",\"aria-label\":\"syslog permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-syslog`)),` - This enables forwarding logs to syslog. Defaults to false.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"syslog-facility\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#syslog-facility\",\"aria-label\":\"syslog facility permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-syslog-facility`)),` - Sets the facility to use for forwarding logs to syslog.\nDefaults to \"LOCAL0\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"login-auth-method\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#login-auth-method\",\"aria-label\":\"login auth method permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`login-auth-method`)),` - Auth method name to use to log into Consul. If provided, the token obtained with this auth method\nwill be used instead of a static token if it is provided. Currently, only `,mdx(\"inlineCode\",{parentName:\"p\"},`kubernetes`),` auth method type is supported.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"login-bearer-token\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#login-bearer-token\",\"aria-label\":\"login bearer token permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`login-bearer-token`)),` - Bearer token to use to log into Consul. Used only if `,mdx(\"inlineCode\",{parentName:\"p\"},`-login-auth-method`),` is set.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"login-bearer-token-file\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#login-bearer-token-file\",\"aria-label\":\"login bearer token file permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`login-bearer-token-file`)),` - A file container bearer token to use for logging into Consul.\n`,mdx(\"inlineCode\",{parentName:\"p\"},`-login-bearer-token`),` is ignored if this flag is provided.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"login-meta\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#login-meta\",\"aria-label\":\"login meta permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`login-meta`)),` - Metadata to set on the token, formatted as key=value. This flag may be provided multiple times.`))),mdx(\"h4\",{\"id\":\"local-storage-options\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#local-storage-options\",\"aria-label\":\"local storage options permalink\"},`\\xbb`),`Local Storage Options`),mdx(\"div\",{\"className\":\"alert alert-warning g-type-body\"},mdx(\"p\",{parentName:\"div\"},`This option is deprecated when used with a top-level `,mdx(\"inlineCode\",{parentName:\"p\"},`local_storage`),` object in a config file. Use `,mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_agent -\u003e backup_destinations -\u003e local_storage[0]`),` in a config file instead.`)),mdx(\"p\",null,`This option cannot be used when using `,mdx(\"inlineCode\",{parentName:\"p\"},`backup_destinations`),` in a config file.`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"local-path\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"a\",{parentName:\"li\",\"href\":\"#local-path\",\"aria-label\":\"local path permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-local-path`)),` - Location to store snapshots locally. The default behavior\nof the snapshot agent is to store snapshots locally in this directory. Defaults\nto \".\" to use the current working directory. If an alternate remote storage\noption is configured, then local storage will be disabled and this option will\nbe ignored.`)),mdx(\"h4\",{\"id\":\"s3-storage-options\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#s3-storage-options\",\"aria-label\":\"s3 storage options permalink\"},`\\xbb`),`S3 Storage Options`),mdx(\"div\",{\"className\":\"alert alert-warning g-type-body\"},mdx(\"p\",{parentName:\"div\"},`These options are deprecated when used with a top-level `,mdx(\"inlineCode\",{parentName:\"p\"},`aws_storage`),` object in a config file. Use `,mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_agent -\u003e backup_destinations -\u003e aws_storage[0]`),` in a config file instead.`)),mdx(\"p\",null,`These options cannot be used when using `,mdx(\"inlineCode\",{parentName:\"p\"},`backup_destinations`),` in a config file.\nNote that despite the AWS references, any S3-compatible endpoint can be specified with `,mdx(\"inlineCode\",{parentName:\"p\"},`-aws-s3-endpoint`),`.`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-access-key-id\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-access-key-id\",\"aria-label\":\"aws access key id permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-access-key-id`)),`, `,mdx(\"inlineCode\",{parentName:\"p\"},`-aws-secret-access-key`),` and `,mdx(\"inlineCode\",{parentName:\"p\"},`-aws-session-token`),` - These arguments supply static\nauthentication information for connecting to S3. These may also be supplied using\nthe following alternative methods:`,mdx(\"br\",null)),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws_access_key_id\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"a\",{parentName:\"li\",\"href\":\"#aws_access_key_id\",\"aria-label\":\"aws_access_key_id permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`AWS_ACCESS_KEY_ID`)),`, `,mdx(\"inlineCode\",{parentName:\"li\"},`AWS_SECRET_ACCESS_KEY`),` and `,mdx(\"inlineCode\",{parentName:\"li\"},`AWS_SESSION_TOKEN`),` environment variables`),mdx(\"li\",{parentName:\"ul\"},`A credentials file (`,mdx(\"inlineCode\",{parentName:\"li\"},`~/.aws/credentials`),` or the file at the path specified by the\n`,mdx(\"inlineCode\",{parentName:\"li\"},`AWS_SHARED_CREDENTIALS_FILE`),` environment variable)`),mdx(\"li\",{parentName:\"ul\"},`ECS task role metadata (container-specific)`),mdx(\"li\",{parentName:\"ul\"},`EC2 instance role metadata`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-iam-endpoint\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-iam-endpoint\",\"aria-label\":\"aws iam endpoint permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-iam-endpoint`)),` - IAM endpoint to use when authenticating with static credentials.\nDefault is to use the global IAM endpoint.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-role-arn\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-role-arn\",\"aria-label\":\"aws role arn permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-role-arn`)),`, `,mdx(\"inlineCode\",{parentName:\"p\"},`-aws-role-session-name`),`, and `,mdx(\"inlineCode\",{parentName:\"p\"},`-aws-web-identity-token-file`),` - These arguments are\nused to obtain temporary credentials by assuming an IAM role. These may also be supplied using\nthe following alternative methods:`,mdx(\"br\",null)),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws_role_arn\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"a\",{parentName:\"li\",\"href\":\"#aws_role_arn\",\"aria-label\":\"aws_role_arn permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`AWS_ROLE_ARN`)),`, `,mdx(\"inlineCode\",{parentName:\"li\"},`AWS_ROLE_SESSION_NAME`),`, and `,mdx(\"inlineCode\",{parentName:\"li\"},`AWS_WEB_IDENTITY_TOKEN_FILE`),` environment variables.`),mdx(\"li\",{parentName:\"ul\"},`A credentials file (~/.aws/credentials or the file at the path specified by the\n`,mdx(\"inlineCode\",{parentName:\"li\"},`AWS_SHARED_CREDENTIALS_FILE`),` environment variable)`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-sts-endpoint\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-sts-endpoint\",\"aria-label\":\"aws sts endpoint permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-sts-endpoint`)),` - STS endpoint to use for obtaining temporary credentials.\nDefault is to use the global STS endpoint.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-s3-bucket\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-s3-bucket\",\"aria-label\":\"aws s3 bucket permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-s3-bucket`)),` - S3 bucket to use. Required for S3 storage, and setting this\ndisables local storage. This should be only the bucket name without any\npart of the key prefix.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-s3-key-prefix\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-s3-key-prefix\",\"aria-label\":\"aws s3 key prefix permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-s3-key-prefix`)),` - Prefix to use for snapshot files in S3. Defaults to\n\"consul-snapshot\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-s3-region\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-s3-region\",\"aria-label\":\"aws s3 region permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-s3-region`)),` - S3 region to use. Required for S3 storage.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-s3-endpoint\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-s3-endpoint\",\"aria-label\":\"aws s3 endpoint permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-s3-endpoint`)),` - S3 endpoint to use. Can also be specified using the\n`,mdx(\"inlineCode\",{parentName:\"p\"},`AWS_S3_ENDPOINT`),` environment variable. Defaults to the regional S3 endpoint.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-s3-server-side-encryption\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-s3-server-side-encryption\",\"aria-label\":\"aws s3 server side encryption permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-s3-server-side-encryption`)),` - Enables saving snapshots to S3 using server side encryption with `,mdx(\"a\",{parentName:\"p\",\"href\":\"http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingServerSideEncryption.html\"},`Amazon S3-Managed Encryption Keys`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-s3-static-snapshot-name\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-s3-static-snapshot-name\",\"aria-label\":\"aws s3 static snapshot name permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-s3-static-snapshot-name`)),` - If this is given, all snapshots are saved with the same file name. The agent will not rotate or version snapshots, and will save them with the same name each time.\nUse this if you want to rely on `,mdx(\"a\",{parentName:\"p\",\"href\":\"http://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html\"},`S3's versioning capabilities`),` instead of the agent handling it for you.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-s3-force-path-style\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-s3-force-path-style\",\"aria-label\":\"aws s3 force path style permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-s3-force-path-style`)),` - Enables the use of legacy path-based addressing instead of virtual addressing. This flag is required by minio\nand other 3rd party S3 compatible object storage platforms where DNS or TLS requirements for virtual addressing are prohibitive.\nFor more information, refer to the AWS documentation on `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-bucket-intro.html\"},`Methods for accessing a bucket`))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-s3-enable-kms\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-s3-enable-kms\",\"aria-label\":\"aws s3 enable kms permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-s3-enable-kms`)),` - Enables using `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://aws.amazon.com/kms/\"},`Amazon KMS`),` for encrypting snapshots.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"aws-s3-kms-key\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#aws-s3-kms-key\",\"aria-label\":\"aws s3 kms key permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-aws-s3-kms-key`)),` - Optional Amazon KMS key to use, if this is not set the default KMS master key will be used. Set this if you want to manage key rotation yourself.`),mdx(\"div\",{parentName:\"li\",\"className\":\"alert alert-info g-type-body\"},mdx(\"p\",{parentName:\"div\"},`When using a S3-compatible storage exposing a self-signed certificate the agent will not be able to perform\nthe snapshot operations unless the CA used to sign the storage certificate is trusted by the node running\nthe agent. You can add the CA root certificate to the OS trust store to have Consul trust the storage endpoint.`)))),mdx(\"h4\",{\"id\":\"s3-required-permissions\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#s3-required-permissions\",\"aria-label\":\"s3 required permissions permalink\"},`\\xbb`),`S3 Required Permissions`),mdx(\"p\",null,`Different S3 permissions are required depending on the configuration of the snapshot agent. In particular extra permissions are required when\nsnapshot rotation is enabled. S3 storage snapshot rotation is enabled when the `,mdx(\"inlineCode\",{parentName:\"p\"},`retain`),` configuration is greater than 0 and when there is\nno `,mdx(\"inlineCode\",{parentName:\"p\"},`aws-s3-static-snapshot-name`),` configured.`),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",{parentName:\"tr\",\"align\":null},`Permission`),mdx(\"th\",{parentName:\"tr\",\"align\":null},`Resource`),mdx(\"th\",{parentName:\"tr\",\"align\":null},`When you need it`))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`PutObject`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`arn:aws:s3:::\u003cbucket name\u003e/\u003ckey\u003e`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},`Required for all operations.`)),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`DeleteObject`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`arn:aws:s3:::\u003cbucket name\u003e/\u003ckey\u003e`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},`Required only when snapshot rotation is enabled`)),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`ListBucket`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`arn:aws:s3:::\u003cbucket name\u003e`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},`Required only when snapshot rotation is enabled`)),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`ListBucketVersions`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},mdx(\"inlineCode\",{parentName:\"td\"},`arn:aws:s3:::\u003cbucket name\u003e`)),mdx(\"td\",{parentName:\"tr\",\"align\":null},`Required only when snapshot rotation is enabled`)))),mdx(\"p\",null,`Within the table `,mdx(\"inlineCode\",{parentName:\"p\"},`\u003ckey\u003e`),` refers to the key used to store the snapshot. When `,mdx(\"inlineCode\",{parentName:\"p\"},`aws-s3-static-snapshot-name`),` is configured the `,mdx(\"inlineCode\",{parentName:\"p\"},`\u003ckey\u003e`),` is simply the value of that configuration. Otherwise the `,mdx(\"inlineCode\",{parentName:\"p\"},`\u003ckey\u003e`),` will be the `,mdx(\"inlineCode\",{parentName:\"p\"},`\u003caws-s3-key-prefix configuration\u003e/consul-*.snap`),`.`),mdx(\"p\",null,`The following example IAM policy document assumes that the `,mdx(\"inlineCode\",{parentName:\"p\"},`aws-s3-bucket`),` is `,mdx(\"inlineCode\",{parentName:\"p\"},`consul-data`),` with defaults for `,mdx(\"inlineCode\",{parentName:\"p\"},`aws-s3-key-prefix`),`, `,mdx(\"inlineCode\",{parentName:\"p\"},`aws-s3-static-snapshot-name`),` and `,mdx(\"inlineCode\",{parentName:\"p\"},`retain`),`:`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"json\",\"className\":\"language-json\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-json\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`{`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"Version\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"2012-10-17\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"Statement\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"Sid\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"Effect\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Allow\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"Action\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"s3:PutObject\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"s3:DeleteObject\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"Resource\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"arn:aws:s3:::consul-data/consul-snapshots/consul-*.snap\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    {`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"Sid\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"Effect\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"Allow\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"Action\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` [`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},`\"s3:ListBucketVersions\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"s3:ListBucket\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`]`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`,`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`      \"Resource\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"arn:aws:s3:::consul-data\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`    }`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`  ]`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"h4\",{\"id\":\"azure-blob-storage-options\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#azure-blob-storage-options\",\"aria-label\":\"azure blob storage options permalink\"},`\\xbb`),`Azure Blob Storage options`),mdx(\"div\",{\"className\":\"alert alert-warning g-type-body\"},mdx(\"p\",{parentName:\"div\"},`These options are deprecated when used with a top-level `,mdx(\"inlineCode\",{parentName:\"p\"},`azure_blob_storage`),` object in a config file. Use `,mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_agent -\u003e backup_destinations -\u003e azure_blob_storage[0]`),` in a config file instead.`)),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},` Note: This currently only works on non-Solaris platforms due to library limitations `)),mdx(\"p\",null,`From Consul Enterprise version `,mdx(\"inlineCode\",{parentName:\"p\"},`1.5.0`),` onwards, you can store snapshots in Azure Blob storage.`),mdx(\"p\",null,`These options cannot be used when using `,mdx(\"inlineCode\",{parentName:\"p\"},`backup_destinations`),` in a config file.`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"azure-blob-account-name\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#azure-blob-account-name\",\"aria-label\":\"azure blob account name permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-azure-blob-account-name`)),` and `,mdx(\"inlineCode\",{parentName:\"p\"},`-azure-blob-account-key`),` - These arguments supply\nauthentication information for connecting to Azure Blob storage.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"azure-blob-container-name\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#azure-blob-container-name\",\"aria-label\":\"azure blob container name permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-azure-blob-container-name`)),` - Container to use. Required for Azure blob storage, and setting this\ndisables local storage.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"azure-blob-environment\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#azure-blob-environment\",\"aria-label\":\"azure blob environment permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-azure-blob-environment`)),` - Environment to use. Defaults to AZUREPUBLICCLOUD. Other valid environments\nare AZURECHINACLOUD, AZUREGERMANCLOUD and AZUREUSGOVERNMENTCLOUD. Introduced in Consul 1.7.3.`))),mdx(\"div\",{\"className\":\"alert alert-warning g-type-body\"},mdx(\"p\",{parentName:\"div\"},`The following options were introduced in v1.20.1+ent.`)),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"azure-blob-service-principal-id\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#azure-blob-service-principal-id\",\"aria-label\":\"azure blob service principal id permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-azure-blob-service-principal-id`)),` - The ID of the service principal that owns the blob object.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"azure-blob-service-principal-secret\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#azure-blob-service-principal-secret\",\"aria-label\":\"azure blob service principal secret permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-azure-blob-service-principal-secret`)),` - The secret of the service principal that owns the blob object.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"azure-blob-tenant-id\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#azure-blob-tenant-id\",\"aria-label\":\"azure blob tenant id permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-azure-blob-tenant-id`)),` - The ID of the tenant that owns the Azure blob.`))),mdx(\"h4\",{\"id\":\"google-cloud-storage-options\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#google-cloud-storage-options\",\"aria-label\":\"google cloud storage options permalink\"},`\\xbb`),`Google Cloud Storage options`),mdx(\"div\",{\"className\":\"alert alert-warning g-type-body\"},mdx(\"p\",{parentName:\"div\"},`This option is deprecated when used with a top-level `,mdx(\"inlineCode\",{parentName:\"p\"},`google_storage`),` object in a config file. Use `,mdx(\"inlineCode\",{parentName:\"p\"},`snapshot_agent -\u003e backup_destinations -\u003e google_storage[0]`),` in a config file instead.`)),mdx(\"p\",null,`From Consul Enterprise version `,mdx(\"inlineCode\",{parentName:\"p\"},`1.6.1`),` onwards, you can store snapshots in Google Cloud Storage. Authentication relies on automatic discovery through the sdk as described `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://cloud.google.com/docs/authentication/production\"},`here`),`:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},`First, ADC checks to see if the environment variable GOOGLE_APPLICATION_CREDENTIALS is set. If the variable is set, ADC uses the service account file that the variable points to. The next section describes how to set the environment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},`If the environment variable isn't set, ADC uses the default service account that Compute Engine, Kubernetes Engine, App Engine, and Cloud Functions provide, for applications that run on those services.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},`If ADC can't use either of the above credentials, an error occurs.`))),mdx(\"p\",null,`This option cannot be used when using `,mdx(\"inlineCode\",{parentName:\"p\"},`backup_destinations`),` in a config file.`),mdx(\"p\",null,`This integration needs the following information:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"gcs-bucket\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"a\",{parentName:\"li\",\"href\":\"#gcs-bucket\",\"aria-label\":\"gcs bucket permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-gcs-bucket`)),` supplies the bucket to use.`)),mdx(\"h4\",{\"id\":\"api-options\"},mdx(\"a\",{parentName:\"h4\",\"className\":\"__permalink-h\",\"href\":\"#api-options\",\"aria-label\":\"api options permalink\"},`\\xbb`),`API Options`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"ca-file\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#ca-file\",\"aria-label\":\"ca file permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-ca-file=\u003cvalue\u003e`)),` - Path to a CA file to use for TLS when communicating with Consul.\nThis can also be specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_CACERT`),` environment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"ca-path\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#ca-path\",\"aria-label\":\"ca path permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-ca-path=\u003cvalue\u003e`)),` - Path to a directory of CA certificates to use for TLS when\ncommunicating with Consul. This can also be specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_CAPATH`),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"client-cert\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#client-cert\",\"aria-label\":\"client cert permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-client-cert=\u003cvalue\u003e`)),` - Path to a client cert file to use for TLS when\n`,mdx(\"inlineCode\",{parentName:\"p\"},`verify_incoming`),` is enabled. This can also be specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_CLIENT_CERT`),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"client-key\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#client-key\",\"aria-label\":\"client key permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-client-key=\u003cvalue\u003e`)),` - Path to a client key file to use for TLS when\n`,mdx(\"inlineCode\",{parentName:\"p\"},`verify_incoming`),` is enabled. This can also be specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_CLIENT_KEY`),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"http-addr\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#http-addr\",\"aria-label\":\"http addr permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-http-addr=\u003caddr\u003e`)),` - Address of the Consul agent with the port. This can be\nan IP address or DNS address, but it must include the port. This can also be\nspecified via the `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_HTTP_ADDR`),` environment variable. In Consul 0.8 and\nlater, the default value is `,mdx(\"a\",{parentName:\"p\",\"href\":\"http://127.0.0.1:8500\"},`http://127.0.0.1:8500`),`, and https can optionally be\nused instead. The scheme can also be set to HTTPS by setting the environment\nvariable `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_HTTP_SSL=true`),`. This may be a unix domain socket using\n`,mdx(\"inlineCode\",{parentName:\"p\"},`unix:///path/to/socket`),` if the `,mdx(\"a\",{parentName:\"p\",\"href\":\"/consul/docs/reference/agent/configuration-file/general#addresses\"},`agent is configured to\nlisten`),` that way.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"tls-server-name\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#tls-server-name\",\"aria-label\":\"tls server name permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-tls-server-name=\u003cvalue\u003e`)),` - The server name to use as the SNI host when\nconnecting via TLS. This can also be specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_TLS_SERVER_NAME`),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"token\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#token\",\"aria-label\":\"token permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-token=\u003cvalue\u003e`)),` - ACL token to use in the request. This can also be specified\nvia the `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_HTTP_TOKEN`),` environment variable. If unspecified, the query\nwill default to the token of the Consul agent at the HTTP address.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"token-file\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",{parentName:\"p\",\"href\":\"#token-file\",\"aria-label\":\"token file permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`-token-file=\u003cvalue\u003e`)),` - File containing the ACL token to use in the request\ninstead of one specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},`-token`),` argument or `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_HTTP_TOKEN`),`\nenvironment variable. This can also be specified via the\n`,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_HTTP_TOKEN_FILE`),` environment variable.`))),mdx(\"h2\",{\"id\":\"examples\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#examples\",\"aria-label\":\"examples permalink\"},`\\xbb`),`Examples`),mdx(\"p\",null,`Running the agent with no arguments will run a long-running daemon process that will\nperform leader election for highly available operation, register itself with Consul\nservice discovery with health checks, take snapshots every hour, retain the last 30\nsnapshots, and save snapshots into the current working directory:`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` consul snapshot agent`)),`\n`)),mdx(\"p\",null,`To run a one-shot backup, set the backup interval to 0. This will run a single snapshot\nand delete any old snapshots based on the retain settings, but it will not perform any\nleader election or service registration:`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"shellsession\",\"className\":\"language-shellsession\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-shellsession\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-cyan)\"}},`$`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},` consul snapshot agent -interval=0`)),`\n`)),mdx(\"p\",null,`Please see the `,mdx(\"a\",{parentName:\"p\",\"href\":\"/consul/api-docs/snapshot\"},`HTTP API`),` documentation for\nmore details about snapshot internals.`),mdx(\"h2\",{\"id\":\"licensing\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#licensing\",\"aria-label\":\"licensing permalink\"},`\\xbb`),`Licensing`),mdx(\"p\",null,`The snapshot agent requires a license when it starts before it will perform any other\nactions. This can be provided using the `,mdx(\"inlineCode\",{parentName:\"p\"},`license_path`),` configuration item, the\n`,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_LICENSE_PATH`),` environment variable or the `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_LICENSE`),` environment variable.\nThe `,mdx(\"inlineCode\",{parentName:\"p\"},`license_path`),` configuration and `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_LICENSE_PATH`),` variable should point to\nfiles that contain the license whereas the `,mdx(\"inlineCode\",{parentName:\"p\"},`CONSUL_LICENSE`),` variable value should be\nthe contents of the license itself. If a license is present in multiple ways the\nthen the order of precedence is as follows:`),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",{parentName:\"li\",\"id\":\"consul_license\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"a\",{parentName:\"li\",\"href\":\"#consul_license\",\"aria-label\":\"consul_license permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`CONSUL_LICENSE`)),` variable`),mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",{parentName:\"li\",\"id\":\"consul_license_path\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"a\",{parentName:\"li\",\"href\":\"#consul_license_path\",\"aria-label\":\"consul_license_path permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`CONSUL_LICENSE_PATH`)),` variable`),mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",{parentName:\"li\",\"id\":\"license_path\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"a\",{parentName:\"li\",\"href\":\"#license_path\",\"aria-label\":\"license_path permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`license_path`)),` configuration.`)),mdx(\"p\",null,`The ability to load licenses from the configuration or environment was added in v1.10.0,\nv1.9.7 and v1.8.13. See the `,mdx(\"a\",{parentName:\"p\",\"href\":\"/consul/docs/enterprise/license\"},`licensing documentation`),` for\nmore information about Consul Enterprise license management.`))};MDXContent.isMDXComponent=true;","scope":{"product":"consul","version":"latest"}},"product":{"name":"Consul","slug":"consul","algoliaConfig":{"indexName":"product_CONSUL","searchOnlyApiKey":"fbd5dc1f0078d41509fcc560386fd534"},"analyticsConfig":{"includedDomains":"consul.io www.consul.io","segmentWriteKey":"IyzLrqXkox5KJ8XL4fo8vTYNGfiKlTCm"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Consul by HashiCorp","description":"Consul is a service networking solution to automate network configurations, discover services, and enable secure connectivity across any cloud or runtime.","image":"https://www.consulproject.io/consul-public/img/og-image.png","icon":[{"href":"/consul-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiDays","url":"https://hashicorp.com/conferences/hashidays","text":"One conference. Three cities.","linkText":"Find a city near you","expirationDate":"2024-06-14T00:00:00-08:00"},"version":"1.11.3","subnavItems":[],"basePaths":["docs","api-docs","commands","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"api","name":"API","path":"api-docs"},{"iconName":"terminal-screen","name":"CLI","path":"commands"}],"currentRootDocsPath":{"iconName":"terminal-screen","name":"CLI","path":"commands"}},"projectName":null,"versions":null},"__N_SSG":true},"page":"/consul/commands/[[...page]]","query":{"page":["snapshot","agent"]},"buildId":"rf4tsLo62lRElKow25oK4","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script nomodule="">window.MSInputMethodContext && document.documentMode && document.write('<script src="/ie-warning.js"><\x2fscript>');</script></body></html>