<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Commands: Snapshot Agent | Consul | HashiCorp Developer</title><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta property="article:publisher" content="https://www.facebook.com/HashiCorp/"/><meta name="twitter:site" content="@HashiCorp"/><meta name="twitter:card" content="summary_large_image"/><meta name="theme-color" content="#000"/><meta name="description" property="og:description" content="The `consul snapshot agent` command starts a process that takes snapshots of the state of the Consul servers in Consul Enterprise. It can capture server state once or it can run as daemon that captures snapshots at defined intervals.
"/><meta name="twitter:description" content="The `consul snapshot agent` command starts a process that takes snapshots of the state of the Consul servers in Consul Enterprise. It can capture server state once or it can run as daemon that captures snapshots at defined intervals.
"/><meta property="og:site_name" content="Commands: Snapshot Agent | Consul | HashiCorp Developer"/><meta property="og:title" content="Commands: Snapshot Agent | Consul | HashiCorp Developer"/><meta property="og:image" content="https://developer.hashicorp.com/og-image/consul.jpg"/><link rel="canonical" href="https://developer.hashicorp.com/consul/commands/snapshot/agent"/><link rel="icon" href="/favicon-dev.ico" sizes="any"/><link rel="icon" href="/icon.svg" type="image/svg+xml"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="google-site-verification" content="zRQZqfAsOX-ypXfU0mzAIzb5rUvj5fA4Zw2jWJRN-JI"/><meta name="zd-site-verification" content="xnvnvv1i0wl4tf0pzaymb" data-product="hcp"/><meta name="zd-site-verification" content="36fp2i1pj67d8cjtzf4fi9" data-product="terraform"/><meta name="zd-site-verification" content="nbe87kfyp1sck7b13vj1i" data-product="packer"/><meta name="zd-site-verification" content="wvsmmqa1cfb9am9zlwfj" data-product="consul"/><meta name="zd-site-verification" content="cw22oopfwr68ujj0n5pn9i" data-product="boundary"/><meta name="zd-site-verification" content="lkslvganwfgfqfwpdeicgh" data-product="vault"/><meta name="zd-site-verification" content="jl2wp2hoej9rz6c8rmqdns" data-product="nomad"/><meta name="zd-site-verification" content="2eb0cu6xceo73t0038m0tb" data-product="waypoint"/><meta name="zd-site-verification" content="n52xisxdf3higs2q9kuogd" data-product="vagrant"/><meta name="twitter:image" content="https://developer.hashicorp.com/og-image/consul.jpg"/><link rel="prefetch" href="https://www.datadoghq-browser-agent.com/datadog-rum-v4.js"/><script type="application/ld+json">[{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Developer","item":"https://developer.hashicorp.com/"},{"@type":"ListItem","position":2,"name":"Consul","item":"https://developer.hashicorp.com/consul"},{"@type":"ListItem","position":3,"name":"CLI","item":"https://developer.hashicorp.com/consul/commands"},{"@type":"ListItem","position":4,"name":"snapshot","item":"https://developer.hashicorp.com/consul/commands/snapshot"},{"@type":"ListItem","position":5,"name":"agent","item":"https://developer.hashicorp.com/consul/commands/snapshot/agent"}]}]</script><meta name="next-head-count" content="31"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/hashicorp-consul/_next/static/css/f57944cb63137117.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-consul/_next/static/css/f57944cb63137117.css" crossorigin="" data-n-g=""/><link rel="preload" href="/hashicorp-consul/_next/static/css/63deaa568623a226.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-consul/_next/static/css/63deaa568623a226.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-consul/_next/static/css/1b517fff33776c13.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-consul/_next/static/css/1b517fff33776c13.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-consul/_next/static/css/5734d1b25a4d4e7f.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-consul/_next/static/css/5734d1b25a4d4e7f.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-consul/_next/static/css/d84fe9967a765e18.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-consul/_next/static/css/d84fe9967a765e18.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-consul/_next/static/css/9670b996c3d0a580.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-consul/_next/static/css/9670b996c3d0a580.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/hashicorp-consul/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/hashicorp-consul/_next/static/chunks/webpack-9735c99f1216bd56.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/framework-314c182fa7e2bf37.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/main-9edb42470eb075b6.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/pages/_app-0e79c615b1a6e5b6.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/9152-0b3899f5f9faf0d9.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/9547-de090b52af7ba1ea.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/1525-1f498930a8249e9e.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/9873-7af04f92ff32c08d.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/5665-db60618a811e4f85.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/622-d91797f81d158d5d.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/6517-a1db590897df8f62.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/1151-69977adf39d7e281.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/5044-1418005e37ce10ae.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/5765-a7b4415bf53b3f18.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/1844-8e3479d9a27b3683.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/5921-55ab9cfde06a6d59.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/chunks/pages/consul/commands/%5B%5B...page%5D%5D-81f0c6c8c95caecc.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/Bgb-wtlhVht2bM8BF79Za/_buildManifest.js" defer="" crossorigin=""></script><script src="/hashicorp-consul/_next/static/Bgb-wtlhVht2bM8BF79Za/_ssgManifest.js" defer="" crossorigin=""></script></head><body><script>!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t,e){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://artemis.hashicorp.com/script/"+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=e};analytics._cdn="https://artemis.hashicorp.com";analytics.SNIPPET_VERSION="4.1.0";}}();</script><div id="__next"><div class="style_root__dZhZu"><a href="https://hashi.co/dev-ai-signup" class="style_linkElem__hCESK"><span class="style_textContainer__6CuI7 g-grid-container"><span class="style_tag__jbHGz g-type-body-small-x-strong">HashiCorp Developer AI<!-- --> </span><span class="style_text__rwS0u g-type-body-small">Private beta now available<span class="style_linkText__E8GJf g-type-body-small-x-strong"> <!-- -->Sign up today</span></span></span></a><button class="style_closeButton__57J9w"><div><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 5L5 15M5 5l10 10" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div><span style="position:absolute;border:0;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;word-wrap:normal">Dismiss alert</span></button></div><script type="text/javascript">
(function checkDismissAlertBanner() {
  try {
    if (document.cookie.includes('banner_private-beta-now-available=1')) {
      const element = document.querySelector('.style_root__dZhZu')
      element.classList.remove('style_isShown__D4mb6')
    }
  } catch (_) {
    // do nothing
  }
})()
</script><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="core-dev-dot-layout_root__MT1PZ"><div class="base-layout_root___qiZs" data-layout="base-new"><div class="base-layout_header__XhkxS"><header class="navigation-header_root__oE_HT"><div class="navigation-header_leftSide__V0xlc"><div class="product-page-content_productsDropdown__haUyw"><div class="dropdown-menu_root__Hwy5S"><div class="dropdown-menu_activatorWrapper__LxPRt"><button aria-controls="navigation-header-menu-react-aria-1" aria-expanded="false" aria-label="Main menu" class="dropdown-menu_activator__xXb00 g-focus-ring-from-box-shadow-dark product-page-content_productsDropdownButton__bnKKs" data-heap-track="navigation-header-dropdown-menu-activator"><span class="dropdown-menu_activatorLeadingIcon__YQQlH"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true" class="product-page-content_productsDropdownIcon__gXtly"><g fill="currentColor"><path d="M10.336 1.5L2 6.268v11.456l3.131 1.793V8.061l5.205-2.979V1.5z"></path><path d="M13.664 1.5v9.123h-3.328V7.219L7.203 9.012V20.7l3.133 1.796V13.4h3.328v3.381l3.131-1.793V3.293L13.664 1.5z"></path><path d="M22 17.732L13.664 22.5v-3.582l5.203-2.98V4.484L22 6.276v11.456z"></path></g></svg></span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="dropdown-menu_activatorTrailingIcon__r_cCd"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button></div><div class="dropdown-menu_dropdownContainer__AZWxN product-page-content_productsDropdownPane__bcdWz" id="navigation-header-menu-react-aria-1" style="display:none"><ul class="dropdown-menu_itemGroup__GEq4r"><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-consul"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M7.846 2.574a.25.25 0 01.308 0l5.25 4.12a.25.25 0 01.096.196v7.36a.75.75 0 001.5 0V6.89a1.75 1.75 0 00-.67-1.377L9.08 1.394a1.75 1.75 0 00-2.16 0l-5.25 4.12A1.75 1.75 0 001 6.89v7.36a.75.75 0 001.5 0V6.89a.25.25 0 01.096-.196l5.25-4.12z"></path><path d="M6.5 14.25V10.5h3v3.75a.75.75 0 001.5 0v-4C11 9.56 10.44 9 9.75 9h-3.5C5.56 9 5 9.56 5 10.25v4a.75.75 0 001.5 0z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">HashiCorp Developer</span></div></div></a></li></ul><hr class="dropdown-menu_itemGroupDivider__X38aR"/><ul class="dropdown-menu_itemGroup__GEq4r"><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-consul/hcp"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M6.835.6L1 3.96v8.074l2.192 1.264V5.224l3.643-2.1V.6z"></path><path d="M9.165.6v6.43h-2.33v-2.4L4.642 5.894v8.237l2.193 1.266v-6.41h2.33v2.383l2.192-1.264V1.864L9.165.6z"></path><path d="M15 12.04L9.165 15.4v-2.525l3.642-2.1V2.703L15 3.966v8.073z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">HashiCorp Cloud Platform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-consul/terraform"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-terraform-brand)"><path d="M1 0v5.05l4.349 2.527V2.526L1 0zM10.175 5.344l-4.35-2.525v5.05l4.35 2.527V5.344zM10.651 10.396V5.344L15 2.819v5.05l-4.349 2.527zM10.174 16l-4.349-2.526v-5.05l4.349 2.525V16z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Terraform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-consul/packer"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Packer</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-consul/consul"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Consul</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-consul/vault"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-vault-brand)" d="M0 0l7.971 15.516L16 0H0zm6.732 6.16h-1.27V4.89h1.27v1.27zm0-1.906h-1.27V2.985h1.27v1.269zm1.904 3.81h-1.27v-1.27h1.27v1.27zm0-1.905h-1.27V4.89h1.27v1.27zm0-1.905h-1.27V2.985h1.27v1.269zm1.894 1.905H9.26V4.89h1.27v1.27zM9.26 4.254V2.985h1.27v1.269H9.26z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Vault</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-consul/boundary"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-boundary-brand)"><path d="M4.81 15v-1.085h2.25v-.67H5.968v-1.093h5.149L8.726 8l2.392-4.154H5.84v5.76H3V1h9.775l1.631 2.832L12.006 8l2.448 4.252L12.872 15H4.81z"></path><path d="M5.248 12.152h-1.09v1.092h1.09v-1.092zM3 13.907h1.09v1.092H3v-1.092z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Boundary</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-consul/nomad"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-nomad-brand)" d="M8 0L1 4v8l7 4 7-4V4L8 0zm3.119 8.797L9.254 9.863 7.001 8.65v2.549l-2.118 1.33v-5.33l1.68-1.018 2.332 1.216V4.794l2.23-1.322-.006 5.325z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Nomad</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-consul/waypoint"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-waypoint-brand)"><path d="M4 5.312h1.334L10 13.4l3.334-5.777L10.666 3H8l2.666 4.623L10 8.778 6.667 3H0l6 10.4 1.333-2.31L4 5.311zM14.002 6.463L16 3h-3.996l1.998 3.463z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Waypoint</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-consul/vagrant"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="#1868F2" d="M13.08.75L9.924 2.58v1.123L8 8.245 6.076 3.703V2.58L2.92.75 1 1.864v1.293l4.276 10.514L8 15.25l2.724-1.579L15 3.157V1.864L13.08.75z"></path><path fill="#0850C5" d="M15 1.865l-3.157 1.829v1.124L9.28 10.57 8 11.312v3.939l2.724-1.579L15 3.158V1.865zM6.076 3.703V2.58l-1.92 1.113v1.125l2.564 5.751L8 9.827V8.245L6.076 3.703z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Vagrant</span></div></div></a></li></ul></div></div></div><div class="product-page-content_productLinkAndNav__YTzcr"><a aria-label="Consul home" class="product-icon-text-link_root__bNTSz g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-product-logo-link" href="/hashicorp-consul/consul"><div class="product-icon-text-lockup_root__358wV"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="product-icon-text-lockup_icon__Zp_5o"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg><span class="product-icon-text-lockup_text__nHTL7 hds-typography-body-200">Consul</span></div></a><nav class="nav-bar-list-container_nav__C_i0_"><ul class="nav-bar-list-container_ul___04HI"><li><a aria-label="Consul Install" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-consul/consul/install"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Install</span></a></li><li><a aria-label="Consul Tutorials" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-consul/consul/tutorials"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Tutorials</span></a></li><li><a aria-label="Consul Documentation" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-consul/consul/docs"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Documentation</span></a></li><li><a aria-label="Consul API" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-consul/consul/api-docs"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">API</span></a></li><li><a aria-label="Consul CLI" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-consul/consul/commands"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">CLI</span></a></li><li><a aria-label="Consul Try Cloud" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" aria-describedby="undefinedopens-in-new-tab-label-react-aria-18" target="_blank" href="https://portal.cloud.hashicorp.com/sign-up"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Try Cloud</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-18">(opens in new tab)</span></li></ul></nav></div></div><div class="navigation-header_rightSide___Vvh_"><button aria-label="Search" class="command-bar-activator_root__qgVMy g-focus-ring-from-box-shadow-dark"><span class="command-bar-activator_left__ATQTg"><span class="command-bar-activator_leadingIcon__jECP5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M7.25 2a5.25 5.25 0 103.144 9.455l2.326 2.325a.75.75 0 101.06-1.06l-2.325-2.326A5.25 5.25 0 007.25 2zM3.5 7.25a3.75 3.75 0 117.5 0 3.75 3.75 0 01-7.5 0z" clip-rule="evenodd"></path></svg></span><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular command-bar-activator_text__pTZN_">Search</span></span><span class="command-bar-activator_right__XejfJ"><span class="g-screen-reader-only">Command or control key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="cmd-ctrl-icon_root___TToz"><svg width="41" height="11" viewBox="0 0 41 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.125 2.063V3h2.25v-.938a2.062 2.062 0 112.063 2.063H7.5v2.25h.938a2.062 2.062 0 11-2.063 2.063V7.5h-2.25v.938a2.062 2.062 0 11-2.063-2.063H3v-2.25h-.938a2.062 2.062 0 112.063-2.063zm-2.063-.938a.937.937 0 100 1.875H3v-.938a.937.937 0 00-.938-.937zM7.5 7.5v.938a.937.937 0 10.938-.938H7.5zM6.375 6.375v-2.25h-2.25v2.25h2.25zM2.062 7.5H3v.938a.937.937 0 11-.938-.938zM7.5 3h.938a.937.937 0 10-.938-.938V3z" fill="#fff"/><path d="M15.09 10.5L18.085 0h-1.097L14 10.5h1.09zm11.297-5.192c-.183-1.445-1.263-2.534-3.05-2.534C21.264 2.774 20 4.247 20 6.61c0 2.41 1.27 3.89 3.344 3.89 1.76 0 2.86-1.034 3.043-2.5H25.02c-.184.808-.792 1.247-1.682 1.247-1.172 0-1.898-.994-1.898-2.637 0-1.61.72-2.583 1.898-2.583.942 0 1.518.555 1.681 1.281h1.368zM28.6 1.041v1.897h-1.133v1.178H28.6v4.281c0 1.432.622 2.007 2.186 2.007.275 0 .537-.034.766-.075V9.158c-.196.02-.32.034-.537.034-.7 0-1.008-.35-1.008-1.15V4.115h1.545V2.938h-1.545V1.041H28.6zm4.607 9.315h1.407V5.911c0-1.048.752-1.767 1.819-1.767.249 0 .667.048.785.082V2.842a3.372 3.372 0 00-.628-.054c-.93 0-1.721.527-1.924 1.26h-.105v-1.13h-1.354v7.438zm5.431 0h1.407V0h-1.407v10.356z" fill="#fff"/></svg></div></span><span class="g-screen-reader-only">K key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="k-icon_root__a_5pR"><svg width="8" height="10" viewBox="0 0 8 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.512 9.84v-3l.986-1.147L5.445 9.84h1.704L3.46 4.745 6.857.84H5.244L1.61 5.094h-.098V.84H.15v9h1.363z" fill="#fff"/></svg></div></span></span></button><div class="navigation-header_authenticationControls__EP1LY"><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj"><button aria-controls="disclosure-react-aria-19-content" aria-expanded="false" aria-label="User menu" class="disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo navigation-header_userDropdownDisclosureActivator__RayIV g-focus-ring-from-box-shadow-dark activator_hasIcon__5HO6W g-focus-ring-from-box-shadow"><span class="activator_childrenWrapper__kaK0w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path fill-rule="evenodd" d="M12 3a5 5 0 100 10 5 5 0 000-10zM8.5 8a3.5 3.5 0 117 0 3.5 3.5 0 01-7 0z" clip-rule="evenodd"></path><path d="M7.75 14.5A4.75 4.75 0 003 19.25v1a.75.75 0 001.5 0v-1A3.25 3.25 0 017.75 16h8.5a3.25 3.25 0 013.25 3.25v1a.75.75 0 001.5 0v-1a4.75 4.75 0 00-4.75-4.75h-8.5z"></path></g></svg></span><span class="activator_chevronWrapper__4_AVG"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></span></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-19-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><button class="list-item_button__nXy5K g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign in</span></button></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-consul/sign-up"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign up</span></a></li><li class="list-item_root__ZdUej"><hr class="list-item_separator__cBVLs"/></li><li class="list-item_root__ZdUej user-dropdown-switcher_listItem__Q_GIj hds-font-weight-medium"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-21">Theme</label></li></ul></div></div></div><button aria-label="Open navigation menu" class="navigation-header_mobileMenuButton__74S4w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path d="M2 5.75A.75.75 0 012.75 5h18.5a.75.75 0 010 1.5H2.75A.75.75 0 012 5.75zM2 11.75a.75.75 0 01.75-.75h18.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2.75 17a.75.75 0 000 1.5h18.5a.75.75 0 000-1.5H2.75z"></path></g></svg></button></div></header></div><div class="base-layout_contentArea__BMvQn"><div class="sidebar-sidecar-layout_root__h5rD8 sidebar-sidecar-layout_mainWidth-narrow__FhCbs"><div class="mobile-menu-container_root__fPUFu sidebar-sidecar-layout_sidebarContainer__4fcF8"><div class="sidebar-sidecar-layout_sidebarContentWrapper__ftn5q"><div class="sidebar_sidebar___fTlC"><div class="sidebar_backToLinkWrapper__F6iLs"><div class="sidebar-back-to-link_root__z_Hj1"><a class="standalone-link_standaloneLink__ahuej g-focus-ring-from-box-shadow standalone-link_primary__ESNCA" data-heap-track="standalone-link sidebar-back-to-link" href="/hashicorp-consul/consul"><div class="standalone-link_standaloneLinkContents__4I2XN standalone-link_medium__J2yVM"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M10.795 3.235a.75.75 0 01-.03 1.06L6.842 8l3.923 3.705a.75.75 0 01-1.03 1.09l-4.5-4.25a.75.75 0 010-1.09l4.5-4.25a.75.75 0 011.06.03z" clip-rule="evenodd"></path></svg><span class="standalone-link_text__7GEyG">Consul Home</span></div></a></div></div><div class="sidebar_filterInputWrapper__0_l_Y"><div class="filter-input_filterInputContainer__thZt3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="filter-input_filterIcon__UET0p filter-input_sharedIconColorAndPositioning__hXPit"><g fill="currentColor"><path d="M1 3.75A.75.75 0 011.75 3h12.5a.75.75 0 010 1.5H1.75A.75.75 0 011 3.75zM3.5 7.75A.75.75 0 014.25 7h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM6.75 11a.75.75 0 000 1.5h2.5a.75.75 0 000-1.5h-2.5z"></path></g></svg><input class="filter-input_filterInput__hga4N g-focus-ring-from-box-shadow" placeholder="Filter sidebar" autoComplete="off" autoCorrect="off" autoCapitalize="none" spellcheck="false" value=""/></div></div><nav aria-labelledby="sidebar-label" class="sidebar_nav__IworY" id="sidebar-nav"><div class="g-screen-reader-only"><h2 class="sidebar-headings_root__tGfxC" id="sidebar-label">CLI</h2></div><a class="skip-to-main-content_root__Ykt77 g-focus-border-and-box-shadow-light" href="#main">Skip to main content</a><ul class="sidebar_navList__4Rg4g"><li><a class="sidebar-nav-highlight-item_root___pPhp g-focus-ring-from-box-shadow sidebar-nav-highlight-item_theme-consul__NA90N" href="/hashicorp-consul/consul/commands"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="sidebar-nav-highlight-item_icon__G8JxG"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg><span class="sidebar-nav-highlight-item_text__VORFJ hds-typography-body-200">CLI</span></a></li><li id="sidebar-nav-item-1"><button aria-controls="sidebar-nav-item-1-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-1-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">acl</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-46"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/agent"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">agent</span></a></li><li id="sidebar-nav-item-47"><button aria-controls="sidebar-nav-item-47-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-47-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">catalog</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-52"><button aria-controls="sidebar-nav-item-52-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-52-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">config</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-58"><button aria-controls="sidebar-nav-item-58-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-58-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">connect</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-65"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/debug"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">debug</span></a></li><li id="sidebar-nav-item-66"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/event"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">event</span></a></li><li id="sidebar-nav-item-67"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/exec"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">exec</span></a></li><li id="sidebar-nav-item-68"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/force-leave"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">force-leave</span></a></li><li id="sidebar-nav-item-69"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/info"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">info</span></a></li><li id="sidebar-nav-item-70"><button aria-controls="sidebar-nav-item-70-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-70-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">intention</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-78"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/join"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">join</span></a></li><li id="sidebar-nav-item-79"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/keygen"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">keygen</span></a></li><li id="sidebar-nav-item-80"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/keyring"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">keyring</span></a></li><li id="sidebar-nav-item-81"><button aria-controls="sidebar-nav-item-81-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-81-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">kv</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-88"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/leave"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">leave</span></a></li><li id="sidebar-nav-item-89"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/license"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">license</span></a></li><li id="sidebar-nav-item-90"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/lock"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">lock</span></a></li><li id="sidebar-nav-item-91"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/login"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">login</span></a></li><li id="sidebar-nav-item-92"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/logout"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">logout</span></a></li><li id="sidebar-nav-item-93"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/maint"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">maint</span></a></li><li id="sidebar-nav-item-94"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/members"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">members</span></a></li><li id="sidebar-nav-item-95"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/monitor"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">monitor</span></a></li><li id="sidebar-nav-item-96"><button aria-controls="sidebar-nav-item-96-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-96-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">namespace</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-104"><button aria-controls="sidebar-nav-item-104-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-104-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">operator</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-110"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/partition"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">partition</span></a></li><li id="sidebar-nav-item-111"><button aria-controls="sidebar-nav-item-111-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-111-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">peering</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-119"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/reload"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">reload</span></a></li><li id="sidebar-nav-item-120"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/resource"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">resource</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><span class="g-screen-reader-only">v2</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_outlined-neutral__32YXY"><span>v2</span></span></div></a></li><li id="sidebar-nav-item-121"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/rtt"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">rtt</span></a></li><li id="sidebar-nav-item-122"><button aria-controls="sidebar-nav-item-122-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-122-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">services</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-128"><button aria-controls="sidebar-nav-item-128-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-128-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">snapshot</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="sidebar-nav-item-128-list"><li id="sidebar-nav-item-129"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/snapshot"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Overview</span></a></li><li id="sidebar-nav-item-130"><a aria-current="page" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/snapshot/agent"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">agent</span></a></li><li id="sidebar-nav-item-131"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/snapshot/inspect"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">inspect</span></a></li><li id="sidebar-nav-item-132"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/snapshot/restore"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">restore</span></a></li><li id="sidebar-nav-item-133"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/snapshot/save"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">save</span></a></li></ul></li><li id="sidebar-nav-item-134"><button aria-controls="sidebar-nav-item-134-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-134-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">tls</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-138"><button aria-controls="sidebar-nav-item-138-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-138-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">troubleshoot</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-143"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/validate"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">validate</span></a></li><li id="sidebar-nav-item-144"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/version"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">version</span></a></li><li id="sidebar-nav-item-145"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/consul/commands/watch"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">watch</span></a></li></ul><hr class="sidebar-horizontal-rule_root__UY7oh"/><ul class="sidebar_navList__4Rg4g"><li><h3 class="sidebar-headings_root__tGfxC">Resources</h3></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/tutorials/library?product=consul"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Tutorial Library</span></a></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-consul/certifications/networking-automation"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Certifications</span></a></li><li><a aria-label="Community Forum. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-55" target="_blank" href="https://discuss.hashicorp.com/c/consul/29"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Community Forum</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-55">(opens in new tab)</span></li><li><a aria-label="Support. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-56" target="_blank" href="https://www.hashicorp.com/customer-success"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Support</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-56">(opens in new tab)</span></li><li><a aria-label="GitHub. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-57" target="_blank" href="https://github.com/hashicorp/consul"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">GitHub</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-57">(opens in new tab)</span></li></ul></nav></div></div></div><div class="sidebar-sidecar-layout_contentWrapper__Z5BK4"><div class="sidebar-sidecar-layout_paddedAreaWrapper___S_Ff"><div class="sidebar-sidecar-layout_breadcrumbContainer__3uz7P"><div class="sidebar-sidecar-layout_breadcrumbMaxWidth__coOcu"><nav aria-label="Breadcrumb" class="breadcrumb-bar_root__wd_C5"><ol class="breadcrumb-bar_listRoot__8eupO"><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-consul">Developer</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-consul/consul">Consul</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-consul/consul/commands">CLI</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-consul/consul/commands/snapshot">snapshot</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><span class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" aria-current="page" data-heap-track="breadcrumb-bar-item">agent</span></li></ol></nav></div></div><div class="sidebar-sidecar-layout_mainAndSidecar__UDm3Z"><main id="main" class="sidebar-sidecar-layout_main__0SN51"><div class="docs-page-heading_root__QuBg_ docs-view_docsPageHeading___xkrK"><div class="docs-page-heading_pageHeadingWrapper__LEMQ7"><h1 class="hds-typography-display-600 hds-font-weight-bold docs-plain-page-heading_root__HzRuX g-offset-scroll-margin-top" id="consul-snapshot-agent">Consul Snapshot Agent</h1></div></div><div class="dev-dot-content_root__UJDct hds-typography-body-300"><div class="docs-view_mdxContent___uMnx"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Command: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">consul snapshot agent</code></p><div class="enterprise-alert_root__mvEIF"><span class="g-screen-reader-only">Enterprise</span><span aria-hidden="true" class="badge_root___Z7Nt badge_medium__8VGoW badge_outlined-neutral__32YXY enterprise-alert_badge___N2fV"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg><span>Enterprise</span></span><p class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular enterprise-alert_text__CGyqh">This feature requires<!-- --> <a target="_blank" rel="noopener noreferrer" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-200 hds-font-weight-regular inline-link_primary__kGJLJ" aria-describedby="undefinedopens-in-new-tab-label-react-aria-62" href="https://www.hashicorp.com/products/consul">Consul<!-- --> Enterprise</a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-62">(opens in new tab)</span>.</p></div><div class="alert alert-warning g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-consul/consul/commands/snapshot/agent"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">agent</code></a> subcommand described here is
available only in <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://www.hashicorp.com/products/consul/">Consul Enterprise</a>
version 0.7.1 and later. All other <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-consul/consul/commands/snapshot">snapshot subcommands</a>
are available in the community edition of Consul.</p></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot agent</code> subcommand starts a process that takes snapshots of the
state of the Consul servers and saves them locally, or pushes them to an
optional remote storage service.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The agent can be run as a long-running daemon process or in a one-shot mode
from a batch job, based on the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-consul/consul/commands/snapshot/agent#interval"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-interval</code></a> argument. Snapshotting
a remote datacenter is only available in one-shot mode.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">As a long-running daemon, the agent will perform a leader election so multiple
processes can be run in a highly available fashion with automatic failover. The
agent will also register itself with Consul as a service, along with health
checks that show the agent is alive (&quot;Consul Snapshot Agent Alive&quot;) and able to
take snapshots (&quot;Consul Snapshot Agent Saving Snapshots&quot;). The latter check is
only added on agents who have become a leader, so it&#x27;s possible for operators to
tell which instances are alive and on standby and which instance has become
leader and starting saving snapshots.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">As snapshots are saved, they will be reported in the log produced by the agent:</p><div class="g-code-block style_root__i1k0c language-log mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-log mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-log mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token date number">2016/11/16</span> <span class="token time number">21:21:13</span> <span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span> Snapshot agent running<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token date number">2016/11/16</span> <span class="token time number">21:21:13</span> <span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span> Waiting to obtain leadership<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token date number">2016/11/16</span> <span class="token time number">21:21:13</span> <span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span> Obtained leadership<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token date number">2016/11/16</span> <span class="token time number">21:21:13</span> <span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span> Saved snapshot <span class="token number">1479360073448728784</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The number shown with the saved snapshot is its ID, which is based on a UNIX
timestamp with nanosecond resolution, so collisions are unlikely and IDs are
monotonically increasing with time. This makes it easy to locate the latest
snapshot, even if the log data isn&#x27;t available. The snapshot ID always appears
in the file name when using local storage, or in the object key when using
remote storage.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Snapshots can be restored using the
<a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-consul/consul/commands/snapshot/restore"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">consul snapshot restore</code></a> command, or
the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-consul/consul/api-docs/snapshot">HTTP API</a>.</p><h2 id="acl-permissions" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="acl permissions permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#acl-permissions"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>ACL permissions</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If ACLs are enabled the following privileges are required:</p><div class="mdx-table_root__adKqa"><div class="mdx-table_tableWrapper__81O9J"><table><thead><tr><th>Resource</th><th>Segment</th><th>Permission</th><th>Explanation</th></tr></thead><tbody><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">acl</code></td><td>N/A</td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">write</code></td><td>All snapshotting operations require this privilege due to snapshots containing ACL tokens including unredacted secrets.</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">key</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;lock key&gt;</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">write</code></td><td>The lock key (which defaults to <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">consul-snapshot/lock</code>) is used during snapshot agent leader election.</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;agent name&gt;</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">write</code></td><td>The session used for locking during leader election is created against the agent name of the Consul agent that the Snapshot agent is registering itself with.</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">service</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;service name&gt;</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">write</code></td><td>The Snapshot agent registers itself with the local Consul agent and must have write privileges on its service name which is configured with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-service</code>.</td></tr></tbody></table></div><div class="mdx-table_tableFocusRing__qNrYf"></div><div><div class="mdx-table_leftScrim__mYsmq mdx-table_scrim__VtktE"></div><div class="mdx-table_rightScrim__Ikt63 mdx-table_scrim__VtktE"></div></div></div><h3 id="example-acl-policy" class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="example acl policy permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#example-acl-policy"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Example ACL policy</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following is a example least privilege policy which allows the snapshot agent
to run on a node named <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">server-1234</code>.</p><div class="mdx-code-blocks_codeTabsMargin__XyBTZ style_root__Ib9Qn theme-dark_base__RNsat"><div style="height:0px;overflow:hidden;visibility:hidden" role="presentation" aria-hidden="true"><div class="style_topBar__0pZ_b"><div class="style_tabsAsTabs__lZ0ce"><button class="style_tabControl__A5k2n g-type-body-small-strong style_isActive__AmKFP">HCL</button><button class="style_tabControl__A5k2n g-type-body-small-strong">JSON</button></div></div></div><div class="style_topBar__0pZ_b"><div class="style_tabsAsTabs__lZ0ce"><button class="style_tabControl__A5k2n g-type-body-small-strong style_isActive__AmKFP">HCL</button><button class="style_tabControl__A5k2n g-type-body-small-strong">JSON</button></div></div><div><div style="display:block"><div class="g-code-block style_root__i1k0c language-hcl theme-dark_base__RNsat theme-dark_syntax__QCDzs style_hasBarAbove__gZA5T" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl"><code class="code-lines_code__luWmT language-hcl"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># Required to read and snapshot ACL data</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token property">acl</span> <span class="token punctuation">=</span> <span class="token string">&quot;write&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># Allow the snapshot agent to create the key consul-snapshot/lock which will</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># serve as a leader election lock when multiple snapshot agents are running in</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># an environment</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">key <span class="token string">&quot;consul-snapshot/lock&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">policy</span> <span class="token punctuation">=</span> <span class="token string">&quot;write&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># Allow the snapshot agent to create sessions on the specified node</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">session <span class="token string">&quot;server-1234&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">policy</span> <span class="token punctuation">=</span> <span class="token string">&quot;write&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># Allow the snapshot agent to register itself into the catalog</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">service <span class="token string">&quot;consul-snapshot&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">policy</span> <span class="token punctuation">=</span> <span class="token string">&quot;write&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div></div><div style="display:none"><div class="g-code-block style_root__i1k0c language-json theme-dark_base__RNsat theme-dark_syntax__QCDzs style_hasBarAbove__gZA5T" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json"><code class="code-lines_code__luWmT language-json"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;acl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;write&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;consul-snapshot/lock&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;policy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;write&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;session&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;server-1234&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;policy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;write&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;service&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;consul-snapshot&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;policy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;write&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Additional <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session</code> rules should be created, or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">session_prefix</code> used, if the
snapshot agent is deployed across more than one host.</p><h2 id="usage" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="usage permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#usage"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Usage</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Usage: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">consul snapshot agent [options]</code></p><h4 id="config-file-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="config file options permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#config-file-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Config File Options</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="config-dir" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="config dir permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#config-dir"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-config-dir</code></a> - Directory to look for JSON config files. Files will be read in
alphabetical order and must end with the extension &quot;.json&quot;. This won&#x27;t
recursively descend directories. This can be specified multiple times on the
command line.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="config-file" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="config file permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#config-file"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-config-file</code></a> - File to read JSON configuration from. Files must end with the
extension &quot;.json&quot;. This can be specified multiple times on the command line.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Config files referenced using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-config-dir</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-config-file</code> have the following
format (shown populated with default values):</p></li></ul><div class="g-code-block style_root__i1k0c language-json mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-json mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;snapshot_agent&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;http_addr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1:8500&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;datacenter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;ca_file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;ca_path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;cert_file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;key_file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;license_path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;tls_server_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;login&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;auth_method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;bearer_token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;bearer_token_file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;log&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;level&quot;</span><span class="token operator">:</span> <span class="token string">&quot;INFO&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;enable_syslog&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;syslog_facility&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LOCAL0&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;snapshot&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;interval&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1h&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;retain&quot;</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;stale&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;service&quot;</span><span class="token operator">:</span> <span class="token string">&quot;consul-snapshot&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;deregister_after&quot;</span><span class="token operator">:</span> <span class="token string">&quot;72h&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;lock_key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;consul-snapshot/lock&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;max_failures&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;local_scratch_path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;local_storage&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;aws_storage&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;access_key_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;secret_access_key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;session_token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;iam_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;role_arn&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;role_session_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;web_identity_token_file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;sts_endpoint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;s3_region&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;s3_bucket&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;s3_key_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;consul-snapshot&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;s3_server_side_encryption&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;s3_static_snapshot_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;s3_force_path_style&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;azure_blob_storage&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;account_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;account_key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;container_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;google_storage&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;bucket&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">All fields are optional, and config files without a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_agent</code> object will
be ignored. At least one config file needs to have a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_agent</code> object, or the
snapshot agent will fail to start. The Consul agent is set up to ignore any
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">snapshot_agent</code> object, so it&#x27;s safe to use common config directories for both agents
if desired.</p><h4 id="snapshot-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="snapshot options permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#snapshot-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Snapshot Options</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="interval" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="interval permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#interval"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-interval</code></a> - Interval at which to perform snapshots as
a time with a unit suffix, which can be &quot;s&quot;, &quot;m&quot;, &quot;h&quot; for seconds, minutes, or
hours. If 0 is provided, the agent will take a single snapshot and then exit, which
is useful for running snapshots via batch jobs. Defaults to &quot;1h&quot;</p></li><li class="mdx-lists_listItem__nkqhg"><a id="lock-key" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="lock key permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#lock-key"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-lock-key</code></a> - A prefix in Consul&#x27;s KV store used to coordinate between
different instances of the snapshot agent in order to only have one active instance
at a time. For highly available operation of the snapshot agent, simply run
multiple instances. All instances must be configured with the same lock key in
order to properly coordinate. Defaults to &quot;consul-snapshot/lock&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="max-failures" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="max failures permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#max-failures"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-max-failures</code></a> - Number of snapshot failures after which the snapshot agent
will give up leadership. In a highly available operation with multiple snapshot
agents available, this gives another agent a chance to take over if an agent
is experiencing issues, such as running out of disk space for snapshots.
Defaults to 3.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="retain" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="retain permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#retain"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-retain</code></a> - Number of snapshots to retain. After each snapshot is taken, the
oldest snapshots will start to be deleted in order to retain at most this many
snapshots. If this is set to 0, the agent will not perform this and snapshots
will accumulate forever. Defaults to 30.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="local-scratch-path" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="local scratch path permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#local-scratch-path"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-local-scratch-path</code></a> - Location to store all temporary snapshots in prior to
sending them off to the configured storage backend. If not configured the
system temporary directory will be used. When using the local storage backend
this is not configurable and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-local-path</code> will be used.</p></li></ul><h4 id="agent-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="agent options permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#agent-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Agent Options</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="deregister-after" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="deregister after permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#deregister-after"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-deregister-after</code></a> - An interval, after which if the agent is unhealthy it will be
automatically deregistered from Consul service discovery. This is a time with a
unit suffix, which can be &quot;s&quot;, &quot;m&quot;, &quot;h&quot; for seconds, minutes, or hours. If 0 is
provided, this will be disabled. Defaults to &quot;72h&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="log-level" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="log level permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#log-level"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-log-level</code></a> - Controls verbosity of snapshot agent logs. Valid options are
&quot;trace&quot;, &quot;debug&quot;, &quot;info&quot;, &quot;warn&quot;, &quot;error&quot;. Defaults to &quot;info&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="service" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="service permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#service"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-service</code></a> - The service name to use when registering the agent with Consul.
Registering helps monitor running agents and the leader registers an additional
health check to monitor that snapshots are taking place. Defaults to
&quot;consul-snapshot&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="syslog" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="syslog permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#syslog"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-syslog</code></a> - This enables forwarding logs to syslog. Defaults to false.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="syslog-facility" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="syslog facility permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#syslog-facility"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-syslog-facility</code></a> - Sets the facility to use for forwarding logs to syslog.
Defaults to &quot;LOCAL0&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="login-auth-method" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="login auth method permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#login-auth-method"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">login-auth-method</code></a> - Auth method name to use to log into Consul. If provided, the token obtained with this auth method
will be used instead of a static token if it is provided. Currently, only <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">kubernetes</code> auth method type is supported.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="login-bearer-token" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="login bearer token permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#login-bearer-token"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">login-bearer-token</code></a> - Bearer token to use to log into Consul. Used only if <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-login-auth-method</code> is set.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="login-bearer-token-file" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="login bearer token file permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#login-bearer-token-file"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">login-bearer-token-file</code></a> - A file container bearer token to use for logging into Consul.
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-login-bearer-token</code> is ignored if this flag is provided.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="login-meta" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="login meta permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#login-meta"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">login-meta</code></a> - Metadata to set on the token, formatted as key=value. This flag may be provided multiple times.</p></li></ul><h4 id="local-storage-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="local storage options permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#local-storage-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Local Storage Options</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="local-path" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><a aria-label="local path permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#local-path"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-local-path</code></a> - Location to store snapshots locally. The default behavior
of the snapshot agent is to store snapshots locally in this directory. Defaults
to &quot;.&quot; to use the current working directory. If an alternate storage option is
configured, then local storage will be disabled and this option will be ignored.</li></ul><h4 id="s3-storage-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="s3 storage options permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#s3-storage-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>S3 Storage Options</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Note that despite the AWS references, any S3-compatible endpoint can be specified with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-endpoint</code>.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="aws-access-key-id" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws access key id permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-access-key-id"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-access-key-id</code></a>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-secret-access-key</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-session-token</code> - These arguments supply static
authentication information for connecting to S3. These may also be supplied using
the following alternative methods:<br/></p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="aws_access_key_id" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><a aria-label="aws_access_key_id permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws_access_key_id"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_ACCESS_KEY_ID</code></a>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_SECRET_ACCESS_KEY</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_SESSION_TOKEN</code> environment variables</li><li class="mdx-lists_listItem__nkqhg">A credentials file (<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">~/.aws/credentials</code> or the file at the path specified by the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_SHARED_CREDENTIALS_FILE</code> environment variable)</li><li class="mdx-lists_listItem__nkqhg">ECS task role metadata (container-specific)</li><li class="mdx-lists_listItem__nkqhg">EC2 instance role metadata</li></ul></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-iam-endpoint" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws iam endpoint permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-iam-endpoint"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-iam-endpoint</code></a> - IAM endpoint to use when authenticating with static credentials.
Default is to use the global IAM endpoint.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-role-arn" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws role arn permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-role-arn"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-role-arn</code></a>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-role-session-name</code>, and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-web-identity-token-file</code> - These arguments are
used to obtain temporary credentials by assuming an IAM role. These may also be supplied using
the following alternative methods:<br/></p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="aws_role_arn" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><a aria-label="aws_role_arn permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws_role_arn"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_ROLE_ARN</code></a>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_ROLE_SESSION_NAME</code>, and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_WEB_IDENTITY_TOKEN_FILE</code> environment variables.</li><li class="mdx-lists_listItem__nkqhg">A credentials file (~/.aws/credentials or the file at the path specified by the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_SHARED_CREDENTIALS_FILE</code> environment variable)</li></ul></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-sts-endpoint" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws sts endpoint permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-sts-endpoint"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-sts-endpoint</code></a> - STS endpoint to use for obtaining temporary credentials.
Default is to use the global STS endpoint.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-bucket" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 bucket permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-s3-bucket"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-bucket</code></a> - S3 bucket to use. Required for S3 storage, and setting this
disables local storage. This should be only the bucket name without any
part of the key prefix.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-key-prefix" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 key prefix permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-s3-key-prefix"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-key-prefix</code></a> - Prefix to use for snapshot files in S3. Defaults to
&quot;consul-snapshot&quot;.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-region" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 region permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-s3-region"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-region</code></a> - S3 region to use. Required for S3 storage.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-endpoint" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 endpoint permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-s3-endpoint"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-endpoint</code></a> - S3 endpoint to use. Can also be specified using the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">AWS_S3_ENDPOINT</code> environment variable. Defaults to the regional S3 endpoint.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-server-side-encryption" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 server side encryption permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-s3-server-side-encryption"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-server-side-encryption</code></a> - Enables saving snapshots to S3 using server side encryption with <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingServerSideEncryption.html">Amazon S3-Managed Encryption Keys</a></p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-static-snapshot-name" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 static snapshot name permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-s3-static-snapshot-name"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-static-snapshot-name</code></a> - If this is given, all snapshots are saved with the same file name. The agent will not rotate or version snapshots, and will save them with the same name each time.
Use this if you want to rely on <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="http://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html">S3&#x27;s versioning capabilities</a> instead of the agent handling it for you.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-force-path-style" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 force path style permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-s3-force-path-style"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-force-path-style</code></a> - Enables the use of legacy path-based addressing instead of virtual addressing. This flag is required by minio
and other 3rd party S3 compatible object storage platforms where DNS or TLS requirements for virtual addressing are prohibitive.
For more information, refer to the AWS documentation on <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-bucket-intro.html">Methods for accessing a bucket</a></p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-enable-kms" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 enable kms permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-s3-enable-kms"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-enable-kms</code></a> - Enables using <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://aws.amazon.com/kms/">Amazon KMS</a> for encrypting snapshots.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="aws-s3-kms-key" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="aws s3 kms key permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#aws-s3-kms-key"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-aws-s3-kms-key</code></a> - Optional Amazon KMS key to use, if this is not set the default KMS master key will be used. Set this if you want to manage key rotation yourself.</p><div class="alert alert-info g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">When using a S3-compatible storage exposing a self-signed certificate the agent will not be able to perform
the snapshot operations unless the CA used to sign the storage certificate is trusted by the node running
the agent. You can add the CA root certificate to the OS trust store to have Consul trust the storage endpoint.</p></div></li></ul><h4 id="s3-required-permissions" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="s3 required permissions permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#s3-required-permissions"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>S3 Required Permissions</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Different S3 permissions are required depending on the configuration of the snapshot agent. In particular extra permissions are required when
snapshot rotation is enabled. S3 storage snapshot rotation is enabled when the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">retain</code> configuration is greater than 0 and when there is
no <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws-s3-static-snapshot-name</code> configured.</p><div class="mdx-table_root__adKqa"><div class="mdx-table_tableWrapper__81O9J"><table><thead><tr><th>Permission</th><th>Resource</th><th>When you need it</th></tr></thead><tbody><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">PutObject</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">arn:aws:s3:::&lt;bucket name&gt;/&lt;key&gt;</code></td><td>Required for all operations.</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">DeleteObject</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">arn:aws:s3:::&lt;bucket name&gt;/&lt;key&gt;</code></td><td>Required only when snapshot rotation is enabled</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ListBucket</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">arn:aws:s3:::&lt;bucket name&gt;</code></td><td>Required only when snapshot rotation is enabled</td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">ListBucketVersions</code></td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">arn:aws:s3:::&lt;bucket name&gt;</code></td><td>Required only when snapshot rotation is enabled</td></tr></tbody></table></div><div class="mdx-table_tableFocusRing__qNrYf"></div><div><div class="mdx-table_leftScrim__mYsmq mdx-table_scrim__VtktE"></div><div class="mdx-table_rightScrim__Ikt63 mdx-table_scrim__VtktE"></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Within the table <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;key&gt;</code> refers to the key used to store the snapshot. When <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws-s3-static-snapshot-name</code> is configured the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;key&gt;</code> is simply the value of that configuration. Otherwise the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;key&gt;</code> will be the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">&lt;aws-s3-key-prefix configuration&gt;/consul-*.snap</code>.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following example IAM policy document assumes that the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws-s3-bucket</code> is <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">consul-data</code> with defaults for <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws-s3-key-prefix</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws-s3-static-snapshot-name</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">retain</code>:</p><div class="g-code-block style_root__i1k0c language-json mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-json mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-json mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;Version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2012-10-17&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">&quot;Statement&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;Sid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;s3:PutObject&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;s3:DeleteObject&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;arn:aws:s3:::consul-data/consul-snapshots/consul-*.snap&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;Sid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;s3:ListBucketVersions&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;s3:ListBucket&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;arn:aws:s3:::consul-data&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 id="azure-blob-storage-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="azure blob storage options permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#azure-blob-storage-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Azure Blob Storage options</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong> Note: This currently only works on non-Solaris platforms due to library limitations </strong></p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">From Consul Enterprise version <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">1.5.0</code> onwards, you can store snapshots in Azure Blob storage.</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="azure-blob-account-name" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="azure blob account name permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#azure-blob-account-name"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-azure-blob-account-name</code></a> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-azure-blob-account-key</code> - These arguments supply
authentication information for connecting to Azure Blob storage.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="azure-blob-container-name" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="azure blob container name permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#azure-blob-container-name"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-azure-blob-container-name</code></a> - Container to use. Required for Azure blob storage, and setting this
disables local storage.</p></li></ul><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="azure-blob-environment" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><a aria-label="azure blob environment permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#azure-blob-environment"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-azure-blob-environment</code></a> - Environment to use. Defaults to AZUREPUBLICCLOUD. Other valid environments
are AZURECHINACLOUD, AZUREGERMANCLOUD and AZUREUSGOVERNMENTCLOUD. Introduced in Consul 1.7.3.</li></ul><h4 id="google-cloud-storage-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="google cloud storage options permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#google-cloud-storage-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Google Cloud Storage options</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">From Consul Enterprise version <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">1.6.1</code> onwards, you can store snapshots in Google Cloud Storage. Authentication relies on automatic discovery through the sdk as described <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://cloud.google.com/docs/authentication/production">here</a>:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">First, ADC checks to see if the environment variable GOOGLE_APPLICATION_CREDENTIALS is set. If the variable is set, ADC uses the service account file that the variable points to. The next section describes how to set the environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If the environment variable isn&#x27;t set, ADC uses the default service account that Compute Engine, Kubernetes Engine, App Engine, and Cloud Functions provide, for applications that run on those services.</p></li><li class="mdx-lists_listItem__nkqhg"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If ADC can&#x27;t use either of the above credentials, an error occurs.</p></li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This integration needs the following information:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="gcs-bucket" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><a aria-label="gcs bucket permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#gcs-bucket"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-gcs-bucket</code></a> supplies the bucket to use.</li></ul><h4 id="api-options" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="api options permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#api-options"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>API Options</h4><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="ca-file" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="ca file permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#ca-file"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-ca-file=&lt;value&gt;</code></a> - Path to a CA file to use for TLS when communicating with Consul.
This can also be specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_CACERT</code> environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="ca-path" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="ca path permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#ca-path"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-ca-path=&lt;value&gt;</code></a> - Path to a directory of CA certificates to use for TLS when
communicating with Consul. This can also be specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_CAPATH</code>
environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="client-cert" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="client cert permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#client-cert"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-client-cert=&lt;value&gt;</code></a> - Path to a client cert file to use for TLS when
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">verify_incoming</code> is enabled. This can also be specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_CLIENT_CERT</code>
environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="client-key" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="client key permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#client-key"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-client-key=&lt;value&gt;</code></a> - Path to a client key file to use for TLS when
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">verify_incoming</code> is enabled. This can also be specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_CLIENT_KEY</code>
environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="http-addr" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="http addr permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#http-addr"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-http-addr=&lt;addr&gt;</code></a> - Address of the Consul agent with the port. This can be
an IP address or DNS address, but it must include the port. This can also be
specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_HTTP_ADDR</code> environment variable. In Consul 0.8 and
later, the default value is <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="http://127.0.0.1:8500">http://127.0.0.1:8500</a>, and https can optionally be
used instead. The scheme can also be set to HTTPS by setting the environment
variable <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_HTTP_SSL=true</code>. This may be a unix domain socket using
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">unix:///path/to/socket</code> if the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-consul/consul/docs/agent/config/config-files#addresses">agent is configured to
listen</a> that way.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="tls-server-name" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="tls server name permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#tls-server-name"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-tls-server-name=&lt;value&gt;</code></a> - The server name to use as the SNI host when
connecting via TLS. This can also be specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_TLS_SERVER_NAME</code>
environment variable.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="token" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="token permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#token"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-token=&lt;value&gt;</code></a> - ACL token to use in the request. This can also be specified
via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_HTTP_TOKEN</code> environment variable. If unspecified, the query
will default to the token of the Consul agent at the HTTP address.</p></li><li class="mdx-lists_listItem__nkqhg"><a id="token-file" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a aria-label="token file permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#token-file"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-token-file=&lt;value&gt;</code></a> - File containing the ACL token to use in the request
instead of one specified via the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-token</code> argument or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_HTTP_TOKEN</code>
environment variable. This can also be specified via the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_HTTP_TOKEN_FILE</code> environment variable.</p></li></ul><h2 id="examples" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="examples permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#examples"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Examples</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Running the agent with no arguments will run a long-running daemon process that will
perform leader election for highly available operation, register itself with Consul
service discovery with health checks, take snapshots every hour, retain the last 30
snapshots, and save snapshots into the current working directory:</p><div class="g-code-block style_root__i1k0c language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">consul snapshot agent</span></span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">To run a one-shot backup, set the backup interval to 0. This will run a single snapshot
and delete any old snapshots based on the retain settings, but it will not perform any
leader election or service registration:</p><div class="g-code-block style_root__i1k0c language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-shell-session mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">consul snapshot agent -interval<span class="token operator">=</span><span class="token number">0</span></span></span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Please see the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-consul/consul/api-docs/snapshot">HTTP API</a> documentation for
more details about snapshot internals.</p><h2 id="licensing" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="licensing permalink" href="/hashicorp-consul/consul/commands/snapshot/agent#licensing"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Licensing</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The snapshot agent requires a license when it starts before it will perform any other
actions. This can be provided using the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">license_path</code> configuration item, the
<code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE_PATH</code> environment variable or the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE</code> environment variable.
The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">license_path</code> configuration and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE_PATH</code> variable should point to
files that contain the license whereas the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE</code> variable value should be
the contents of the license itself. If a license is present in multiple ways the
then the order of precedence is as follows:</p><ol class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg"><a id="consul_license" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><a aria-label="consul_license permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#consul_license"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE</code></a> variable</li><li class="mdx-lists_listItem__nkqhg"><a id="consul_license_path" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><a aria-label="consul_license_path permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#consul_license_path"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">CONSUL_LICENSE_PATH</code></a> variable</li><li class="mdx-lists_listItem__nkqhg"><a id="license_path" aria-hidden="true" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __target-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#"></a><a aria-label="license_path permalink" class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ __permalink-lic" href="/hashicorp-consul/consul/commands/snapshot/agent#license_path"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">license_path</code></a> configuration.</li></ol><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The ability to load licenses from the configuration or environment was added in v1.10.0,
v1.9.7 and v1.8.13. See the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-consul/consul/docs/enterprise/license/overview">licensing documentation</a> for
more information about Consul Enterprise license management.</p></div></div><a href="https://github.com/hashicorp/consul/blob/main/website/../content/commands/snapshot/agent.mdx" target="_blank" class="edit-on-github-link_editLink__AsG8Z sidebar-sidecar-layout_editOnGithubLink__SDraB" rel="noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="edit-on-github-link_editLinkIcon__wMtY9"><path fill="currentColor" fill-rule="evenodd" d="M8 1C4.133 1 1 4.13 1 7.993c0 3.09 2.006 5.71 4.787 6.635.35.064.478-.152.478-.337 0-.166-.006-.606-.01-1.19-1.947.423-2.357-.937-2.357-.937-.319-.808-.778-1.023-.778-1.023-.635-.434.048-.425.048-.425.703.05 1.073.72 1.073.72.624 1.07 1.638.76 2.037.582.063-.452.244-.76.444-.935-1.554-.176-3.188-.776-3.188-3.456 0-.763.273-1.388.72-1.876-.072-.177-.312-.888.07-1.85 0 0 .586-.189 1.924.716A6.711 6.711 0 018 4.381c.595.003 1.194.08 1.753.236 1.336-.905 1.923-.717 1.923-.717.382.963.142 1.674.07 1.85.448.49.72 1.114.72 1.877 0 2.686-1.638 3.278-3.197 3.45.251.216.475.643.475 1.296 0 .934-.009 1.688-.009 1.918 0 .187.127.404.482.336A6.996 6.996 0 0015 7.993 6.997 6.997 0 008 1z" clip-rule="evenodd"></path></svg>Edit this page on GitHub</a></main><div class="sidebar-sidecar-layout_sidecarPosition__WtTq0"><div class="sidebar-sidecar-layout_sidecarTopSlot__qRAEI"></div><div class="sidecar-scroll-container_root__a8nIj"><div class="sidecar-scroll-container_scrollContainer__Dw9id"><div><nav aria-labelledby="react-aria-172"><p id="react-aria-172" class="outline-nav_navLabel__HrjQb hds-typography-body-100">On this page:</p><ol class="outline-nav_listRoot__Sm1fr"><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-0" href="/hashicorp-consul/consul/commands/snapshot/agent#consul-snapshot-agent">Consul Snapshot Agent</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-1" href="/hashicorp-consul/consul/commands/snapshot/agent#acl-permissions">ACL permissions</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-2" href="/hashicorp-consul/consul/commands/snapshot/agent#usage">Usage</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-3" href="/hashicorp-consul/consul/commands/snapshot/agent#examples">Examples</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-4" href="/hashicorp-consul/consul/commands/snapshot/agent#licensing">Licensing</a></li></ol></nav></div></div></div></div></div></div></div></div></div><div class="base-layout_footer__HGqK8 base-layout_showFooterTopBorder__4_CwH"><footer class="footer_root__qJO_k"><span class="footer_logoAndSwitcher__CJkN3"><a href="https://www.hashicorp.com/" aria-label="Go to HashiCorp home page" class="footer_logo__pe9i3 g-focus-ring-from-box-shadow"><div><svg width="317" height="88" viewBox="0 0 317 88" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M107.692 64.421V47.4h-14.97v17.02h-7.623V24.06h7.622v16.602h14.971V24.06h7.622v40.36h-7.622zm35.567-.001h-6.053l-.548-1.996a16.137 16.137 0 01-8.789 2.607c-5.397 0-7.699-3.697-7.699-8.79 0-5.998 2.607-8.3 8.606-8.3h7.089v-3.095c0-3.27-.907-4.421-5.633-4.421a41.255 41.255 0 00-8.179.877l-.907-5.634a38.496 38.496 0 0110.122-1.395c9.269 0 11.998 3.27 11.998 10.672l-.007 19.476zm-7.394-11.151h-5.45c-2.424 0-3.087.663-3.087 2.912 0 2.058.663 2.973 2.972 2.973a11.629 11.629 0 005.572-1.525l-.007-4.36zm21.701 11.754a34.776 34.776 0 01-10.183-1.7l1.029-5.633a33.038 33.038 0 008.788 1.273c3.271 0 3.758-.762 3.758-2.973 0-1.814-.366-2.729-5.152-3.88-7.211-1.76-8.058-3.575-8.058-9.269 0-5.938 2.607-8.545 11.03-8.545 2.98.003 5.949.348 8.85 1.03l-.762 5.876a51.98 51.98 0 00-8.118-.846c-3.209 0-3.758.763-3.758 2.546 0 2.363.183 2.546 4.185 3.575 8.263 2.188 9.055 3.278 9.055 9.307 0 5.725-1.761 9.239-10.664 9.239zm32.663-.602V43.84c0-1.578-.663-2.363-2.363-2.363-1.814 0-5.031 1.09-7.699 2.485v20.459h-7.394V22.847l7.394-1.029v15.33a26.045 26.045 0 0110.786-2.852c4.909 0 6.662 3.453 6.662 8.728v21.397h-7.386zm12.844-33.692v-8.545h7.394v8.545h-7.394zm0 33.692V34.906h7.394v29.515h-7.394zM215.62 35.15c0-7.394 4.299-11.693 14.361-11.693 3.697 0 7.38.447 10.969 1.334l-.839 6.601a59.517 59.517 0 00-9.909-1.029c-5.275 0-6.967 1.822-6.967 6.098v15.512c0 4.3 1.7 6.098 6.967 6.098a59.506 59.506 0 009.909-1.029l.846 6.609a45.672 45.672 0 01-10.968 1.334c-10.062 0-14.361-4.3-14.361-11.693l-.008-18.142zm40.499 29.873c-10.123 0-12.844-5.572-12.844-11.632v-7.455c0-6.06 2.728-11.632 12.844-11.632 10.115 0 12.844 5.572 12.844 11.632v7.455c-.023 6.06-2.744 11.632-12.844 11.632zm0-24.392c-3.941 0-5.45 1.76-5.45 5.092v7.912c0 3.331 1.524 5.092 5.45 5.092 3.925 0 5.45-1.76 5.45-5.092v-7.943c-.015-3.33-1.532-5.092-5.45-5.092v.03zm32.457.457a57.835 57.835 0 00-7.821 4.3v19.056h-7.394V34.906h6.243l.488 3.27a33.064 33.064 0 017.76-3.88l.724 6.792zm28.035 13.515c0 6.548-2.911 10.42-9.756 10.42a40.76 40.76 0 01-7.882-.853v12.196l-7.394 1.029V34.906h5.877l.762 2.485a15.535 15.535 0 019.33-3.087c5.938 0 9.086 3.514 9.086 10.245l-.023 10.054zm-17.631 3.331c2.152.474 4.346.73 6.548.763 2.668 0 3.697-1.274 3.697-3.941V44.35c0-2.424-.907-3.758-3.636-3.758a10.46 10.46 0 00-6.609 2.668v14.673zM29.134 7L0 23.808v40.361l10.946 6.32V30.127l18.188-10.504V7z" fill="#000"/><path d="M40.758 7v32.144H29.133V27.147l-10.945 6.319V74.65l10.946 6.335V48.932h11.624v11.914l10.946-6.312V13.32L40.758 7z" fill="#000"/><path d="M40.758 81L69.89 64.192V23.831l-10.946-6.32v40.362L40.758 68.377V81z" fill="#000"/></svg></div></a><span class="footer_themeSwitcher__CPJxw hds-font-weight-regular"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-178">Theme</label></span></span><ul class="footer_links__t81SU"><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="/hashicorp-consul/certifications"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Certifications</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://status.hashicorp.com"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">System Status</span></a></li><li><button class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Cookie Manager</span></button></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/terms-of-service"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Terms of Use</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/security"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Security</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/privacy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Privacy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trademark-policy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trademark Policy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trade-controls"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trade Controls</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="undefinedopens-in-new-tab-label-react-aria-186" target="_blank" href="https://forms.gle/fnHLuNahLEhjuKvE6"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Give Feedback</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-186">(opens in new tab)</span></li></ul></footer></div></div></div><div class="style_root__owpNH"></div><div style="position:fixed;z-index:99;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none;inset:24px"></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"layoutProps":{"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Consul","url":"/consul"},{"title":"CLI","url":"/consul/commands","isCurrentPage":false},{"title":"snapshot","url":"/consul/commands/snapshot"},{"title":"agent","url":"/consul/commands/snapshot/agent","isCurrentPage":true}],"sidebarNavDataLevels":[{"levelButtonProps":{"levelDownButtonText":"Consul Home"},"menuItems":[{"leadingIconName":"home","title":"HashiCorp Developer","href":"/"},{"leadingIconName":"guide","title":"Tutorials","href":"/tutorials"},{"divider":true},{"heading":"Products"},{"leadingIconName":"hcp","title":"HashiCorp Cloud Platform","href":"/hcp"},{"leadingIconName":"terraform","title":"Terraform","href":"/terraform"},{"leadingIconName":"packer","title":"Packer","href":"/packer"},{"leadingIconName":"consul","title":"Consul","href":"/consul"},{"leadingIconName":"vault","title":"Vault","href":"/vault"},{"leadingIconName":"boundary","title":"Boundary","href":"/boundary"},{"leadingIconName":"nomad","title":"Nomad","href":"/nomad"},{"leadingIconName":"waypoint","title":"Waypoint","href":"/waypoint"},{"leadingIconName":"vagrant","title":"Vagrant","href":"/vagrant"}],"showFilterInput":false,"title":"Main Menu"},{"levelButtonProps":{"levelUpButtonText":"Main Menu","levelDownButtonText":"Previous"},"menuItems":[{"title":"Consul","fullPath":"/consul","theme":"consul"},{"title":"Install","fullPath":"/consul/install"},{"title":"Tutorials","fullPath":"/consul/tutorials"},{"title":"Documentation","fullPath":"/consul/docs"},{"title":"API","fullPath":"/consul/api-docs"},{"title":"CLI","fullPath":"/consul/commands"}],"showFilterInput":false,"title":"Consul","visuallyHideTitle":true},{"backToLinkProps":{"text":"Consul Home","href":"/consul"},"levelButtonProps":{"levelUpButtonText":"Consul Home"},"menuItems":[{"title":"CLI","fullPath":"/consul/commands","theme":"consul"},{"title":"acl","routes":[{"title":"Overview","path":"acl","filePath":"../content/commands/acl/index.mdx","fullPath":"/consul/commands/acl","id":"sidebar-nav-item-2"},{"title":"auth-method","routes":[{"title":"Overview","path":"acl/auth-method","filePath":"../content/commands/acl/auth-method/index.mdx","fullPath":"/consul/commands/acl/auth-method","id":"sidebar-nav-item-4"},{"title":"create","path":"acl/auth-method/create","filePath":"../content/commands/acl/auth-method/create.mdx","fullPath":"/consul/commands/acl/auth-method/create","id":"sidebar-nav-item-5"},{"title":"delete","path":"acl/auth-method/delete","filePath":"../content/commands/acl/auth-method/delete.mdx","fullPath":"/consul/commands/acl/auth-method/delete","id":"sidebar-nav-item-6"},{"title":"list","path":"acl/auth-method/list","filePath":"../content/commands/acl/auth-method/list.mdx","fullPath":"/consul/commands/acl/auth-method/list","id":"sidebar-nav-item-7"},{"title":"read","path":"acl/auth-method/read","filePath":"../content/commands/acl/auth-method/read.mdx","fullPath":"/consul/commands/acl/auth-method/read","id":"sidebar-nav-item-8"},{"title":"update","path":"acl/auth-method/update","filePath":"../content/commands/acl/auth-method/update.mdx","fullPath":"/consul/commands/acl/auth-method/update","id":"sidebar-nav-item-9"}],"id":"sidebar-nav-item-3"},{"title":"binding-rule","routes":[{"title":"Overview","path":"acl/binding-rule","filePath":"../content/commands/acl/binding-rule/index.mdx","fullPath":"/consul/commands/acl/binding-rule","id":"sidebar-nav-item-11"},{"title":"create","path":"acl/binding-rule/create","filePath":"../content/commands/acl/binding-rule/create.mdx","fullPath":"/consul/commands/acl/binding-rule/create","id":"sidebar-nav-item-12"},{"title":"delete","path":"acl/binding-rule/delete","filePath":"../content/commands/acl/binding-rule/delete.mdx","fullPath":"/consul/commands/acl/binding-rule/delete","id":"sidebar-nav-item-13"},{"title":"list","path":"acl/binding-rule/list","filePath":"../content/commands/acl/binding-rule/list.mdx","fullPath":"/consul/commands/acl/binding-rule/list","id":"sidebar-nav-item-14"},{"title":"read","path":"acl/binding-rule/read","filePath":"../content/commands/acl/binding-rule/read.mdx","fullPath":"/consul/commands/acl/binding-rule/read","id":"sidebar-nav-item-15"},{"title":"update","path":"acl/binding-rule/update","filePath":"../content/commands/acl/binding-rule/update.mdx","fullPath":"/consul/commands/acl/binding-rule/update","id":"sidebar-nav-item-16"}],"id":"sidebar-nav-item-10"},{"title":"bootstrap","path":"acl/bootstrap","filePath":"../content/commands/acl/bootstrap.mdx","fullPath":"/consul/commands/acl/bootstrap","id":"sidebar-nav-item-17"},{"title":"policy","routes":[{"title":"Overview","path":"acl/policy","filePath":"../content/commands/acl/policy/index.mdx","fullPath":"/consul/commands/acl/policy","id":"sidebar-nav-item-19"},{"title":"create","path":"acl/policy/create","filePath":"../content/commands/acl/policy/create.mdx","fullPath":"/consul/commands/acl/policy/create","id":"sidebar-nav-item-20"},{"title":"delete","path":"acl/policy/delete","filePath":"../content/commands/acl/policy/delete.mdx","fullPath":"/consul/commands/acl/policy/delete","id":"sidebar-nav-item-21"},{"title":"list","path":"acl/policy/list","filePath":"../content/commands/acl/policy/list.mdx","fullPath":"/consul/commands/acl/policy/list","id":"sidebar-nav-item-22"},{"title":"read","path":"acl/policy/read","filePath":"../content/commands/acl/policy/read.mdx","fullPath":"/consul/commands/acl/policy/read","id":"sidebar-nav-item-23"},{"title":"update","path":"acl/policy/update","filePath":"../content/commands/acl/policy/update.mdx","fullPath":"/consul/commands/acl/policy/update","id":"sidebar-nav-item-24"}],"id":"sidebar-nav-item-18"},{"title":"templated policy","routes":[{"title":"Overview","path":"acl/templated-policy","filePath":"../content/commands/acl/templated-policy/index.mdx","fullPath":"/consul/commands/acl/templated-policy","id":"sidebar-nav-item-26"},{"title":"list","path":"acl/templated-policy/list","filePath":"../content/commands/acl/templated-policy/list.mdx","fullPath":"/consul/commands/acl/templated-policy/list","id":"sidebar-nav-item-27"},{"title":"preview","path":"acl/templated-policy/preview","filePath":"../content/commands/acl/templated-policy/preview.mdx","fullPath":"/consul/commands/acl/templated-policy/preview","id":"sidebar-nav-item-28"},{"title":"read","path":"acl/templated-policy/read","filePath":"../content/commands/acl/templated-policy/read.mdx","fullPath":"/consul/commands/acl/templated-policy/read","id":"sidebar-nav-item-29"}],"id":"sidebar-nav-item-25"},{"title":"role","routes":[{"title":"Overview","path":"acl/role","filePath":"../content/commands/acl/role/index.mdx","fullPath":"/consul/commands/acl/role","id":"sidebar-nav-item-31"},{"title":"create","path":"acl/role/create","filePath":"../content/commands/acl/role/create.mdx","fullPath":"/consul/commands/acl/role/create","id":"sidebar-nav-item-32"},{"title":"delete","path":"acl/role/delete","filePath":"../content/commands/acl/role/delete.mdx","fullPath":"/consul/commands/acl/role/delete","id":"sidebar-nav-item-33"},{"title":"list","path":"acl/role/list","filePath":"../content/commands/acl/role/list.mdx","fullPath":"/consul/commands/acl/role/list","id":"sidebar-nav-item-34"},{"title":"read","path":"acl/role/read","filePath":"../content/commands/acl/role/read.mdx","fullPath":"/consul/commands/acl/role/read","id":"sidebar-nav-item-35"},{"title":"update","path":"acl/role/update","filePath":"../content/commands/acl/role/update.mdx","fullPath":"/consul/commands/acl/role/update","id":"sidebar-nav-item-36"}],"id":"sidebar-nav-item-30"},{"title":"set-agent-token","path":"acl/set-agent-token","filePath":"../content/commands/acl/set-agent-token.mdx","fullPath":"/consul/commands/acl/set-agent-token","id":"sidebar-nav-item-37"},{"title":"token","routes":[{"title":"Overview","path":"acl/token","filePath":"../content/commands/acl/token/index.mdx","fullPath":"/consul/commands/acl/token","id":"sidebar-nav-item-39"},{"title":"clone","path":"acl/token/clone","filePath":"../content/commands/acl/token/clone.mdx","fullPath":"/consul/commands/acl/token/clone","id":"sidebar-nav-item-40"},{"title":"create","path":"acl/token/create","filePath":"../content/commands/acl/token/create.mdx","fullPath":"/consul/commands/acl/token/create","id":"sidebar-nav-item-41"},{"title":"delete","path":"acl/token/delete","filePath":"../content/commands/acl/token/delete.mdx","fullPath":"/consul/commands/acl/token/delete","id":"sidebar-nav-item-42"},{"title":"list","path":"acl/token/list","filePath":"../content/commands/acl/token/list.mdx","fullPath":"/consul/commands/acl/token/list","id":"sidebar-nav-item-43"},{"title":"read","path":"acl/token/read","filePath":"../content/commands/acl/token/read.mdx","fullPath":"/consul/commands/acl/token/read","id":"sidebar-nav-item-44"},{"title":"update","path":"acl/token/update","filePath":"../content/commands/acl/token/update.mdx","fullPath":"/consul/commands/acl/token/update","id":"sidebar-nav-item-45"}],"id":"sidebar-nav-item-38"}],"id":"sidebar-nav-item-1"},{"title":"agent","path":"agent","filePath":"../content/commands/agent.mdx","fullPath":"/consul/commands/agent","id":"sidebar-nav-item-46"},{"title":"catalog","routes":[{"title":"Overview","path":"catalog","filePath":"../content/commands/catalog/index.mdx","fullPath":"/consul/commands/catalog","id":"sidebar-nav-item-48"},{"title":"datacenters","path":"catalog/datacenters","filePath":"../content/commands/catalog/datacenters.mdx","fullPath":"/consul/commands/catalog/datacenters","id":"sidebar-nav-item-49"},{"title":"nodes","path":"catalog/nodes","filePath":"../content/commands/catalog/nodes.mdx","fullPath":"/consul/commands/catalog/nodes","id":"sidebar-nav-item-50"},{"title":"services","path":"catalog/services","filePath":"../content/commands/catalog/services.mdx","fullPath":"/consul/commands/catalog/services","id":"sidebar-nav-item-51"}],"id":"sidebar-nav-item-47"},{"title":"config","routes":[{"title":"Overview","path":"config","filePath":"../content/commands/config/index.mdx","fullPath":"/consul/commands/config","id":"sidebar-nav-item-53"},{"title":"delete","path":"config/delete","filePath":"../content/commands/config/delete.mdx","fullPath":"/consul/commands/config/delete","id":"sidebar-nav-item-54"},{"title":"list","path":"config/list","filePath":"../content/commands/config/list.mdx","fullPath":"/consul/commands/config/list","id":"sidebar-nav-item-55"},{"title":"read","path":"config/read","filePath":"../content/commands/config/read.mdx","fullPath":"/consul/commands/config/read","id":"sidebar-nav-item-56"},{"title":"write","path":"config/write","filePath":"../content/commands/config/write.mdx","fullPath":"/consul/commands/config/write","id":"sidebar-nav-item-57"}],"id":"sidebar-nav-item-52"},{"title":"connect","routes":[{"title":"Overview","path":"connect","filePath":"../content/commands/connect/index.mdx","fullPath":"/consul/commands/connect","id":"sidebar-nav-item-59"},{"title":"ca","path":"connect/ca","filePath":"../content/commands/connect/ca.mdx","fullPath":"/consul/commands/connect/ca","id":"sidebar-nav-item-60"},{"title":"proxy","path":"connect/proxy","filePath":"../content/commands/connect/proxy.mdx","fullPath":"/consul/commands/connect/proxy","id":"sidebar-nav-item-61"},{"title":"envoy","path":"connect/envoy","filePath":"../content/commands/connect/envoy.mdx","fullPath":"/consul/commands/connect/envoy","id":"sidebar-nav-item-62"},{"title":"expose","path":"connect/expose","filePath":"../content/commands/connect/expose.mdx","fullPath":"/consul/commands/connect/expose","id":"sidebar-nav-item-63"},{"title":"redirect-traffic","path":"connect/redirect-traffic","filePath":"../content/commands/connect/redirect-traffic.mdx","fullPath":"/consul/commands/connect/redirect-traffic","id":"sidebar-nav-item-64"}],"id":"sidebar-nav-item-58"},{"title":"debug","path":"debug","filePath":"../content/commands/debug.mdx","fullPath":"/consul/commands/debug","id":"sidebar-nav-item-65"},{"title":"event","path":"event","filePath":"../content/commands/event.mdx","fullPath":"/consul/commands/event","id":"sidebar-nav-item-66"},{"title":"exec","path":"exec","filePath":"../content/commands/exec.mdx","fullPath":"/consul/commands/exec","id":"sidebar-nav-item-67"},{"title":"force-leave","path":"force-leave","filePath":"../content/commands/force-leave.mdx","fullPath":"/consul/commands/force-leave","id":"sidebar-nav-item-68"},{"title":"info","path":"info","filePath":"../content/commands/info.mdx","fullPath":"/consul/commands/info","id":"sidebar-nav-item-69"},{"title":"intention","routes":[{"title":"Overview","path":"intention","filePath":"../content/commands/intention/index.mdx","fullPath":"/consul/commands/intention","id":"sidebar-nav-item-71"},{"title":"check","path":"intention/check","filePath":"../content/commands/intention/check.mdx","fullPath":"/consul/commands/intention/check","id":"sidebar-nav-item-72"},{"title":"create","path":"intention/create","filePath":"../content/commands/intention/create.mdx","fullPath":"/consul/commands/intention/create","id":"sidebar-nav-item-73"},{"title":"delete","path":"intention/delete","filePath":"../content/commands/intention/delete.mdx","fullPath":"/consul/commands/intention/delete","id":"sidebar-nav-item-74"},{"title":"get","path":"intention/get","filePath":"../content/commands/intention/get.mdx","fullPath":"/consul/commands/intention/get","id":"sidebar-nav-item-75"},{"title":"list","path":"intention/list","filePath":"../content/commands/intention/list.mdx","fullPath":"/consul/commands/intention/list","id":"sidebar-nav-item-76"},{"title":"match","path":"intention/match","filePath":"../content/commands/intention/match.mdx","fullPath":"/consul/commands/intention/match","id":"sidebar-nav-item-77"}],"id":"sidebar-nav-item-70"},{"title":"join","path":"join","filePath":"../content/commands/join.mdx","fullPath":"/consul/commands/join","id":"sidebar-nav-item-78"},{"title":"keygen","path":"keygen","filePath":"../content/commands/keygen.mdx","fullPath":"/consul/commands/keygen","id":"sidebar-nav-item-79"},{"title":"keyring","path":"keyring","filePath":"../content/commands/keyring.mdx","fullPath":"/consul/commands/keyring","id":"sidebar-nav-item-80"},{"title":"kv","routes":[{"title":"Overview","path":"kv","filePath":"../content/commands/kv/index.mdx","fullPath":"/consul/commands/kv","id":"sidebar-nav-item-82"},{"title":"delete","path":"kv/delete","filePath":"../content/commands/kv/delete.mdx","fullPath":"/consul/commands/kv/delete","id":"sidebar-nav-item-83"},{"title":"export","path":"kv/export","filePath":"../content/commands/kv/export.mdx","fullPath":"/consul/commands/kv/export","id":"sidebar-nav-item-84"},{"title":"get","path":"kv/get","filePath":"../content/commands/kv/get.mdx","fullPath":"/consul/commands/kv/get","id":"sidebar-nav-item-85"},{"title":"import","path":"kv/import","filePath":"../content/commands/kv/import.mdx","fullPath":"/consul/commands/kv/import","id":"sidebar-nav-item-86"},{"title":"put","path":"kv/put","filePath":"../content/commands/kv/put.mdx","fullPath":"/consul/commands/kv/put","id":"sidebar-nav-item-87"}],"id":"sidebar-nav-item-81"},{"title":"leave","path":"leave","filePath":"../content/commands/leave.mdx","fullPath":"/consul/commands/leave","id":"sidebar-nav-item-88"},{"title":"license","path":"license","filePath":"../content/commands/license.mdx","fullPath":"/consul/commands/license","id":"sidebar-nav-item-89"},{"title":"lock","path":"lock","filePath":"../content/commands/lock.mdx","fullPath":"/consul/commands/lock","id":"sidebar-nav-item-90"},{"title":"login","path":"login","filePath":"../content/commands/login.mdx","fullPath":"/consul/commands/login","id":"sidebar-nav-item-91"},{"title":"logout","path":"logout","filePath":"../content/commands/logout.mdx","fullPath":"/consul/commands/logout","id":"sidebar-nav-item-92"},{"title":"maint","path":"maint","filePath":"../content/commands/maint.mdx","fullPath":"/consul/commands/maint","id":"sidebar-nav-item-93"},{"title":"members","path":"members","filePath":"../content/commands/members.mdx","fullPath":"/consul/commands/members","id":"sidebar-nav-item-94"},{"title":"monitor","path":"monitor","filePath":"../content/commands/monitor.mdx","fullPath":"/consul/commands/monitor","id":"sidebar-nav-item-95"},{"title":"namespace","routes":[{"title":"Overview","path":"namespace","filePath":"../content/commands/namespace/index.mdx","fullPath":"/consul/commands/namespace","id":"sidebar-nav-item-97"},{"title":"create","path":"namespace/create","filePath":"../content/commands/namespace/create.mdx","fullPath":"/consul/commands/namespace/create","id":"sidebar-nav-item-98"},{"title":"delete","path":"namespace/delete","filePath":"../content/commands/namespace/delete.mdx","fullPath":"/consul/commands/namespace/delete","id":"sidebar-nav-item-99"},{"title":"list","path":"namespace/list","filePath":"../content/commands/namespace/list.mdx","fullPath":"/consul/commands/namespace/list","id":"sidebar-nav-item-100"},{"title":"read","path":"namespace/read","filePath":"../content/commands/namespace/read.mdx","fullPath":"/consul/commands/namespace/read","id":"sidebar-nav-item-101"},{"title":"update","path":"namespace/update","filePath":"../content/commands/namespace/update.mdx","fullPath":"/consul/commands/namespace/update","id":"sidebar-nav-item-102"},{"title":"write","path":"namespace/write","filePath":"../content/commands/namespace/write.mdx","fullPath":"/consul/commands/namespace/write","id":"sidebar-nav-item-103"}],"id":"sidebar-nav-item-96"},{"title":"operator","routes":[{"title":"Overview","path":"operator","filePath":"../content/commands/operator/index.mdx","fullPath":"/consul/commands/operator","id":"sidebar-nav-item-105"},{"title":"area","path":"operator/area","filePath":"../content/commands/operator/area.mdx","fullPath":"/consul/commands/operator/area","id":"sidebar-nav-item-106"},{"title":"autopilot","path":"operator/autopilot","filePath":"../content/commands/operator/autopilot.mdx","fullPath":"/consul/commands/operator/autopilot","id":"sidebar-nav-item-107"},{"title":"raft","path":"operator/raft","filePath":"../content/commands/operator/raft.mdx","fullPath":"/consul/commands/operator/raft","id":"sidebar-nav-item-108"},{"title":"usage","path":"operator/usage","filePath":"../content/commands/operator/usage.mdx","fullPath":"/consul/commands/operator/usage","id":"sidebar-nav-item-109"}],"id":"sidebar-nav-item-104"},{"title":"partition","path":"partition","filePath":"../content/commands/partition.mdx","fullPath":"/consul/commands/partition","id":"sidebar-nav-item-110"},{"title":"peering","routes":[{"title":"Overview","path":"peering","filePath":"../content/commands/peering/index.mdx","fullPath":"/consul/commands/peering","id":"sidebar-nav-item-112"},{"title":"delete","path":"peering/delete","filePath":"../content/commands/peering/delete.mdx","fullPath":"/consul/commands/peering/delete","id":"sidebar-nav-item-113"},{"title":"establish","path":"peering/establish","filePath":"../content/commands/peering/establish.mdx","fullPath":"/consul/commands/peering/establish","id":"sidebar-nav-item-114"},{"title":"exported-services","path":"peering/exported-services","filePath":"../content/commands/peering/exported-services.mdx","fullPath":"/consul/commands/peering/exported-services","id":"sidebar-nav-item-115"},{"title":"generate-token","path":"peering/generate-token","filePath":"../content/commands/peering/generate-token.mdx","fullPath":"/consul/commands/peering/generate-token","id":"sidebar-nav-item-116"},{"title":"list","path":"peering/list","filePath":"../content/commands/peering/list.mdx","fullPath":"/consul/commands/peering/list","id":"sidebar-nav-item-117"},{"title":"read","path":"peering/read","filePath":"../content/commands/peering/read.mdx","fullPath":"/consul/commands/peering/read","id":"sidebar-nav-item-118"}],"id":"sidebar-nav-item-111"},{"title":"reload","path":"reload","filePath":"../content/commands/reload.mdx","fullPath":"/consul/commands/reload","id":"sidebar-nav-item-119"},{"title":"resource","path":"resource","badge":{"text":"v2","type":"outlined","color":"neutral"},"filePath":"../content/commands/resource.mdx","fullPath":"/consul/commands/resource","id":"sidebar-nav-item-120"},{"title":"rtt","path":"rtt","filePath":"../content/commands/rtt.mdx","fullPath":"/consul/commands/rtt","id":"sidebar-nav-item-121"},{"title":"services","routes":[{"title":"Overview","path":"services","filePath":"../content/commands/services/index.mdx","fullPath":"/consul/commands/services","id":"sidebar-nav-item-123"},{"title":"register","path":"services/register","filePath":"../content/commands/services/register.mdx","fullPath":"/consul/commands/services/register","id":"sidebar-nav-item-124"},{"title":"deregister","path":"services/deregister","filePath":"../content/commands/services/deregister.mdx","fullPath":"/consul/commands/services/deregister","id":"sidebar-nav-item-125"},{"title":"export","path":"services/export","filePath":"../content/commands/services/export.mdx","fullPath":"/consul/commands/services/export","id":"sidebar-nav-item-126"},{"title":"exported-services","path":"services/exported-services","filePath":"../content/commands/services/exported-services.mdx","fullPath":"/consul/commands/services/exported-services","id":"sidebar-nav-item-127"}],"id":"sidebar-nav-item-122"},{"title":"snapshot","routes":[{"title":"Overview","path":"snapshot","filePath":"../content/commands/snapshot/index.mdx","fullPath":"/consul/commands/snapshot","id":"sidebar-nav-item-129"},{"title":"agent","path":"snapshot/agent","filePath":"../content/commands/snapshot/agent.mdx","fullPath":"/consul/commands/snapshot/agent","id":"sidebar-nav-item-130"},{"title":"inspect","path":"snapshot/inspect","filePath":"../content/commands/snapshot/inspect.mdx","fullPath":"/consul/commands/snapshot/inspect","id":"sidebar-nav-item-131"},{"title":"restore","path":"snapshot/restore","filePath":"../content/commands/snapshot/restore.mdx","fullPath":"/consul/commands/snapshot/restore","id":"sidebar-nav-item-132"},{"title":"save","path":"snapshot/save","filePath":"../content/commands/snapshot/save.mdx","fullPath":"/consul/commands/snapshot/save","id":"sidebar-nav-item-133"}],"id":"sidebar-nav-item-128"},{"title":"tls","routes":[{"title":"Overview","path":"tls","filePath":"../content/commands/tls/index.mdx","fullPath":"/consul/commands/tls","id":"sidebar-nav-item-135"},{"title":"ca","path":"tls/ca","filePath":"../content/commands/tls/ca.mdx","fullPath":"/consul/commands/tls/ca","id":"sidebar-nav-item-136"},{"title":"cert","path":"tls/cert","filePath":"../content/commands/tls/cert.mdx","fullPath":"/consul/commands/tls/cert","id":"sidebar-nav-item-137"}],"id":"sidebar-nav-item-134"},{"title":"troubleshoot","routes":[{"title":"Overview","path":"troubleshoot","filePath":"../content/commands/troubleshoot/index.mdx","fullPath":"/consul/commands/troubleshoot","id":"sidebar-nav-item-139"},{"title":"upstreams","path":"troubleshoot/upstreams","filePath":"../content/commands/troubleshoot/upstreams.mdx","fullPath":"/consul/commands/troubleshoot/upstreams","id":"sidebar-nav-item-140"},{"title":"proxy","path":"troubleshoot/proxy","filePath":"../content/commands/troubleshoot/proxy.mdx","fullPath":"/consul/commands/troubleshoot/proxy","id":"sidebar-nav-item-141"},{"title":"ports","path":"troubleshoot/ports","filePath":"../content/commands/troubleshoot/ports.mdx","fullPath":"/consul/commands/troubleshoot/ports","id":"sidebar-nav-item-142"}],"id":"sidebar-nav-item-138"},{"title":"validate","path":"validate","filePath":"../content/commands/validate.mdx","fullPath":"/consul/commands/validate","id":"sidebar-nav-item-143"},{"title":"version","path":"version","filePath":"../content/commands/version.mdx","fullPath":"/consul/commands/version","id":"sidebar-nav-item-144"},{"title":"watch","path":"watch","filePath":"../content/commands/watch.mdx","fullPath":"/consul/commands/watch","id":"sidebar-nav-item-145"}],"title":"CLI","visuallyHideTitle":true}],"mainWidth":"narrow","githubFileUrl":"https://github.com/hashicorp/consul/blob/main/website/../content/commands/snapshot/agent.mdx"},"metadata":{"title":"Commands: Snapshot Agent","description":"The `consul snapshot agent` command starts a process that takes snapshots of the state of the Consul servers in Consul Enterprise. It can capture server state once or it can run as daemon that captures snapshots at defined intervals.\n","layout":null},"outlineItems":[{"title":"Consul Snapshot Agent","url":"#consul-snapshot-agent","dataHeapTrack":"toc-list-item-index-0"},{"title":"ACL permissions","url":"#acl-permissions","dataHeapTrack":"toc-list-item-index-1"},{"title":"Usage","url":"#usage","dataHeapTrack":"toc-list-item-index-2"},{"title":"Examples","url":"#examples","dataHeapTrack":"toc-list-item-index-3"},{"title":"Licensing","url":"#licensing","dataHeapTrack":"toc-list-item-index-4"}],"pageHeading":{"id":"consul-snapshot-agent","title":"Consul Snapshot Agent"},"mdxSource":{"compiledSource":"var c=Object.defineProperty,d=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;var r=(a,n,t)=\u003en in a?c(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,e=(a,n)=\u003e{for(var t in n||(n={}))p.call(n,t)\u0026\u0026r(a,t,n[t]);if(o)for(var t of o(n))i.call(n,t)\u0026\u0026r(a,t,n[t]);return a},l=(a,n)=\u003ed(a,N(n));var m=(a,n)=\u003e{var t={};for(var s in a)p.call(a,s)\u0026\u0026n.indexOf(s)\u003c0\u0026\u0026(t[s]=a[s]);if(a!=null\u0026\u0026o)for(var s of o(a))n.indexOf(s)\u003c0\u0026\u0026i.call(a,s)\u0026\u0026(t[s]=a[s]);return t};const makeShortcode=a=\u003efunction(t){return console.warn(\"Component \"+a+\" was not imported, exported, or provided by MDXProvider as global scope\"),mdx(\"div\",e({},t))},EnterpriseAlert=makeShortcode(\"EnterpriseAlert\"),CodeTabs=makeShortcode(\"CodeTabs\"),layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:a}=s,n=m(s,[\"components\"]);return mdx(MDXLayout,l(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(\"p\",null,\"Command: \",mdx(\"inlineCode\",{parentName:\"p\"},\"consul snapshot agent\")),mdx(EnterpriseAlert,{mdxType:\"EnterpriseAlert\"}),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\"}),mdx(\"p\",{parentName:\"div\"},\"The \",mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/commands/snapshot/agent\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"agent\")),` subcommand described here is\navailable only in `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.hashicorp.com/products/consul/\"}),\"Consul Enterprise\"),`\nversion 0.7.1 and later. All other `,mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/commands/snapshot\"}),\"snapshot subcommands\"),`\nare available in the community edition of Consul.`)),mdx(\"p\",null,\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot agent\"),` subcommand starts a process that takes snapshots of the\nstate of the Consul servers and saves them locally, or pushes them to an\noptional remote storage service.`),mdx(\"p\",null,`The agent can be run as a long-running daemon process or in a one-shot mode\nfrom a batch job, based on the `,mdx(\"a\",e({parentName:\"p\"},{href:\"#interval\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-interval\")),` argument. Snapshotting\na remote datacenter is only available in one-shot mode.`),mdx(\"p\",null,`As a long-running daemon, the agent will perform a leader election so multiple\nprocesses can be run in a highly available fashion with automatic failover. The\nagent will also register itself with Consul as a service, along with health\nchecks that show the agent is alive (\"Consul Snapshot Agent Alive\") and able to\ntake snapshots (\"Consul Snapshot Agent Saving Snapshots\"). The latter check is\nonly added on agents who have become a leader, so it's possible for operators to\ntell which instances are alive and on standby and which instance has become\nleader and starting saving snapshots.`),mdx(\"p\",null,\"As snapshots are saved, they will be reported in the log produced by the agent:\"),mdx(\"pre\",e({},{className:\"language-log\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-log\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token date number\"}),\"2016/11/16\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token time number\"}),\"21:21:13\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token level info keyword\"}),\"INFO\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" Snapshot agent running\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token date number\"}),\"2016/11/16\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token time number\"}),\"21:21:13\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token level info keyword\"}),\"INFO\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" Waiting to obtain leadership\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token date number\"}),\"2016/11/16\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token time number\"}),\"21:21:13\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token level info keyword\"}),\"INFO\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" Obtained leadership\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token date number\"}),\"2016/11/16\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token time number\"}),\"21:21:13\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token level info keyword\"}),\"INFO\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" Saved snapshot \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"1479360073448728784\"),`\n`)),mdx(\"p\",null,`The number shown with the saved snapshot is its ID, which is based on a UNIX\ntimestamp with nanosecond resolution, so collisions are unlikely and IDs are\nmonotonically increasing with time. This makes it easy to locate the latest\nsnapshot, even if the log data isn't available. The snapshot ID always appears\nin the file name when using local storage, or in the object key when using\nremote storage.`),mdx(\"p\",null,`Snapshots can be restored using the\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/commands/snapshot/restore\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"consul snapshot restore\")),` command, or\nthe `,mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/api-docs/snapshot\"}),\"HTTP API\"),\".\"),mdx(\"h2\",e({},{id:\"acl-permissions\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#acl-permissions\",\"aria-label\":\"acl permissions permalink\"}),\"\\xBB\"),\"ACL permissions\"),mdx(\"p\",null,\"If ACLs are enabled the following privileges are required:\"),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Resource\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Segment\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Permission\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Explanation\"))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"acl\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"N/A\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"write\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"All snapshotting operations require this privilege due to snapshots containing ACL tokens including unredacted secrets.\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"key\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"\u003clock key\u003e\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"write\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"The lock key (which defaults to \",mdx(\"inlineCode\",{parentName:\"td\"},\"consul-snapshot/lock\"),\") is used during snapshot agent leader election.\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"session\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"\u003cagent name\u003e\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"write\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"The session used for locking during leader election is created against the agent name of the Consul agent that the Snapshot agent is registering itself with.\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"service\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"\u003cservice name\u003e\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"write\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"The Snapshot agent registers itself with the local Consul agent and must have write privileges on its service name which is configured with \",mdx(\"inlineCode\",{parentName:\"td\"},\"-service\"),\".\")))),mdx(\"h3\",e({},{id:\"example-acl-policy\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#example-acl-policy\",\"aria-label\":\"example acl policy permalink\"}),\"\\xBB\"),\"Example ACL policy\"),mdx(\"p\",null,`The following is a example least privilege policy which allows the snapshot agent\nto run on a node named `,mdx(\"inlineCode\",{parentName:\"p\"},\"server-1234\"),\".\"),mdx(CodeTabs,{mdxType:\"CodeTabs\"},mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Required to read and snapshot ACL data\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"acl\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Allow the snapshot agent to create the key consul-snapshot/lock which will\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# serve as a leader election lock when multiple snapshot agents are running in\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# an environment\"),`\n`,\"key \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"consul-snapshot/lock\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"policy\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Allow the snapshot agent to create sessions on the specified node\"),`\n`,\"session \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"server-1234\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"policy\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Allow the snapshot agent to register itself into the catalog\"),`\n`,\"service \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"consul-snapshot\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"policy\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"pre\",e({},{className:\"language-json\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"acl\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"key\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"consul-snapshot/lock\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"policy\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"session\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"server-1234\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"policy\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"service\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"consul-snapshot\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"policy\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`))),mdx(\"p\",null,\"Additional \",mdx(\"inlineCode\",{parentName:\"p\"},\"session\"),\" rules should be created, or \",mdx(\"inlineCode\",{parentName:\"p\"},\"session_prefix\"),` used, if the\nsnapshot agent is deployed across more than one host.`),mdx(\"h2\",e({},{id:\"usage\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#usage\",\"aria-label\":\"usage permalink\"}),\"\\xBB\"),\"Usage\"),mdx(\"p\",null,\"Usage: \",mdx(\"inlineCode\",{parentName:\"p\"},\"consul snapshot agent [options]\")),mdx(\"h4\",e({},{id:\"config-file-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#config-file-options\",\"aria-label\":\"config file options permalink\"}),\"\\xBB\"),\"Config File Options\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"config-dir\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#config-dir\",\"aria-label\":\"config dir permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-config-dir\")),` - Directory to look for JSON config files. Files will be read in\nalphabetical order and must end with the extension \".json\". This won't\nrecursively descend directories. This can be specified multiple times on the\ncommand line.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"config-file\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#config-file\",\"aria-label\":\"config file permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-config-file\")),` - File to read JSON configuration from. Files must end with the\nextension \".json\". This can be specified multiple times on the command line.`),mdx(\"p\",{parentName:\"li\"},\"Config files referenced using \",mdx(\"inlineCode\",{parentName:\"p\"},\"-config-dir\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"-config-file\"),` have the following\nformat (shown populated with default values):`))),mdx(\"pre\",e({},{className:\"language-json\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"snapshot_agent\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"http_addr\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"127.0.0.1:8500\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"token\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"datacenter\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"ca_file\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"ca_path\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"cert_file\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"key_file\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"license_path\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"tls_server_name\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"login\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"auth_method\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"bearer_token\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"bearer_token_file\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"meta\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"log\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"level\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"INFO\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"enable_syslog\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"false\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"syslog_facility\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"LOCAL0\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"snapshot\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"interval\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"1h\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"retain\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"30\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"stale\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"false\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"service\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"consul-snapshot\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"deregister_after\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"72h\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"lock_key\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"consul-snapshot/lock\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"max_failures\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"3\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"local_scratch_path\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"local_storage\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"path\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\".\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"aws_storage\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"access_key_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"secret_access_key\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"session_token\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"iam_endpoint\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"role_arn\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"role_session_name\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"web_identity_token_file\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"sts_endpoint\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"s3_region\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"s3_bucket\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"s3_key_prefix\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"consul-snapshot\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"s3_server_side_encryption\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"false\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"s3_static_snapshot_name\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"s3_force_path_style\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"false\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"azure_blob_storage\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"account_name\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"account_key\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"container_name\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"google_storage\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"bucket\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"All fields are optional, and config files without a \",mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot_agent\"),` object will\nbe ignored. At least one config file needs to have a `,mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot_agent\"),` object, or the\nsnapshot agent will fail to start. The Consul agent is set up to ignore any\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot_agent\"),` object, so it's safe to use common config directories for both agents\nif desired.`),mdx(\"h4\",e({},{id:\"snapshot-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#snapshot-options\",\"aria-label\":\"snapshot options permalink\"}),\"\\xBB\"),\"Snapshot Options\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"interval\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#interval\",\"aria-label\":\"interval permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-interval\")),` - Interval at which to perform snapshots as\na time with a unit suffix, which can be \"s\", \"m\", \"h\" for seconds, minutes, or\nhours. If 0 is provided, the agent will take a single snapshot and then exit, which\nis useful for running snapshots via batch jobs. Defaults to \"1h\"`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"lock-key\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#lock-key\",\"aria-label\":\"lock key permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-lock-key\")),` - A prefix in Consul's KV store used to coordinate between\ndifferent instances of the snapshot agent in order to only have one active instance\nat a time. For highly available operation of the snapshot agent, simply run\nmultiple instances. All instances must be configured with the same lock key in\norder to properly coordinate. Defaults to \"consul-snapshot/lock\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"max-failures\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#max-failures\",\"aria-label\":\"max failures permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-max-failures\")),` - Number of snapshot failures after which the snapshot agent\nwill give up leadership. In a highly available operation with multiple snapshot\nagents available, this gives another agent a chance to take over if an agent\nis experiencing issues, such as running out of disk space for snapshots.\nDefaults to 3.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"retain\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#retain\",\"aria-label\":\"retain permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-retain\")),` - Number of snapshots to retain. After each snapshot is taken, the\noldest snapshots will start to be deleted in order to retain at most this many\nsnapshots. If this is set to 0, the agent will not perform this and snapshots\nwill accumulate forever. Defaults to 30.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"local-scratch-path\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#local-scratch-path\",\"aria-label\":\"local scratch path permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-local-scratch-path\")),` - Location to store all temporary snapshots in prior to\nsending them off to the configured storage backend. If not configured the\nsystem temporary directory will be used. When using the local storage backend\nthis is not configurable and `,mdx(\"inlineCode\",{parentName:\"p\"},\"-local-path\"),\" will be used.\"))),mdx(\"h4\",e({},{id:\"agent-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#agent-options\",\"aria-label\":\"agent options permalink\"}),\"\\xBB\"),\"Agent Options\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"deregister-after\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#deregister-after\",\"aria-label\":\"deregister after permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-deregister-after\")),` - An interval, after which if the agent is unhealthy it will be\nautomatically deregistered from Consul service discovery. This is a time with a\nunit suffix, which can be \"s\", \"m\", \"h\" for seconds, minutes, or hours. If 0 is\nprovided, this will be disabled. Defaults to \"72h\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"log-level\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#log-level\",\"aria-label\":\"log level permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-log-level\")),` - Controls verbosity of snapshot agent logs. Valid options are\n\"trace\", \"debug\", \"info\", \"warn\", \"error\". Defaults to \"info\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"service\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#service\",\"aria-label\":\"service permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-service\")),` - The service name to use when registering the agent with Consul.\nRegistering helps monitor running agents and the leader registers an additional\nhealth check to monitor that snapshots are taking place. Defaults to\n\"consul-snapshot\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"syslog\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#syslog\",\"aria-label\":\"syslog permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-syslog\")),\" - This enables forwarding logs to syslog. Defaults to false.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"syslog-facility\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#syslog-facility\",\"aria-label\":\"syslog facility permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-syslog-facility\")),` - Sets the facility to use for forwarding logs to syslog.\nDefaults to \"LOCAL0\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"login-auth-method\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#login-auth-method\",\"aria-label\":\"login auth method permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"login-auth-method\")),` - Auth method name to use to log into Consul. If provided, the token obtained with this auth method\nwill be used instead of a static token if it is provided. Currently, only `,mdx(\"inlineCode\",{parentName:\"p\"},\"kubernetes\"),\" auth method type is supported.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"login-bearer-token\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#login-bearer-token\",\"aria-label\":\"login bearer token permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"login-bearer-token\")),\" - Bearer token to use to log into Consul. Used only if \",mdx(\"inlineCode\",{parentName:\"p\"},\"-login-auth-method\"),\" is set.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"login-bearer-token-file\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#login-bearer-token-file\",\"aria-label\":\"login bearer token file permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"login-bearer-token-file\")),` - A file container bearer token to use for logging into Consul.\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"-login-bearer-token\"),\" is ignored if this flag is provided.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"login-meta\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#login-meta\",\"aria-label\":\"login meta permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"login-meta\")),\" - Metadata to set on the token, formatted as key=value. This flag may be provided multiple times.\"))),mdx(\"h4\",e({},{id:\"local-storage-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#local-storage-options\",\"aria-label\":\"local storage options permalink\"}),\"\\xBB\"),\"Local Storage Options\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"local-path\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#local-path\",\"aria-label\":\"local path permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-local-path\")),` - Location to store snapshots locally. The default behavior\nof the snapshot agent is to store snapshots locally in this directory. Defaults\nto \".\" to use the current working directory. If an alternate storage option is\nconfigured, then local storage will be disabled and this option will be ignored.`)),mdx(\"h4\",e({},{id:\"s3-storage-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#s3-storage-options\",\"aria-label\":\"s3 storage options permalink\"}),\"\\xBB\"),\"S3 Storage Options\"),mdx(\"p\",null,\"Note that despite the AWS references, any S3-compatible endpoint can be specified with \",mdx(\"inlineCode\",{parentName:\"p\"},\"-aws-s3-endpoint\"),\".\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-access-key-id\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-access-key-id\",\"aria-label\":\"aws access key id permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-access-key-id\")),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"-aws-secret-access-key\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"-aws-session-token\"),` - These arguments supply static\nauthentication information for connecting to S3. These may also be supplied using\nthe following alternative methods:`,mdx(\"br\",null)),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws_access_key_id\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#aws_access_key_id\",\"aria-label\":\"aws_access_key_id permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"AWS_ACCESS_KEY_ID\")),\", \",mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_SECRET_ACCESS_KEY\"),\" and \",mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_SESSION_TOKEN\"),\" environment variables\"),mdx(\"li\",{parentName:\"ul\"},\"A credentials file (\",mdx(\"inlineCode\",{parentName:\"li\"},\"~/.aws/credentials\"),` or the file at the path specified by the\n`,mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_SHARED_CREDENTIALS_FILE\"),\" environment variable)\"),mdx(\"li\",{parentName:\"ul\"},\"ECS task role metadata (container-specific)\"),mdx(\"li\",{parentName:\"ul\"},\"EC2 instance role metadata\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-iam-endpoint\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-iam-endpoint\",\"aria-label\":\"aws iam endpoint permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-iam-endpoint\")),` - IAM endpoint to use when authenticating with static credentials.\nDefault is to use the global IAM endpoint.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-role-arn\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-role-arn\",\"aria-label\":\"aws role arn permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-role-arn\")),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"-aws-role-session-name\"),\", and \",mdx(\"inlineCode\",{parentName:\"p\"},\"-aws-web-identity-token-file\"),` - These arguments are\nused to obtain temporary credentials by assuming an IAM role. These may also be supplied using\nthe following alternative methods:`,mdx(\"br\",null)),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws_role_arn\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#aws_role_arn\",\"aria-label\":\"aws_role_arn permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"AWS_ROLE_ARN\")),\", \",mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_ROLE_SESSION_NAME\"),\", and \",mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_WEB_IDENTITY_TOKEN_FILE\"),\" environment variables.\"),mdx(\"li\",{parentName:\"ul\"},`A credentials file (~/.aws/credentials or the file at the path specified by the\n`,mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_SHARED_CREDENTIALS_FILE\"),\" environment variable)\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-sts-endpoint\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-sts-endpoint\",\"aria-label\":\"aws sts endpoint permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-sts-endpoint\")),` - STS endpoint to use for obtaining temporary credentials.\nDefault is to use the global STS endpoint.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-bucket\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-bucket\",\"aria-label\":\"aws s3 bucket permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-bucket\")),` - S3 bucket to use. Required for S3 storage, and setting this\ndisables local storage. This should be only the bucket name without any\npart of the key prefix.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-key-prefix\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-key-prefix\",\"aria-label\":\"aws s3 key prefix permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-key-prefix\")),` - Prefix to use for snapshot files in S3. Defaults to\n\"consul-snapshot\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-region\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-region\",\"aria-label\":\"aws s3 region permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-region\")),\" - S3 region to use. Required for S3 storage.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-endpoint\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-endpoint\",\"aria-label\":\"aws s3 endpoint permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-endpoint\")),` - S3 endpoint to use. Can also be specified using the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"AWS_S3_ENDPOINT\"),\" environment variable. Defaults to the regional S3 endpoint.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-server-side-encryption\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-server-side-encryption\",\"aria-label\":\"aws s3 server side encryption permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-server-side-encryption\")),\" - Enables saving snapshots to S3 using server side encryption with \",mdx(\"a\",e({parentName:\"p\"},{href:\"http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingServerSideEncryption.html\"}),\"Amazon S3-Managed Encryption Keys\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-static-snapshot-name\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-static-snapshot-name\",\"aria-label\":\"aws s3 static snapshot name permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-static-snapshot-name\")),` - If this is given, all snapshots are saved with the same file name. The agent will not rotate or version snapshots, and will save them with the same name each time.\nUse this if you want to rely on `,mdx(\"a\",e({parentName:\"p\"},{href:\"http://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html\"}),\"S3's versioning capabilities\"),\" instead of the agent handling it for you.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-force-path-style\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-force-path-style\",\"aria-label\":\"aws s3 force path style permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-force-path-style\")),` - Enables the use of legacy path-based addressing instead of virtual addressing. This flag is required by minio\nand other 3rd party S3 compatible object storage platforms where DNS or TLS requirements for virtual addressing are prohibitive.\nFor more information, refer to the AWS documentation on `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-bucket-intro.html\"}),\"Methods for accessing a bucket\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-enable-kms\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-enable-kms\",\"aria-label\":\"aws s3 enable kms permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-enable-kms\")),\" - Enables using \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://aws.amazon.com/kms/\"}),\"Amazon KMS\"),\" for encrypting snapshots.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-kms-key\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-kms-key\",\"aria-label\":\"aws s3 kms key permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-kms-key\")),\" - Optional Amazon KMS key to use, if this is not set the default KMS master key will be used. Set this if you want to manage key rotation yourself.\"),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-info g-type-body\"}),mdx(\"p\",{parentName:\"div\"},`When using a S3-compatible storage exposing a self-signed certificate the agent will not be able to perform\nthe snapshot operations unless the CA used to sign the storage certificate is trusted by the node running\nthe agent. You can add the CA root certificate to the OS trust store to have Consul trust the storage endpoint.`)))),mdx(\"h4\",e({},{id:\"s3-required-permissions\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#s3-required-permissions\",\"aria-label\":\"s3 required permissions permalink\"}),\"\\xBB\"),\"S3 Required Permissions\"),mdx(\"p\",null,`Different S3 permissions are required depending on the configuration of the snapshot agent. In particular extra permissions are required when\nsnapshot rotation is enabled. S3 storage snapshot rotation is enabled when the `,mdx(\"inlineCode\",{parentName:\"p\"},\"retain\"),` configuration is greater than 0 and when there is\nno `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws-s3-static-snapshot-name\"),\" configured.\"),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Permission\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Resource\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"When you need it\"))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"PutObject\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"arn:aws:s3:::\u003cbucket name\u003e/\u003ckey\u003e\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Required for all operations.\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"DeleteObject\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"arn:aws:s3:::\u003cbucket name\u003e/\u003ckey\u003e\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Required only when snapshot rotation is enabled\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"ListBucket\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"arn:aws:s3:::\u003cbucket name\u003e\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Required only when snapshot rotation is enabled\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"ListBucketVersions\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"arn:aws:s3:::\u003cbucket name\u003e\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Required only when snapshot rotation is enabled\")))),mdx(\"p\",null,\"Within the table \",mdx(\"inlineCode\",{parentName:\"p\"},\"\u003ckey\u003e\"),\" refers to the key used to store the snapshot. When \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws-s3-static-snapshot-name\"),\" is configured the \",mdx(\"inlineCode\",{parentName:\"p\"},\"\u003ckey\u003e\"),\" is simply the value of that configuration. Otherwise the \",mdx(\"inlineCode\",{parentName:\"p\"},\"\u003ckey\u003e\"),\" will be the \",mdx(\"inlineCode\",{parentName:\"p\"},\"\u003caws-s3-key-prefix configuration\u003e/consul-*.snap\"),\".\"),mdx(\"p\",null,\"The following example IAM policy document assumes that the \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws-s3-bucket\"),\" is \",mdx(\"inlineCode\",{parentName:\"p\"},\"consul-data\"),\" with defaults for \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws-s3-key-prefix\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws-s3-static-snapshot-name\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"retain\"),\":\"),mdx(\"pre\",e({},{className:\"language-json\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Version\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"2012-10-17\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Statement\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Sid\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Effect\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Allow\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Action\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"s3:PutObject\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"s3:DeleteObject\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Resource\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"arn:aws:s3:::consul-data/consul-snapshots/consul-*.snap\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Sid\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Effect\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Allow\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Action\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"s3:ListBucketVersions\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"s3:ListBucket\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Resource\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"arn:aws:s3:::consul-data\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h4\",e({},{id:\"azure-blob-storage-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#azure-blob-storage-options\",\"aria-label\":\"azure blob storage options permalink\"}),\"\\xBB\"),\"Azure Blob Storage options\"),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\" Note: This currently only works on non-Solaris platforms due to library limitations \")),mdx(\"p\",null,\"From Consul Enterprise version \",mdx(\"inlineCode\",{parentName:\"p\"},\"1.5.0\"),\" onwards, you can store snapshots in Azure Blob storage.\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"azure-blob-account-name\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#azure-blob-account-name\",\"aria-label\":\"azure blob account name permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-azure-blob-account-name\")),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"-azure-blob-account-key\"),` - These arguments supply\nauthentication information for connecting to Azure Blob storage.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"azure-blob-container-name\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#azure-blob-container-name\",\"aria-label\":\"azure blob container name permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-azure-blob-container-name\")),` - Container to use. Required for Azure blob storage, and setting this\ndisables local storage.`))),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"azure-blob-environment\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#azure-blob-environment\",\"aria-label\":\"azure blob environment permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-azure-blob-environment\")),` - Environment to use. Defaults to AZUREPUBLICCLOUD. Other valid environments\nare AZURECHINACLOUD, AZUREGERMANCLOUD and AZUREUSGOVERNMENTCLOUD. Introduced in Consul 1.7.3.`)),mdx(\"h4\",e({},{id:\"google-cloud-storage-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#google-cloud-storage-options\",\"aria-label\":\"google cloud storage options permalink\"}),\"\\xBB\"),\"Google Cloud Storage options\"),mdx(\"p\",null,\"From Consul Enterprise version \",mdx(\"inlineCode\",{parentName:\"p\"},\"1.6.1\"),\" onwards, you can store snapshots in Google Cloud Storage. Authentication relies on automatic discovery through the sdk as described \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cloud.google.com/docs/authentication/production\"}),\"here\"),\":\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"First, ADC checks to see if the environment variable GOOGLE_APPLICATION_CREDENTIALS is set. If the variable is set, ADC uses the service account file that the variable points to. The next section describes how to set the environment variable.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"If the environment variable isn't set, ADC uses the default service account that Compute Engine, Kubernetes Engine, App Engine, and Cloud Functions provide, for applications that run on those services.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"If ADC can't use either of the above credentials, an error occurs.\"))),mdx(\"p\",null,\"This integration needs the following information:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"gcs-bucket\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#gcs-bucket\",\"aria-label\":\"gcs bucket permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-gcs-bucket\")),\" supplies the bucket to use.\")),mdx(\"h4\",e({},{id:\"api-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-options\",\"aria-label\":\"api options permalink\"}),\"\\xBB\"),\"API Options\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"ca-file\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#ca-file\",\"aria-label\":\"ca file permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-ca-file=\u003cvalue\u003e\")),` - Path to a CA file to use for TLS when communicating with Consul.\nThis can also be specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_CACERT\"),\" environment variable.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"ca-path\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#ca-path\",\"aria-label\":\"ca path permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-ca-path=\u003cvalue\u003e\")),` - Path to a directory of CA certificates to use for TLS when\ncommunicating with Consul. This can also be specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_CAPATH\"),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"client-cert\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#client-cert\",\"aria-label\":\"client cert permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-client-cert=\u003cvalue\u003e\")),` - Path to a client cert file to use for TLS when\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"verify_incoming\"),\" is enabled. This can also be specified via the \",mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_CLIENT_CERT\"),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"client-key\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#client-key\",\"aria-label\":\"client key permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-client-key=\u003cvalue\u003e\")),` - Path to a client key file to use for TLS when\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"verify_incoming\"),\" is enabled. This can also be specified via the \",mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_CLIENT_KEY\"),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"http-addr\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#http-addr\",\"aria-label\":\"http addr permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-http-addr=\u003caddr\u003e\")),` - Address of the Consul agent with the port. This can be\nan IP address or DNS address, but it must include the port. This can also be\nspecified via the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_HTTP_ADDR\"),` environment variable. In Consul 0.8 and\nlater, the default value is `,mdx(\"a\",e({parentName:\"p\"},{href:\"http://127.0.0.1:8500\"}),\"http://127.0.0.1:8500\"),`, and https can optionally be\nused instead. The scheme can also be set to HTTPS by setting the environment\nvariable `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_HTTP_SSL=true\"),`. This may be a unix domain socket using\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"unix:///path/to/socket\"),\" if the \",mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/docs/agent/config/config-files#addresses\"}),`agent is configured to\nlisten`),\" that way.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"tls-server-name\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#tls-server-name\",\"aria-label\":\"tls server name permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-tls-server-name=\u003cvalue\u003e\")),` - The server name to use as the SNI host when\nconnecting via TLS. This can also be specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_TLS_SERVER_NAME\"),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"token\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#token\",\"aria-label\":\"token permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-token=\u003cvalue\u003e\")),` - ACL token to use in the request. This can also be specified\nvia the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_HTTP_TOKEN\"),` environment variable. If unspecified, the query\nwill default to the token of the Consul agent at the HTTP address.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"token-file\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#token-file\",\"aria-label\":\"token file permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-token-file=\u003cvalue\u003e\")),` - File containing the ACL token to use in the request\ninstead of one specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},\"-token\"),\" argument or \",mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_HTTP_TOKEN\"),`\nenvironment variable. This can also be specified via the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_HTTP_TOKEN_FILE\"),\" environment variable.\"))),mdx(\"h2\",e({},{id:\"examples\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#examples\",\"aria-label\":\"examples permalink\"}),\"\\xBB\"),\"Examples\"),mdx(\"p\",null,`Running the agent with no arguments will run a long-running daemon process that will\nperform leader election for highly available operation, register itself with Consul\nservice discovery with health checks, take snapshots every hour, retain the last 30\nsnapshots, and save snapshots into the current working directory:`),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"consul snapshot agent\")),`\n`)),mdx(\"p\",null,`To run a one-shot backup, set the backup interval to 0. This will run a single snapshot\nand delete any old snapshots based on the retain settings, but it will not perform any\nleader election or service registration:`),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"consul snapshot agent -interval\",mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token number\"}),\"0\"))),`\n`)),mdx(\"p\",null,\"Please see the \",mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/api-docs/snapshot\"}),\"HTTP API\"),` documentation for\nmore details about snapshot internals.`),mdx(\"h2\",e({},{id:\"licensing\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#licensing\",\"aria-label\":\"licensing permalink\"}),\"\\xBB\"),\"Licensing\"),mdx(\"p\",null,`The snapshot agent requires a license when it starts before it will perform any other\nactions. This can be provided using the `,mdx(\"inlineCode\",{parentName:\"p\"},\"license_path\"),` configuration item, the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_LICENSE_PATH\"),\" environment variable or the \",mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_LICENSE\"),` environment variable.\nThe `,mdx(\"inlineCode\",{parentName:\"p\"},\"license_path\"),\" configuration and \",mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_LICENSE_PATH\"),` variable should point to\nfiles that contain the license whereas the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_LICENSE\"),` variable value should be\nthe contents of the license itself. If a license is present in multiple ways the\nthen the order of precedence is as follows:`),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",e({parentName:\"li\"},{id:\"consul_license\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#consul_license\",\"aria-label\":\"consul_license permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"CONSUL_LICENSE\")),\" variable\"),mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",e({parentName:\"li\"},{id:\"consul_license_path\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#consul_license_path\",\"aria-label\":\"consul_license_path permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"CONSUL_LICENSE_PATH\")),\" variable\"),mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",e({parentName:\"li\"},{id:\"license_path\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#license_path\",\"aria-label\":\"license_path permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"license_path\")),\" configuration.\")),mdx(\"p\",null,`The ability to load licenses from the configuration or environment was added in v1.10.0,\nv1.9.7 and v1.8.13. See the `,mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/docs/enterprise/license/overview\"}),\"licensing documentation\"),` for\nmore information about Consul Enterprise license management.`))}MDXContent.isMDXComponent=!0;\n","scope":{"version":"latest"}},"product":{"name":"Consul","slug":"consul","algoliaConfig":{"indexName":"product_CONSUL","searchOnlyApiKey":"fbd5dc1f0078d41509fcc560386fd534"},"analyticsConfig":{"includedDomains":"consul.io www.consul.io","segmentWriteKey":"IyzLrqXkox5KJ8XL4fo8vTYNGfiKlTCm"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Consul by HashiCorp","description":"Consul is a service networking solution to automate network configurations, discover services, and enable secure connectivity across any cloud or runtime.","image":"https://www.consulproject.io/consul-public/img/og-image.png","icon":[{"href":"/consul-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiConf","url":"https://hashiconf.com/2023?utm_source=direct\u0026utm_medium=banner\u0026utm_campaign=23Q3_HASHICONFGLOBAL_EVENT\u0026utm_content=\u0026utm_offer=event","text":"Our community conference is taking place in San Francisco and online October 10-12.","linkText":"Register now","expirationDate":""},"version":"1.11.3","subnavItems":[],"basePaths":["docs","api-docs","commands","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"api","name":"API","path":"api-docs"},{"iconName":"terminal-screen","name":"CLI","path":"commands"}],"currentRootDocsPath":{"iconName":"terminal-screen","name":"CLI","path":"commands"}},"projectName":null,"versions":null},"__N_SSG":true},"page":"/consul/commands/[[...page]]","query":{"page":["snapshot","agent"]},"buildId":"Bgb-wtlhVht2bM8BF79Za","assetPrefix":"/hashicorp-consul","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script nomodule="">window.MSInputMethodContext && document.documentMode && document.write('<script src="/ie-warning.js"><\x2fscript>');</script></body></html>