{"pageProps":{"layoutProps":{"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Consul","url":"/consul"},{"title":"CLI","url":"/consul/commands","isCurrentPage":false},{"title":"snapshot","url":"/consul/commands/snapshot"},{"title":"agent","url":"/consul/commands/snapshot/agent","isCurrentPage":true}],"sidebarNavDataLevels":[{"levelButtonProps":{"levelDownButtonText":"Consul Home"},"menuItems":[{"leadingIconName":"home","title":"HashiCorp Developer","href":"/"},{"leadingIconName":"guide","title":"Tutorials","href":"/tutorials"},{"divider":true},{"heading":"Products"},{"leadingIconName":"hcp","title":"HashiCorp Cloud Platform","href":"/hcp"},{"leadingIconName":"terraform","title":"Terraform","href":"/terraform"},{"leadingIconName":"packer","title":"Packer","href":"/packer"},{"leadingIconName":"consul","title":"Consul","href":"/consul"},{"leadingIconName":"vault","title":"Vault","href":"/vault"},{"leadingIconName":"boundary","title":"Boundary","href":"/boundary"},{"leadingIconName":"nomad","title":"Nomad","href":"/nomad"},{"leadingIconName":"waypoint","title":"Waypoint","href":"/waypoint"},{"leadingIconName":"vagrant","title":"Vagrant","href":"/vagrant"}],"showFilterInput":false,"title":"Main Menu"},{"levelButtonProps":{"levelUpButtonText":"Main Menu","levelDownButtonText":"Previous"},"menuItems":[{"title":"Consul","fullPath":"/consul","theme":"consul"},{"title":"Install","fullPath":"/consul/install"},{"title":"Tutorials","fullPath":"/consul/tutorials"},{"title":"Documentation","fullPath":"/consul/docs"},{"title":"API","fullPath":"/consul/api-docs"},{"title":"CLI","fullPath":"/consul/commands"}],"showFilterInput":false,"title":"Consul","visuallyHideTitle":true},{"backToLinkProps":{"text":"Consul Home","href":"/consul"},"levelButtonProps":{"levelUpButtonText":"Consul Home"},"menuItems":[{"title":"CLI","fullPath":"/consul/commands","theme":"consul"},{"title":"acl","routes":[{"title":"Overview","path":"acl","filePath":"../content/commands/acl/index.mdx","fullPath":"/consul/commands/acl","id":"sidebar-nav-item-2"},{"title":"auth-method","routes":[{"title":"Overview","path":"acl/auth-method","filePath":"../content/commands/acl/auth-method/index.mdx","fullPath":"/consul/commands/acl/auth-method","id":"sidebar-nav-item-4"},{"title":"create","path":"acl/auth-method/create","filePath":"../content/commands/acl/auth-method/create.mdx","fullPath":"/consul/commands/acl/auth-method/create","id":"sidebar-nav-item-5"},{"title":"delete","path":"acl/auth-method/delete","filePath":"../content/commands/acl/auth-method/delete.mdx","fullPath":"/consul/commands/acl/auth-method/delete","id":"sidebar-nav-item-6"},{"title":"list","path":"acl/auth-method/list","filePath":"../content/commands/acl/auth-method/list.mdx","fullPath":"/consul/commands/acl/auth-method/list","id":"sidebar-nav-item-7"},{"title":"read","path":"acl/auth-method/read","filePath":"../content/commands/acl/auth-method/read.mdx","fullPath":"/consul/commands/acl/auth-method/read","id":"sidebar-nav-item-8"},{"title":"update","path":"acl/auth-method/update","filePath":"../content/commands/acl/auth-method/update.mdx","fullPath":"/consul/commands/acl/auth-method/update","id":"sidebar-nav-item-9"}],"id":"sidebar-nav-item-3"},{"title":"binding-rule","routes":[{"title":"Overview","path":"acl/binding-rule","filePath":"../content/commands/acl/binding-rule/index.mdx","fullPath":"/consul/commands/acl/binding-rule","id":"sidebar-nav-item-11"},{"title":"create","path":"acl/binding-rule/create","filePath":"../content/commands/acl/binding-rule/create.mdx","fullPath":"/consul/commands/acl/binding-rule/create","id":"sidebar-nav-item-12"},{"title":"delete","path":"acl/binding-rule/delete","filePath":"../content/commands/acl/binding-rule/delete.mdx","fullPath":"/consul/commands/acl/binding-rule/delete","id":"sidebar-nav-item-13"},{"title":"list","path":"acl/binding-rule/list","filePath":"../content/commands/acl/binding-rule/list.mdx","fullPath":"/consul/commands/acl/binding-rule/list","id":"sidebar-nav-item-14"},{"title":"read","path":"acl/binding-rule/read","filePath":"../content/commands/acl/binding-rule/read.mdx","fullPath":"/consul/commands/acl/binding-rule/read","id":"sidebar-nav-item-15"},{"title":"update","path":"acl/binding-rule/update","filePath":"../content/commands/acl/binding-rule/update.mdx","fullPath":"/consul/commands/acl/binding-rule/update","id":"sidebar-nav-item-16"}],"id":"sidebar-nav-item-10"},{"title":"bootstrap","path":"acl/bootstrap","filePath":"../content/commands/acl/bootstrap.mdx","fullPath":"/consul/commands/acl/bootstrap","id":"sidebar-nav-item-17"},{"title":"policy","routes":[{"title":"Overview","path":"acl/policy","filePath":"../content/commands/acl/policy/index.mdx","fullPath":"/consul/commands/acl/policy","id":"sidebar-nav-item-19"},{"title":"create","path":"acl/policy/create","filePath":"../content/commands/acl/policy/create.mdx","fullPath":"/consul/commands/acl/policy/create","id":"sidebar-nav-item-20"},{"title":"delete","path":"acl/policy/delete","filePath":"../content/commands/acl/policy/delete.mdx","fullPath":"/consul/commands/acl/policy/delete","id":"sidebar-nav-item-21"},{"title":"list","path":"acl/policy/list","filePath":"../content/commands/acl/policy/list.mdx","fullPath":"/consul/commands/acl/policy/list","id":"sidebar-nav-item-22"},{"title":"read","path":"acl/policy/read","filePath":"../content/commands/acl/policy/read.mdx","fullPath":"/consul/commands/acl/policy/read","id":"sidebar-nav-item-23"},{"title":"update","path":"acl/policy/update","filePath":"../content/commands/acl/policy/update.mdx","fullPath":"/consul/commands/acl/policy/update","id":"sidebar-nav-item-24"}],"id":"sidebar-nav-item-18"},{"title":"templated policy","routes":[{"title":"Overview","path":"acl/templated-policy","filePath":"../content/commands/acl/templated-policy/index.mdx","fullPath":"/consul/commands/acl/templated-policy","id":"sidebar-nav-item-26"},{"title":"list","path":"acl/templated-policy/list","filePath":"../content/commands/acl/templated-policy/list.mdx","fullPath":"/consul/commands/acl/templated-policy/list","id":"sidebar-nav-item-27"},{"title":"preview","path":"acl/templated-policy/preview","filePath":"../content/commands/acl/templated-policy/preview.mdx","fullPath":"/consul/commands/acl/templated-policy/preview","id":"sidebar-nav-item-28"},{"title":"read","path":"acl/templated-policy/read","filePath":"../content/commands/acl/templated-policy/read.mdx","fullPath":"/consul/commands/acl/templated-policy/read","id":"sidebar-nav-item-29"}],"id":"sidebar-nav-item-25"},{"title":"role","routes":[{"title":"Overview","path":"acl/role","filePath":"../content/commands/acl/role/index.mdx","fullPath":"/consul/commands/acl/role","id":"sidebar-nav-item-31"},{"title":"create","path":"acl/role/create","filePath":"../content/commands/acl/role/create.mdx","fullPath":"/consul/commands/acl/role/create","id":"sidebar-nav-item-32"},{"title":"delete","path":"acl/role/delete","filePath":"../content/commands/acl/role/delete.mdx","fullPath":"/consul/commands/acl/role/delete","id":"sidebar-nav-item-33"},{"title":"list","path":"acl/role/list","filePath":"../content/commands/acl/role/list.mdx","fullPath":"/consul/commands/acl/role/list","id":"sidebar-nav-item-34"},{"title":"read","path":"acl/role/read","filePath":"../content/commands/acl/role/read.mdx","fullPath":"/consul/commands/acl/role/read","id":"sidebar-nav-item-35"},{"title":"update","path":"acl/role/update","filePath":"../content/commands/acl/role/update.mdx","fullPath":"/consul/commands/acl/role/update","id":"sidebar-nav-item-36"}],"id":"sidebar-nav-item-30"},{"title":"set-agent-token","path":"acl/set-agent-token","filePath":"../content/commands/acl/set-agent-token.mdx","fullPath":"/consul/commands/acl/set-agent-token","id":"sidebar-nav-item-37"},{"title":"token","routes":[{"title":"Overview","path":"acl/token","filePath":"../content/commands/acl/token/index.mdx","fullPath":"/consul/commands/acl/token","id":"sidebar-nav-item-39"},{"title":"clone","path":"acl/token/clone","filePath":"../content/commands/acl/token/clone.mdx","fullPath":"/consul/commands/acl/token/clone","id":"sidebar-nav-item-40"},{"title":"create","path":"acl/token/create","filePath":"../content/commands/acl/token/create.mdx","fullPath":"/consul/commands/acl/token/create","id":"sidebar-nav-item-41"},{"title":"delete","path":"acl/token/delete","filePath":"../content/commands/acl/token/delete.mdx","fullPath":"/consul/commands/acl/token/delete","id":"sidebar-nav-item-42"},{"title":"list","path":"acl/token/list","filePath":"../content/commands/acl/token/list.mdx","fullPath":"/consul/commands/acl/token/list","id":"sidebar-nav-item-43"},{"title":"read","path":"acl/token/read","filePath":"../content/commands/acl/token/read.mdx","fullPath":"/consul/commands/acl/token/read","id":"sidebar-nav-item-44"},{"title":"update","path":"acl/token/update","filePath":"../content/commands/acl/token/update.mdx","fullPath":"/consul/commands/acl/token/update","id":"sidebar-nav-item-45"}],"id":"sidebar-nav-item-38"}],"id":"sidebar-nav-item-1"},{"title":"agent","path":"agent","filePath":"../content/commands/agent.mdx","fullPath":"/consul/commands/agent","id":"sidebar-nav-item-46"},{"title":"catalog","routes":[{"title":"Overview","path":"catalog","filePath":"../content/commands/catalog/index.mdx","fullPath":"/consul/commands/catalog","id":"sidebar-nav-item-48"},{"title":"datacenters","path":"catalog/datacenters","filePath":"../content/commands/catalog/datacenters.mdx","fullPath":"/consul/commands/catalog/datacenters","id":"sidebar-nav-item-49"},{"title":"nodes","path":"catalog/nodes","filePath":"../content/commands/catalog/nodes.mdx","fullPath":"/consul/commands/catalog/nodes","id":"sidebar-nav-item-50"},{"title":"services","path":"catalog/services","filePath":"../content/commands/catalog/services.mdx","fullPath":"/consul/commands/catalog/services","id":"sidebar-nav-item-51"}],"id":"sidebar-nav-item-47"},{"title":"config","routes":[{"title":"Overview","path":"config","filePath":"../content/commands/config/index.mdx","fullPath":"/consul/commands/config","id":"sidebar-nav-item-53"},{"title":"delete","path":"config/delete","filePath":"../content/commands/config/delete.mdx","fullPath":"/consul/commands/config/delete","id":"sidebar-nav-item-54"},{"title":"list","path":"config/list","filePath":"../content/commands/config/list.mdx","fullPath":"/consul/commands/config/list","id":"sidebar-nav-item-55"},{"title":"read","path":"config/read","filePath":"../content/commands/config/read.mdx","fullPath":"/consul/commands/config/read","id":"sidebar-nav-item-56"},{"title":"write","path":"config/write","filePath":"../content/commands/config/write.mdx","fullPath":"/consul/commands/config/write","id":"sidebar-nav-item-57"}],"id":"sidebar-nav-item-52"},{"title":"connect","routes":[{"title":"Overview","path":"connect","filePath":"../content/commands/connect/index.mdx","fullPath":"/consul/commands/connect","id":"sidebar-nav-item-59"},{"title":"ca","path":"connect/ca","filePath":"../content/commands/connect/ca.mdx","fullPath":"/consul/commands/connect/ca","id":"sidebar-nav-item-60"},{"title":"proxy","path":"connect/proxy","filePath":"../content/commands/connect/proxy.mdx","fullPath":"/consul/commands/connect/proxy","id":"sidebar-nav-item-61"},{"title":"envoy","path":"connect/envoy","filePath":"../content/commands/connect/envoy.mdx","fullPath":"/consul/commands/connect/envoy","id":"sidebar-nav-item-62"},{"title":"expose","path":"connect/expose","filePath":"../content/commands/connect/expose.mdx","fullPath":"/consul/commands/connect/expose","id":"sidebar-nav-item-63"},{"title":"redirect-traffic","path":"connect/redirect-traffic","filePath":"../content/commands/connect/redirect-traffic.mdx","fullPath":"/consul/commands/connect/redirect-traffic","id":"sidebar-nav-item-64"}],"id":"sidebar-nav-item-58"},{"title":"debug","path":"debug","filePath":"../content/commands/debug.mdx","fullPath":"/consul/commands/debug","id":"sidebar-nav-item-65"},{"title":"event","path":"event","filePath":"../content/commands/event.mdx","fullPath":"/consul/commands/event","id":"sidebar-nav-item-66"},{"title":"exec","path":"exec","filePath":"../content/commands/exec.mdx","fullPath":"/consul/commands/exec","id":"sidebar-nav-item-67"},{"title":"force-leave","path":"force-leave","filePath":"../content/commands/force-leave.mdx","fullPath":"/consul/commands/force-leave","id":"sidebar-nav-item-68"},{"title":"info","path":"info","filePath":"../content/commands/info.mdx","fullPath":"/consul/commands/info","id":"sidebar-nav-item-69"},{"title":"intention","routes":[{"title":"Overview","path":"intention","filePath":"../content/commands/intention/index.mdx","fullPath":"/consul/commands/intention","id":"sidebar-nav-item-71"},{"title":"check","path":"intention/check","filePath":"../content/commands/intention/check.mdx","fullPath":"/consul/commands/intention/check","id":"sidebar-nav-item-72"},{"title":"create","path":"intention/create","filePath":"../content/commands/intention/create.mdx","fullPath":"/consul/commands/intention/create","id":"sidebar-nav-item-73"},{"title":"delete","path":"intention/delete","filePath":"../content/commands/intention/delete.mdx","fullPath":"/consul/commands/intention/delete","id":"sidebar-nav-item-74"},{"title":"get","path":"intention/get","filePath":"../content/commands/intention/get.mdx","fullPath":"/consul/commands/intention/get","id":"sidebar-nav-item-75"},{"title":"list","path":"intention/list","filePath":"../content/commands/intention/list.mdx","fullPath":"/consul/commands/intention/list","id":"sidebar-nav-item-76"},{"title":"match","path":"intention/match","filePath":"../content/commands/intention/match.mdx","fullPath":"/consul/commands/intention/match","id":"sidebar-nav-item-77"}],"id":"sidebar-nav-item-70"},{"title":"join","path":"join","filePath":"../content/commands/join.mdx","fullPath":"/consul/commands/join","id":"sidebar-nav-item-78"},{"title":"keygen","path":"keygen","filePath":"../content/commands/keygen.mdx","fullPath":"/consul/commands/keygen","id":"sidebar-nav-item-79"},{"title":"keyring","path":"keyring","filePath":"../content/commands/keyring.mdx","fullPath":"/consul/commands/keyring","id":"sidebar-nav-item-80"},{"title":"kv","routes":[{"title":"Overview","path":"kv","filePath":"../content/commands/kv/index.mdx","fullPath":"/consul/commands/kv","id":"sidebar-nav-item-82"},{"title":"delete","path":"kv/delete","filePath":"../content/commands/kv/delete.mdx","fullPath":"/consul/commands/kv/delete","id":"sidebar-nav-item-83"},{"title":"export","path":"kv/export","filePath":"../content/commands/kv/export.mdx","fullPath":"/consul/commands/kv/export","id":"sidebar-nav-item-84"},{"title":"get","path":"kv/get","filePath":"../content/commands/kv/get.mdx","fullPath":"/consul/commands/kv/get","id":"sidebar-nav-item-85"},{"title":"import","path":"kv/import","filePath":"../content/commands/kv/import.mdx","fullPath":"/consul/commands/kv/import","id":"sidebar-nav-item-86"},{"title":"put","path":"kv/put","filePath":"../content/commands/kv/put.mdx","fullPath":"/consul/commands/kv/put","id":"sidebar-nav-item-87"}],"id":"sidebar-nav-item-81"},{"title":"leave","path":"leave","filePath":"../content/commands/leave.mdx","fullPath":"/consul/commands/leave","id":"sidebar-nav-item-88"},{"title":"license","path":"license","filePath":"../content/commands/license.mdx","fullPath":"/consul/commands/license","id":"sidebar-nav-item-89"},{"title":"lock","path":"lock","filePath":"../content/commands/lock.mdx","fullPath":"/consul/commands/lock","id":"sidebar-nav-item-90"},{"title":"login","path":"login","filePath":"../content/commands/login.mdx","fullPath":"/consul/commands/login","id":"sidebar-nav-item-91"},{"title":"logout","path":"logout","filePath":"../content/commands/logout.mdx","fullPath":"/consul/commands/logout","id":"sidebar-nav-item-92"},{"title":"maint","path":"maint","filePath":"../content/commands/maint.mdx","fullPath":"/consul/commands/maint","id":"sidebar-nav-item-93"},{"title":"members","path":"members","filePath":"../content/commands/members.mdx","fullPath":"/consul/commands/members","id":"sidebar-nav-item-94"},{"title":"monitor","path":"monitor","filePath":"../content/commands/monitor.mdx","fullPath":"/consul/commands/monitor","id":"sidebar-nav-item-95"},{"title":"namespace","routes":[{"title":"Overview","path":"namespace","filePath":"../content/commands/namespace/index.mdx","fullPath":"/consul/commands/namespace","id":"sidebar-nav-item-97"},{"title":"create","path":"namespace/create","filePath":"../content/commands/namespace/create.mdx","fullPath":"/consul/commands/namespace/create","id":"sidebar-nav-item-98"},{"title":"delete","path":"namespace/delete","filePath":"../content/commands/namespace/delete.mdx","fullPath":"/consul/commands/namespace/delete","id":"sidebar-nav-item-99"},{"title":"list","path":"namespace/list","filePath":"../content/commands/namespace/list.mdx","fullPath":"/consul/commands/namespace/list","id":"sidebar-nav-item-100"},{"title":"read","path":"namespace/read","filePath":"../content/commands/namespace/read.mdx","fullPath":"/consul/commands/namespace/read","id":"sidebar-nav-item-101"},{"title":"update","path":"namespace/update","filePath":"../content/commands/namespace/update.mdx","fullPath":"/consul/commands/namespace/update","id":"sidebar-nav-item-102"},{"title":"write","path":"namespace/write","filePath":"../content/commands/namespace/write.mdx","fullPath":"/consul/commands/namespace/write","id":"sidebar-nav-item-103"}],"id":"sidebar-nav-item-96"},{"title":"operator","routes":[{"title":"Overview","path":"operator","filePath":"../content/commands/operator/index.mdx","fullPath":"/consul/commands/operator","id":"sidebar-nav-item-105"},{"title":"area","path":"operator/area","filePath":"../content/commands/operator/area.mdx","fullPath":"/consul/commands/operator/area","id":"sidebar-nav-item-106"},{"title":"autopilot","path":"operator/autopilot","filePath":"../content/commands/operator/autopilot.mdx","fullPath":"/consul/commands/operator/autopilot","id":"sidebar-nav-item-107"},{"title":"raft","path":"operator/raft","filePath":"../content/commands/operator/raft.mdx","fullPath":"/consul/commands/operator/raft","id":"sidebar-nav-item-108"},{"title":"usage","path":"operator/usage","filePath":"../content/commands/operator/usage.mdx","fullPath":"/consul/commands/operator/usage","id":"sidebar-nav-item-109"}],"id":"sidebar-nav-item-104"},{"title":"partition","path":"partition","filePath":"../content/commands/partition.mdx","fullPath":"/consul/commands/partition","id":"sidebar-nav-item-110"},{"title":"peering","routes":[{"title":"Overview","path":"peering","filePath":"../content/commands/peering/index.mdx","fullPath":"/consul/commands/peering","id":"sidebar-nav-item-112"},{"title":"delete","path":"peering/delete","filePath":"../content/commands/peering/delete.mdx","fullPath":"/consul/commands/peering/delete","id":"sidebar-nav-item-113"},{"title":"establish","path":"peering/establish","filePath":"../content/commands/peering/establish.mdx","fullPath":"/consul/commands/peering/establish","id":"sidebar-nav-item-114"},{"title":"exported-services","path":"peering/exported-services","filePath":"../content/commands/peering/exported-services.mdx","fullPath":"/consul/commands/peering/exported-services","id":"sidebar-nav-item-115"},{"title":"generate-token","path":"peering/generate-token","filePath":"../content/commands/peering/generate-token.mdx","fullPath":"/consul/commands/peering/generate-token","id":"sidebar-nav-item-116"},{"title":"list","path":"peering/list","filePath":"../content/commands/peering/list.mdx","fullPath":"/consul/commands/peering/list","id":"sidebar-nav-item-117"},{"title":"read","path":"peering/read","filePath":"../content/commands/peering/read.mdx","fullPath":"/consul/commands/peering/read","id":"sidebar-nav-item-118"}],"id":"sidebar-nav-item-111"},{"title":"reload","path":"reload","filePath":"../content/commands/reload.mdx","fullPath":"/consul/commands/reload","id":"sidebar-nav-item-119"},{"title":"resource","path":"resource","badge":{"text":"v2","type":"outlined","color":"neutral"},"filePath":"../content/commands/resource.mdx","fullPath":"/consul/commands/resource","id":"sidebar-nav-item-120"},{"title":"rtt","path":"rtt","filePath":"../content/commands/rtt.mdx","fullPath":"/consul/commands/rtt","id":"sidebar-nav-item-121"},{"title":"services","routes":[{"title":"Overview","path":"services","filePath":"../content/commands/services/index.mdx","fullPath":"/consul/commands/services","id":"sidebar-nav-item-123"},{"title":"register","path":"services/register","filePath":"../content/commands/services/register.mdx","fullPath":"/consul/commands/services/register","id":"sidebar-nav-item-124"},{"title":"deregister","path":"services/deregister","filePath":"../content/commands/services/deregister.mdx","fullPath":"/consul/commands/services/deregister","id":"sidebar-nav-item-125"},{"title":"export","path":"services/export","filePath":"../content/commands/services/export.mdx","fullPath":"/consul/commands/services/export","id":"sidebar-nav-item-126"},{"title":"exported-services","path":"services/exported-services","filePath":"../content/commands/services/exported-services.mdx","fullPath":"/consul/commands/services/exported-services","id":"sidebar-nav-item-127"}],"id":"sidebar-nav-item-122"},{"title":"snapshot","routes":[{"title":"Overview","path":"snapshot","filePath":"../content/commands/snapshot/index.mdx","fullPath":"/consul/commands/snapshot","id":"sidebar-nav-item-129"},{"title":"agent","path":"snapshot/agent","filePath":"../content/commands/snapshot/agent.mdx","fullPath":"/consul/commands/snapshot/agent","id":"sidebar-nav-item-130"},{"title":"inspect","path":"snapshot/inspect","filePath":"../content/commands/snapshot/inspect.mdx","fullPath":"/consul/commands/snapshot/inspect","id":"sidebar-nav-item-131"},{"title":"restore","path":"snapshot/restore","filePath":"../content/commands/snapshot/restore.mdx","fullPath":"/consul/commands/snapshot/restore","id":"sidebar-nav-item-132"},{"title":"save","path":"snapshot/save","filePath":"../content/commands/snapshot/save.mdx","fullPath":"/consul/commands/snapshot/save","id":"sidebar-nav-item-133"}],"id":"sidebar-nav-item-128"},{"title":"tls","routes":[{"title":"Overview","path":"tls","filePath":"../content/commands/tls/index.mdx","fullPath":"/consul/commands/tls","id":"sidebar-nav-item-135"},{"title":"ca","path":"tls/ca","filePath":"../content/commands/tls/ca.mdx","fullPath":"/consul/commands/tls/ca","id":"sidebar-nav-item-136"},{"title":"cert","path":"tls/cert","filePath":"../content/commands/tls/cert.mdx","fullPath":"/consul/commands/tls/cert","id":"sidebar-nav-item-137"}],"id":"sidebar-nav-item-134"},{"title":"troubleshoot","routes":[{"title":"Overview","path":"troubleshoot","filePath":"../content/commands/troubleshoot/index.mdx","fullPath":"/consul/commands/troubleshoot","id":"sidebar-nav-item-139"},{"title":"upstreams","path":"troubleshoot/upstreams","filePath":"../content/commands/troubleshoot/upstreams.mdx","fullPath":"/consul/commands/troubleshoot/upstreams","id":"sidebar-nav-item-140"},{"title":"proxy","path":"troubleshoot/proxy","filePath":"../content/commands/troubleshoot/proxy.mdx","fullPath":"/consul/commands/troubleshoot/proxy","id":"sidebar-nav-item-141"},{"title":"ports","path":"troubleshoot/ports","filePath":"../content/commands/troubleshoot/ports.mdx","fullPath":"/consul/commands/troubleshoot/ports","id":"sidebar-nav-item-142"}],"id":"sidebar-nav-item-138"},{"title":"validate","path":"validate","filePath":"../content/commands/validate.mdx","fullPath":"/consul/commands/validate","id":"sidebar-nav-item-143"},{"title":"version","path":"version","filePath":"../content/commands/version.mdx","fullPath":"/consul/commands/version","id":"sidebar-nav-item-144"},{"title":"watch","path":"watch","filePath":"../content/commands/watch.mdx","fullPath":"/consul/commands/watch","id":"sidebar-nav-item-145"}],"title":"CLI","visuallyHideTitle":true}],"mainWidth":"narrow","githubFileUrl":"https://github.com/hashicorp/consul/blob/main/website/../content/commands/snapshot/agent.mdx"},"metadata":{"title":"Commands: Snapshot Agent","description":"The `consul snapshot agent` command starts a process that takes snapshots of the state of the Consul servers in Consul Enterprise. It can capture server state once or it can run as a daemon that captures snapshots at defined intervals.\n","layout":null},"outlineItems":[{"title":"Consul Snapshot Agent","url":"#consul-snapshot-agent","dataHeapTrack":"toc-list-item-index-0"},{"title":"ACL permissions","url":"#acl-permissions","dataHeapTrack":"toc-list-item-index-1"},{"title":"Usage","url":"#usage","dataHeapTrack":"toc-list-item-index-2"},{"title":"Examples","url":"#examples","dataHeapTrack":"toc-list-item-index-3"},{"title":"Licensing","url":"#licensing","dataHeapTrack":"toc-list-item-index-4"}],"pageHeading":{"id":"consul-snapshot-agent","title":"Consul Snapshot Agent"},"mdxSource":{"compiledSource":"var c=Object.defineProperty,d=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var i=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;var r=(a,n,t)=>n in a?c(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,e=(a,n)=>{for(var t in n||(n={}))i.call(n,t)&&r(a,t,n[t]);if(o)for(var t of o(n))p.call(n,t)&&r(a,t,n[t]);return a},l=(a,n)=>d(a,N(n));var m=(a,n)=>{var t={};for(var s in a)i.call(a,s)&&n.indexOf(s)<0&&(t[s]=a[s]);if(a!=null&&o)for(var s of o(a))n.indexOf(s)<0&&p.call(a,s)&&(t[s]=a[s]);return t};const makeShortcode=a=>function(t){return console.warn(\"Component \"+a+\" was not imported, exported, or provided by MDXProvider as global scope\"),mdx(\"div\",e({},t))},EnterpriseAlert=makeShortcode(\"EnterpriseAlert\"),CodeTabs=makeShortcode(\"CodeTabs\"),layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:a}=s,n=m(s,[\"components\"]);return mdx(MDXLayout,l(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(\"p\",null,\"Command: \",mdx(\"inlineCode\",{parentName:\"p\"},\"consul snapshot agent\")),mdx(EnterpriseAlert,{mdxType:\"EnterpriseAlert\"}),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\"}),mdx(\"p\",{parentName:\"div\"},\"The \",mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/commands/snapshot/agent\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"agent\")),` subcommand described here is\navailable only in `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.hashicorp.com/products/consul/\"}),\"Consul Enterprise\"),`\nversion 0.7.1 and later. All other `,mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/commands/snapshot\"}),\"snapshot subcommands\"),`\nare available in the community edition of Consul.`)),mdx(\"p\",null,\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot agent\"),` subcommand starts a process that takes snapshots of the\nstate of the Consul servers and saves them locally, or pushes them to optional\nremote storage services.`),mdx(\"p\",null,`The agent can be run as a long-running daemon process or in a one-shot mode\nfrom a batch job, based on the `,mdx(\"a\",e({parentName:\"p\"},{href:\"#interval\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-interval\")),` argument. Snapshotting\na remote datacenter is only available in one-shot mode.`),mdx(\"p\",null,`As a long-running daemon, the agent will perform a leader election so multiple\nprocesses can be run in a highly available fashion with automatic failover. The\nagent will also register itself with Consul as a service, along with health\nchecks that show the agent is alive (\"Consul Snapshot Agent Alive\") and able to\ntake snapshots (\"Consul Snapshot Agent Saving Snapshots\"). The latter check is\nonly added on agents who have become a leader, so it's possible for operators to\ntell which instances are alive and on standby and which instance has become\nleader and starting saving snapshots.`),mdx(\"p\",null,\"As snapshots are saved, they will be reported in the log produced by the agent:\"),mdx(\"pre\",e({},{className:\"language-log\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-log\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token date number\"}),\"2023/11/16\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token time number\"}),\"21:21:13\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token level info keyword\"}),\"INFO\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" Snapshot agent running\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token date number\"}),\"2023/11/16\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token time number\"}),\"21:21:13\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token level info keyword\"}),\"INFO\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" Waiting to obtain leadership\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token date number\"}),\"2023/11/16\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token time number\"}),\"21:21:13\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token level info keyword\"}),\"INFO\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" Obtained leadership\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token date number\"}),\"2023/11/16\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token time number\"}),\"21:21:13\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token level info keyword\"}),\"INFO\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" Saved snapshot \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"1479360073448728784\"),`\n`)),mdx(\"p\",null,`The number shown with the saved snapshot is its ID, which is based on a UNIX\ntimestamp with nanosecond resolution, so collisions are unlikely and IDs are\nmonotonically increasing with time. This makes it easy to locate the latest\nsnapshot, even if the log data isn't available. The snapshot ID always appears\nin the file name when using local storage, or in the object key when using\nremote storage.`),mdx(\"p\",null,`Snapshots can be restored using the\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/commands/snapshot/restore\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"consul snapshot restore\")),` command, or\nthe `,mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/api-docs/snapshot\"}),\"HTTP API\"),\".\"),mdx(\"h2\",e({},{id:\"acl-permissions\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#acl-permissions\",\"aria-label\":\"acl permissions permalink\"}),\"\\xBB\"),\"ACL permissions\"),mdx(\"p\",null,\"If ACLs are enabled the following privileges are required:\"),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Resource\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Segment\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Permission\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Explanation\"))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"acl\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"N/A\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"write\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"All snapshotting operations require this privilege due to snapshots containing ACL tokens including unredacted secrets.\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"key\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"<lock key>\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"write\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"The lock key (which defaults to \",mdx(\"inlineCode\",{parentName:\"td\"},\"consul-snapshot/lock\"),\") is used during snapshot agent leader election.\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"session\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"<agent name>\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"write\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"The session used for locking during leader election is created against the agent name of the Consul agent that the Snapshot agent is registering itself with.\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"service\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"<service name>\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"write\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"The Snapshot agent registers itself with the local Consul agent and must have write privileges on its service name which is configured with \",mdx(\"inlineCode\",{parentName:\"td\"},\"-service\"),\".\")))),mdx(\"h3\",e({},{id:\"example-acl-policy\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#example-acl-policy\",\"aria-label\":\"example acl policy permalink\"}),\"\\xBB\"),\"Example ACL policy\"),mdx(\"p\",null,`The following is a example least privilege policy which allows the snapshot agent\nto run on a node named `,mdx(\"inlineCode\",{parentName:\"p\"},\"server-1234\"),\".\"),mdx(CodeTabs,{mdxType:\"CodeTabs\"},mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Required to read and snapshot ACL data\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"acl\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Allow the snapshot agent to create the key consul-snapshot/lock which will\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# serve as a leader election lock when multiple snapshot agents are running in\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# an environment\"),`\n`,\"key \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"consul-snapshot/lock\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"policy\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Allow the snapshot agent to create sessions on the specified node\"),`\n`,\"session \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"server-1234\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"policy\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Allow the snapshot agent to register itself into the catalog\"),`\n`,\"service \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"consul-snapshot\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"policy\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"pre\",e({},{className:\"language-json\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"acl\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"key\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"consul-snapshot/lock\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"policy\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"session\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"server-1234\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"policy\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"service\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"consul-snapshot\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"policy\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"write\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`))),mdx(\"p\",null,\"Additional \",mdx(\"inlineCode\",{parentName:\"p\"},\"session\"),\" rules should be created, or \",mdx(\"inlineCode\",{parentName:\"p\"},\"session_prefix\"),` used, if the\nsnapshot agent is deployed across more than one host.`),mdx(\"h2\",e({},{id:\"usage\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#usage\",\"aria-label\":\"usage permalink\"}),\"\\xBB\"),\"Usage\"),mdx(\"p\",null,\"Usage: \",mdx(\"inlineCode\",{parentName:\"p\"},\"consul snapshot agent [options]\")),mdx(\"h4\",e({},{id:\"config-file-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#config-file-options\",\"aria-label\":\"config file options permalink\"}),\"\\xBB\"),\"Config File Options\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"config-dir\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#config-dir\",\"aria-label\":\"config dir permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-config-dir\")),` - Directory to look for JSON config files. Files will be read in\nalphabetical order and must end with the extension \".json\". This won't\nrecursively descend directories. This can be specified multiple times on the\ncommand line.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"config-file\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#config-file\",\"aria-label\":\"config file permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-config-file\")),` - File to read JSON configuration from. Files must end with the\nextension \".json\". This can be specified multiple times on the command line.`),mdx(\"p\",{parentName:\"li\"},\"Config files referenced using \",mdx(\"inlineCode\",{parentName:\"p\"},\"-config-dir\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"-config-file\"),` have the following\nformat (shown populated with default values):`))),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\"}),mdx(\"p\",{parentName:\"div\"},\"Top-level single snapshot destinations in a config file are deprecated and will be removed in a future version. Move top-level \",mdx(\"inlineCode\",{parentName:\"p\"},\"local_storage\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws_storage\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"azure_blob_storage\"),\", and \",mdx(\"inlineCode\",{parentName:\"p\"},\"google_storage\"),\" config objects to \",mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot_agent -> backup_destinations\"),\" instead.\")),mdx(\"pre\",e({},{className:\"language-json\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"snapshot_agent\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"http_addr\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"127.0.0.1:8500\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"token\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"datacenter\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"ca_file\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"ca_path\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"cert_file\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"key_file\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"license_path\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"tls_server_name\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"login\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"auth_method\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"bearer_token\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"bearer_token_file\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"meta\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"log\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"level\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"INFO\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"enable_syslog\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"false\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"syslog_facility\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"LOCAL0\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"snapshot\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"interval\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"1h\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"retain\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"30\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"stale\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"false\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"service\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"consul-snapshot\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"deregister_after\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"72h\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"lock_key\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"consul-snapshot/lock\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"max_failures\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"3\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"local_scratch_path\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"backup_destinations\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"local_storage\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"path\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\".\"'),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"aws_storage\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"access_key_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"secret_access_key\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"session_token\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"iam_endpoint\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"role_arn\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"role_session_name\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"web_identity_token_file\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"sts_endpoint\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"s3_region\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"s3_endpoint\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"s3_bucket\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"s3_key_prefix\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"consul-snapshot\"'),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"azure_blob_storage\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"account_name\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"account_key\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"container_name\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"google_storage\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"bucket\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"All fields are optional, and config files without a \",mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot_agent\"),` object will\nbe ignored. At least one config file needs to have a `,mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot_agent\"),` object, or the\nsnapshot agent will fail to start. The Consul agent is set up to ignore any\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot_agent\"),` object, so it's safe to use common config directories for both agents\nif desired.`),mdx(\"h4\",e({},{id:\"snapshot-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#snapshot-options\",\"aria-label\":\"snapshot options permalink\"}),\"\\xBB\"),\"Snapshot Options\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"interval\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#interval\",\"aria-label\":\"interval permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-interval\")),` - Interval at which to perform snapshots as\na time with a unit suffix, which can be \"s\", \"m\", \"h\" for seconds, minutes, or\nhours. If 0 is provided, the agent will take a single snapshot and then exit, which\nis useful for running snapshots via batch jobs. Defaults to \"1h\"`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"lock-key\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#lock-key\",\"aria-label\":\"lock key permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-lock-key\")),` - A prefix in Consul's KV store used to coordinate between\ndifferent instances of the snapshot agent in order to only have one active instance\nat a time. For highly available operation of the snapshot agent, simply run\nmultiple instances. All instances must be configured with the same lock key in\norder to properly coordinate. Defaults to \"consul-snapshot/lock\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"max-failures\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#max-failures\",\"aria-label\":\"max failures permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-max-failures\")),` - Number of snapshot failures after which the snapshot agent\nwill give up leadership. In a highly available operation with multiple snapshot\nagents available, this gives another agent a chance to take over if an agent\nis experiencing issues, such as running out of disk space for snapshots.\nDefaults to 3.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"retain\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#retain\",\"aria-label\":\"retain permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-retain\")),` - Number of snapshots to retain. After each snapshot is taken, the\noldest snapshots will start to be deleted in order to retain at most this many\nsnapshots. If this is set to 0, the agent will not perform this and snapshots\nwill accumulate forever. Defaults to 30.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"local-scratch-path\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#local-scratch-path\",\"aria-label\":\"local scratch path permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-local-scratch-path\")),` - Location to store all temporary snapshots in prior to\nsending them off to the configured storage backend. If not configured the\nsystem temporary directory will be used.`))),mdx(\"h4\",e({},{id:\"agent-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#agent-options\",\"aria-label\":\"agent options permalink\"}),\"\\xBB\"),\"Agent Options\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"deregister-after\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#deregister-after\",\"aria-label\":\"deregister after permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-deregister-after\")),` - An interval, after which if the agent is unhealthy it will be\nautomatically deregistered from Consul service discovery. This is a time with a\nunit suffix, which can be \"s\", \"m\", \"h\" for seconds, minutes, or hours. If 0 is\nprovided, this will be disabled. Defaults to \"72h\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"log-level\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#log-level\",\"aria-label\":\"log level permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-log-level\")),` - Controls verbosity of snapshot agent logs. Valid options are\n\"trace\", \"debug\", \"info\", \"warn\", \"error\". Defaults to \"info\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"service\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#service\",\"aria-label\":\"service permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-service\")),` - The service name to use when registering the agent with Consul.\nRegistering helps monitor running agents and the leader registers an additional\nhealth check to monitor that snapshots are taking place. Defaults to\n\"consul-snapshot\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"syslog\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#syslog\",\"aria-label\":\"syslog permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-syslog\")),\" - This enables forwarding logs to syslog. Defaults to false.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"syslog-facility\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#syslog-facility\",\"aria-label\":\"syslog facility permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-syslog-facility\")),` - Sets the facility to use for forwarding logs to syslog.\nDefaults to \"LOCAL0\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"login-auth-method\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#login-auth-method\",\"aria-label\":\"login auth method permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"login-auth-method\")),` - Auth method name to use to log into Consul. If provided, the token obtained with this auth method\nwill be used instead of a static token if it is provided. Currently, only `,mdx(\"inlineCode\",{parentName:\"p\"},\"kubernetes\"),\" auth method type is supported.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"login-bearer-token\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#login-bearer-token\",\"aria-label\":\"login bearer token permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"login-bearer-token\")),\" - Bearer token to use to log into Consul. Used only if \",mdx(\"inlineCode\",{parentName:\"p\"},\"-login-auth-method\"),\" is set.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"login-bearer-token-file\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#login-bearer-token-file\",\"aria-label\":\"login bearer token file permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"login-bearer-token-file\")),` - A file container bearer token to use for logging into Consul.\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"-login-bearer-token\"),\" is ignored if this flag is provided.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"login-meta\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#login-meta\",\"aria-label\":\"login meta permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"login-meta\")),\" - Metadata to set on the token, formatted as key=value. This flag may be provided multiple times.\"))),mdx(\"h4\",e({},{id:\"local-storage-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#local-storage-options\",\"aria-label\":\"local storage options permalink\"}),\"\\xBB\"),\"Local Storage Options\"),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\"}),mdx(\"p\",{parentName:\"div\"},\"This option is deprecated when used with a top-level \",mdx(\"inlineCode\",{parentName:\"p\"},\"local_storage\"),\" object in a config file. Use \",mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot_agent -> backup_destinations -> local_storage[0]\"),\" in a config file instead.\")),mdx(\"p\",null,\"This option cannot be used when using \",mdx(\"inlineCode\",{parentName:\"p\"},\"backup_destinations\"),\" in a config file.\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"local-path\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#local-path\",\"aria-label\":\"local path permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-local-path\")),` - Location to store snapshots locally. The default behavior\nof the snapshot agent is to store snapshots locally in this directory. Defaults\nto \".\" to use the current working directory. If an alternate remote storage\noption is configured, then local storage will be disabled and this option will\nbe ignored.`)),mdx(\"h4\",e({},{id:\"s3-storage-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#s3-storage-options\",\"aria-label\":\"s3 storage options permalink\"}),\"\\xBB\"),\"S3 Storage Options\"),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\"}),mdx(\"p\",{parentName:\"div\"},\"These options are deprecated when used with a top-level \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws_storage\"),\" object in a config file. Use \",mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot_agent -> backup_destinations -> aws_storage[0]\"),\" in a config file instead.\")),mdx(\"p\",null,\"These options cannot be used when using \",mdx(\"inlineCode\",{parentName:\"p\"},\"backup_destinations\"),` in a config file.\nNote that despite the AWS references, any S3-compatible endpoint can be specified with `,mdx(\"inlineCode\",{parentName:\"p\"},\"-aws-s3-endpoint\"),\".\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-access-key-id\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-access-key-id\",\"aria-label\":\"aws access key id permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-access-key-id\")),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"-aws-secret-access-key\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"-aws-session-token\"),` - These arguments supply static\nauthentication information for connecting to S3. These may also be supplied using\nthe following alternative methods:`,mdx(\"br\",null)),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws_access_key_id\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#aws_access_key_id\",\"aria-label\":\"aws_access_key_id permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"AWS_ACCESS_KEY_ID\")),\", \",mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_SECRET_ACCESS_KEY\"),\" and \",mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_SESSION_TOKEN\"),\" environment variables\"),mdx(\"li\",{parentName:\"ul\"},\"A credentials file (\",mdx(\"inlineCode\",{parentName:\"li\"},\"~/.aws/credentials\"),` or the file at the path specified by the\n`,mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_SHARED_CREDENTIALS_FILE\"),\" environment variable)\"),mdx(\"li\",{parentName:\"ul\"},\"ECS task role metadata (container-specific)\"),mdx(\"li\",{parentName:\"ul\"},\"EC2 instance role metadata\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-iam-endpoint\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-iam-endpoint\",\"aria-label\":\"aws iam endpoint permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-iam-endpoint\")),` - IAM endpoint to use when authenticating with static credentials.\nDefault is to use the global IAM endpoint.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-role-arn\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-role-arn\",\"aria-label\":\"aws role arn permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-role-arn\")),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"-aws-role-session-name\"),\", and \",mdx(\"inlineCode\",{parentName:\"p\"},\"-aws-web-identity-token-file\"),` - These arguments are\nused to obtain temporary credentials by assuming an IAM role. These may also be supplied using\nthe following alternative methods:`,mdx(\"br\",null)),mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws_role_arn\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#aws_role_arn\",\"aria-label\":\"aws_role_arn permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"AWS_ROLE_ARN\")),\", \",mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_ROLE_SESSION_NAME\"),\", and \",mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_WEB_IDENTITY_TOKEN_FILE\"),\" environment variables.\"),mdx(\"li\",{parentName:\"ul\"},`A credentials file (~/.aws/credentials or the file at the path specified by the\n`,mdx(\"inlineCode\",{parentName:\"li\"},\"AWS_SHARED_CREDENTIALS_FILE\"),\" environment variable)\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-sts-endpoint\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-sts-endpoint\",\"aria-label\":\"aws sts endpoint permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-sts-endpoint\")),` - STS endpoint to use for obtaining temporary credentials.\nDefault is to use the global STS endpoint.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-bucket\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-bucket\",\"aria-label\":\"aws s3 bucket permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-bucket\")),` - S3 bucket to use. Required for S3 storage, and setting this\ndisables local storage. This should be only the bucket name without any\npart of the key prefix.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-key-prefix\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-key-prefix\",\"aria-label\":\"aws s3 key prefix permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-key-prefix\")),` - Prefix to use for snapshot files in S3. Defaults to\n\"consul-snapshot\".`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-region\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-region\",\"aria-label\":\"aws s3 region permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-region\")),\" - S3 region to use. Required for S3 storage.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-endpoint\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-endpoint\",\"aria-label\":\"aws s3 endpoint permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-endpoint\")),` - S3 endpoint to use. Can also be specified using the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"AWS_S3_ENDPOINT\"),\" environment variable. Defaults to the regional S3 endpoint.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-server-side-encryption\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-server-side-encryption\",\"aria-label\":\"aws s3 server side encryption permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-server-side-encryption\")),\" - Enables saving snapshots to S3 using server side encryption with \",mdx(\"a\",e({parentName:\"p\"},{href:\"http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingServerSideEncryption.html\"}),\"Amazon S3-Managed Encryption Keys\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-static-snapshot-name\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-static-snapshot-name\",\"aria-label\":\"aws s3 static snapshot name permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-static-snapshot-name\")),` - If this is given, all snapshots are saved with the same file name. The agent will not rotate or version snapshots, and will save them with the same name each time.\nUse this if you want to rely on `,mdx(\"a\",e({parentName:\"p\"},{href:\"http://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html\"}),\"S3's versioning capabilities\"),\" instead of the agent handling it for you.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-force-path-style\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-force-path-style\",\"aria-label\":\"aws s3 force path style permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-force-path-style\")),` - Enables the use of legacy path-based addressing instead of virtual addressing. This flag is required by minio\nand other 3rd party S3 compatible object storage platforms where DNS or TLS requirements for virtual addressing are prohibitive.\nFor more information, refer to the AWS documentation on `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-bucket-intro.html\"}),\"Methods for accessing a bucket\"))),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-enable-kms\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-enable-kms\",\"aria-label\":\"aws s3 enable kms permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-enable-kms\")),\" - Enables using \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://aws.amazon.com/kms/\"}),\"Amazon KMS\"),\" for encrypting snapshots.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws-s3-kms-key\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#aws-s3-kms-key\",\"aria-label\":\"aws s3 kms key permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-aws-s3-kms-key\")),\" - Optional Amazon KMS key to use, if this is not set the default KMS master key will be used. Set this if you want to manage key rotation yourself.\"),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-info g-type-body\"}),mdx(\"p\",{parentName:\"div\"},`When using a S3-compatible storage exposing a self-signed certificate the agent will not be able to perform\nthe snapshot operations unless the CA used to sign the storage certificate is trusted by the node running\nthe agent. You can add the CA root certificate to the OS trust store to have Consul trust the storage endpoint.`)))),mdx(\"h4\",e({},{id:\"s3-required-permissions\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#s3-required-permissions\",\"aria-label\":\"s3 required permissions permalink\"}),\"\\xBB\"),\"S3 Required Permissions\"),mdx(\"p\",null,`Different S3 permissions are required depending on the configuration of the snapshot agent. In particular extra permissions are required when\nsnapshot rotation is enabled. S3 storage snapshot rotation is enabled when the `,mdx(\"inlineCode\",{parentName:\"p\"},\"retain\"),` configuration is greater than 0 and when there is\nno `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws-s3-static-snapshot-name\"),\" configured.\"),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Permission\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Resource\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"When you need it\"))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"PutObject\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"arn:aws:s3:::<bucket name>/<key>\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Required for all operations.\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"DeleteObject\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"arn:aws:s3:::<bucket name>/<key>\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Required only when snapshot rotation is enabled\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"ListBucket\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"arn:aws:s3:::<bucket name>\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Required only when snapshot rotation is enabled\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"ListBucketVersions\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"arn:aws:s3:::<bucket name>\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Required only when snapshot rotation is enabled\")))),mdx(\"p\",null,\"Within the table \",mdx(\"inlineCode\",{parentName:\"p\"},\"<key>\"),\" refers to the key used to store the snapshot. When \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws-s3-static-snapshot-name\"),\" is configured the \",mdx(\"inlineCode\",{parentName:\"p\"},\"<key>\"),\" is simply the value of that configuration. Otherwise the \",mdx(\"inlineCode\",{parentName:\"p\"},\"<key>\"),\" will be the \",mdx(\"inlineCode\",{parentName:\"p\"},\"<aws-s3-key-prefix configuration>/consul-*.snap\"),\".\"),mdx(\"p\",null,\"The following example IAM policy document assumes that the \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws-s3-bucket\"),\" is \",mdx(\"inlineCode\",{parentName:\"p\"},\"consul-data\"),\" with defaults for \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws-s3-key-prefix\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws-s3-static-snapshot-name\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"retain\"),\":\"),mdx(\"pre\",e({},{className:\"language-json\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-json\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Version\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"2012-10-17\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Statement\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Sid\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Effect\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Allow\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Action\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"s3:PutObject\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"s3:DeleteObject\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Resource\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"arn:aws:s3:::consul-data/consul-snapshots/consul-*.snap\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Sid\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Effect\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Allow\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Action\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"s3:ListBucketVersions\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"s3:ListBucket\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"Resource\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"arn:aws:s3:::consul-data\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h4\",e({},{id:\"azure-blob-storage-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#azure-blob-storage-options\",\"aria-label\":\"azure blob storage options permalink\"}),\"\\xBB\"),\"Azure Blob Storage options\"),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\"}),mdx(\"p\",{parentName:\"div\"},\"These options are deprecated when used with a top-level \",mdx(\"inlineCode\",{parentName:\"p\"},\"azure_blob_storage\"),\" object in a config file. Use \",mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot_agent -> backup_destinations -> azure_blob_storage[0]\"),\" in a config file instead.\")),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\" Note: This currently only works on non-Solaris platforms due to library limitations \")),mdx(\"p\",null,\"From Consul Enterprise version \",mdx(\"inlineCode\",{parentName:\"p\"},\"1.5.0\"),\" onwards, you can store snapshots in Azure Blob storage.\"),mdx(\"p\",null,\"These options cannot be used when using \",mdx(\"inlineCode\",{parentName:\"p\"},\"backup_destinations\"),\" in a config file.\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"azure-blob-account-name\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#azure-blob-account-name\",\"aria-label\":\"azure blob account name permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-azure-blob-account-name\")),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"-azure-blob-account-key\"),` - These arguments supply\nauthentication information for connecting to Azure Blob storage.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"azure-blob-container-name\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#azure-blob-container-name\",\"aria-label\":\"azure blob container name permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-azure-blob-container-name\")),` - Container to use. Required for Azure blob storage, and setting this\ndisables local storage.`))),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"azure-blob-environment\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#azure-blob-environment\",\"aria-label\":\"azure blob environment permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-azure-blob-environment\")),` - Environment to use. Defaults to AZUREPUBLICCLOUD. Other valid environments\nare AZURECHINACLOUD, AZUREGERMANCLOUD and AZUREUSGOVERNMENTCLOUD. Introduced in Consul 1.7.3.`)),mdx(\"h4\",e({},{id:\"google-cloud-storage-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#google-cloud-storage-options\",\"aria-label\":\"google cloud storage options permalink\"}),\"\\xBB\"),\"Google Cloud Storage options\"),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\"}),mdx(\"p\",{parentName:\"div\"},\"This option is deprecated when used with a top-level \",mdx(\"inlineCode\",{parentName:\"p\"},\"google_storage\"),\" object in a config file. Use \",mdx(\"inlineCode\",{parentName:\"p\"},\"snapshot_agent -> backup_destinations -> google_storage[0]\"),\" in a config file instead.\")),mdx(\"p\",null,\"From Consul Enterprise version \",mdx(\"inlineCode\",{parentName:\"p\"},\"1.6.1\"),\" onwards, you can store snapshots in Google Cloud Storage. Authentication relies on automatic discovery through the sdk as described \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cloud.google.com/docs/authentication/production\"}),\"here\"),\":\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"First, ADC checks to see if the environment variable GOOGLE_APPLICATION_CREDENTIALS is set. If the variable is set, ADC uses the service account file that the variable points to. The next section describes how to set the environment variable.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"If the environment variable isn't set, ADC uses the default service account that Compute Engine, Kubernetes Engine, App Engine, and Cloud Functions provide, for applications that run on those services.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"If ADC can't use either of the above credentials, an error occurs.\"))),mdx(\"p\",null,\"This option cannot be used when using \",mdx(\"inlineCode\",{parentName:\"p\"},\"backup_destinations\"),\" in a config file.\"),mdx(\"p\",null,\"This integration needs the following information:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"gcs-bucket\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#gcs-bucket\",\"aria-label\":\"gcs bucket permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-gcs-bucket\")),\" supplies the bucket to use.\")),mdx(\"h4\",e({},{id:\"api-options\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-options\",\"aria-label\":\"api options permalink\"}),\"\\xBB\"),\"API Options\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"ca-file\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#ca-file\",\"aria-label\":\"ca file permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-ca-file=<value>\")),` - Path to a CA file to use for TLS when communicating with Consul.\nThis can also be specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_CACERT\"),\" environment variable.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"ca-path\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#ca-path\",\"aria-label\":\"ca path permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-ca-path=<value>\")),` - Path to a directory of CA certificates to use for TLS when\ncommunicating with Consul. This can also be specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_CAPATH\"),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"client-cert\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#client-cert\",\"aria-label\":\"client cert permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-client-cert=<value>\")),` - Path to a client cert file to use for TLS when\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"verify_incoming\"),\" is enabled. This can also be specified via the \",mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_CLIENT_CERT\"),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"client-key\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#client-key\",\"aria-label\":\"client key permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-client-key=<value>\")),` - Path to a client key file to use for TLS when\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"verify_incoming\"),\" is enabled. This can also be specified via the \",mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_CLIENT_KEY\"),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"http-addr\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#http-addr\",\"aria-label\":\"http addr permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-http-addr=<addr>\")),` - Address of the Consul agent with the port. This can be\nan IP address or DNS address, but it must include the port. This can also be\nspecified via the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_HTTP_ADDR\"),` environment variable. In Consul 0.8 and\nlater, the default value is `,mdx(\"a\",e({parentName:\"p\"},{href:\"http://127.0.0.1:8500\"}),\"http://127.0.0.1:8500\"),`, and https can optionally be\nused instead. The scheme can also be set to HTTPS by setting the environment\nvariable `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_HTTP_SSL=true\"),`. This may be a unix domain socket using\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"unix:///path/to/socket\"),\" if the \",mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/docs/agent/config/config-files#addresses\"}),`agent is configured to\nlisten`),\" that way.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"tls-server-name\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#tls-server-name\",\"aria-label\":\"tls server name permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-tls-server-name=<value>\")),` - The server name to use as the SNI host when\nconnecting via TLS. This can also be specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_TLS_SERVER_NAME\"),`\nenvironment variable.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"token\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#token\",\"aria-label\":\"token permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-token=<value>\")),` - ACL token to use in the request. This can also be specified\nvia the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_HTTP_TOKEN\"),` environment variable. If unspecified, the query\nwill default to the token of the Consul agent at the HTTP address.`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"token-file\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"p\",{parentName:\"li\"},mdx(\"a\",e({parentName:\"p\"},{href:\"#token-file\",\"aria-label\":\"token file permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"-token-file=<value>\")),` - File containing the ACL token to use in the request\ninstead of one specified via the `,mdx(\"inlineCode\",{parentName:\"p\"},\"-token\"),\" argument or \",mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_HTTP_TOKEN\"),`\nenvironment variable. This can also be specified via the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_HTTP_TOKEN_FILE\"),\" environment variable.\"))),mdx(\"h2\",e({},{id:\"examples\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#examples\",\"aria-label\":\"examples permalink\"}),\"\\xBB\"),\"Examples\"),mdx(\"p\",null,`Running the agent with no arguments will run a long-running daemon process that will\nperform leader election for highly available operation, register itself with Consul\nservice discovery with health checks, take snapshots every hour, retain the last 30\nsnapshots, and save snapshots into the current working directory:`),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"consul snapshot agent\")),`\n`)),mdx(\"p\",null,`To run a one-shot backup, set the backup interval to 0. This will run a single snapshot\nand delete any old snapshots based on the retain settings, but it will not perform any\nleader election or service registration:`),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"consul snapshot agent -interval\",mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token number\"}),\"0\"))),`\n`)),mdx(\"p\",null,\"Please see the \",mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/api-docs/snapshot\"}),\"HTTP API\"),` documentation for\nmore details about snapshot internals.`),mdx(\"h2\",e({},{id:\"licensing\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#licensing\",\"aria-label\":\"licensing permalink\"}),\"\\xBB\"),\"Licensing\"),mdx(\"p\",null,`The snapshot agent requires a license when it starts before it will perform any other\nactions. This can be provided using the `,mdx(\"inlineCode\",{parentName:\"p\"},\"license_path\"),` configuration item, the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_LICENSE_PATH\"),\" environment variable or the \",mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_LICENSE\"),` environment variable.\nThe `,mdx(\"inlineCode\",{parentName:\"p\"},\"license_path\"),\" configuration and \",mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_LICENSE_PATH\"),` variable should point to\nfiles that contain the license whereas the `,mdx(\"inlineCode\",{parentName:\"p\"},\"CONSUL_LICENSE\"),` variable value should be\nthe contents of the license itself. If a license is present in multiple ways the\nthen the order of precedence is as follows:`),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",e({parentName:\"li\"},{id:\"consul_license\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#consul_license\",\"aria-label\":\"consul_license permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"CONSUL_LICENSE\")),\" variable\"),mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",e({parentName:\"li\"},{id:\"consul_license_path\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#consul_license_path\",\"aria-label\":\"consul_license_path permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"CONSUL_LICENSE_PATH\")),\" variable\"),mdx(\"li\",{parentName:\"ol\"},mdx(\"a\",e({parentName:\"li\"},{id:\"license_path\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#license_path\",\"aria-label\":\"license_path permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"license_path\")),\" configuration.\")),mdx(\"p\",null,`The ability to load licenses from the configuration or environment was added in v1.10.0,\nv1.9.7 and v1.8.13. See the `,mdx(\"a\",e({parentName:\"p\"},{href:\"/consul/docs/enterprise/license/overview\"}),\"licensing documentation\"),` for\nmore information about Consul Enterprise license management.`))}MDXContent.isMDXComponent=!0;\n","scope":{"version":"latest"}},"product":{"name":"Consul","slug":"consul","algoliaConfig":{"indexName":"product_CONSUL","searchOnlyApiKey":"fbd5dc1f0078d41509fcc560386fd534"},"analyticsConfig":{"includedDomains":"consul.io www.consul.io","segmentWriteKey":"IyzLrqXkox5KJ8XL4fo8vTYNGfiKlTCm"},"datoToken":"88b4984480dad56295a8aadae6caad","metadata":{"title":"Consul by HashiCorp","description":"Consul is a service networking solution to automate network configurations, discover services, and enable secure connectivity across any cloud or runtime.","image":"https://www.consulproject.io/consul-public/img/og-image.png","icon":[{"href":"/consul-public/_favicon.ico"}]},"alertBannerActive":true,"alertBanner":{"tag":"HashiConf","url":"https://hashiconf.com/2023?utm_source=direct&utm_medium=banner&utm_campaign=23Q3_HASHICONFGLOBAL_EVENT&utm_content=&utm_offer=event","text":"Our community conference is taking place in San Francisco and online October 10-12.","linkText":"Register now","expirationDate":""},"version":"1.11.3","subnavItems":[],"basePaths":["docs","api-docs","commands","downloads"],"rootDocsPaths":[{"iconName":"docs","name":"Documentation","path":"docs"},{"iconName":"api","name":"API","path":"api-docs"},{"iconName":"terminal-screen","name":"CLI","path":"commands"}],"currentRootDocsPath":{"iconName":"terminal-screen","name":"CLI","path":"commands"}},"projectName":null,"versions":null},"__N_SSG":true}